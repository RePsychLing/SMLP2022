<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Phillip Alday, Douglas Bates, Reinhold Kliegl, and Julius Krumbiegel">
<meta name="dcterms.date" content="2022-06-22">

<title>SMLP2022 - Notes on saved data files</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./glmm.html" rel="next">
<link href="./sleepstudy_speed.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">SMLP2022</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html">About</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/RePsychLing/SMLP2022"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Notes on saved data files</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">SMLP2022 - Advanced frequentist methods</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./useful_packages.html" class="sidebar-item-text sidebar-link">Useful packages</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sleepstudy.html" class="sidebar-item-text sidebar-link">Analysis of the sleepstudy data</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sleepstudy_speed.html" class="sidebar-item-text sidebar-link">The sleepstudy: Speed - for a change …</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Arrow.html" class="sidebar-item-text sidebar-link active">Notes on saved data files</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glmm.html" class="sidebar-item-text sidebar-link">Generalized linear mixed models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kb07.html" class="sidebar-item-text sidebar-link">Bootstrapping a fitted model</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kwdyz11.html" class="sidebar-item-text sidebar-link">RePsychLing Kliegl et al.&nbsp;(2010)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kkl15.html" class="sidebar-item-text sidebar-link">RePsychLing Kliegl, Kuschela, &amp; Laubrock (2015)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./shrinkageplot.html" class="sidebar-item-text sidebar-link">More on shrinkage plots</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-arrow-storage-format" id="toc-the-arrow-storage-format" class="nav-link active" data-scroll-target="#the-arrow-storage-format">The Arrow storage format</a></li>
  <li><a href="#the-emotikon-data" id="toc-the-emotikon-data" class="nav-link" data-scroll-target="#the-emotikon-data">The Emotikon data</a></li>
  <li><a href="#downloading-and-importing-the-rds-file" id="toc-downloading-and-importing-the-rds-file" class="nav-link" data-scroll-target="#downloading-and-importing-the-rds-file">Downloading and importing the RDS file</a></li>
  <li><a href="#avoiding-needless-repetition" id="toc-avoiding-needless-repetition" class="nav-link" data-scroll-target="#avoiding-needless-repetition">Avoiding needless repetition</a></li>
  <li><a href="#creating-the-smaller-table" id="toc-creating-the-smaller-table" class="nav-link" data-scroll-target="#creating-the-smaller-table">Creating the smaller table</a></li>
  <li><a href="#discovering-patterns-in-the-data" id="toc-discovering-patterns-in-the-data" class="nav-link" data-scroll-target="#discovering-patterns-in-the-data">Discovering patterns in the data</a></li>
  <li><a href="#reading-arrow-files-in-other-languages" id="toc-reading-arrow-files-in-other-languages" class="nav-link" data-scroll-target="#reading-arrow-files-in-other-languages">Reading Arrow files in other languages</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/RePsychLing/SMLP2022/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Notes on saved data files</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Phillip Alday, Douglas Bates, Reinhold Kliegl, and Julius Krumbiegel </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2022-06-22</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="the-arrow-storage-format" class="level2">
<h2 class="anchored" data-anchor-id="the-arrow-storage-format">The Arrow storage format</h2>
<p>The <a href="https://arrow.apache.org">Arrow storage format</a> provides a language-agnostic storage and memory specification for columnar data tables, which just means “something that looks like a data frame in R”. That is, an arrow table is an ordered, named collection of columns, all of the same length.</p>
<p>The columns can be of different types including numeric values, character strings, and factor-like representations - called <em>DictEncoded</em>.</p>
<p>An Arrow file can be read or written from R, Python, Julia and many other languages. Somewhat confusingly in R and Python the name <code>feather</code>, which refers to an earlier version of the storage format, is used in some function names like <code>read_feather</code>.</p>
</section>
<section id="the-emotikon-data" class="level2">
<h2 class="anchored" data-anchor-id="the-emotikon-data">The Emotikon data</h2>
<p>The <a href="https://github.com/RePsychling/SMLP2021">SMLP2021 repository</a> contains a version of the data from <span class="citation" data-cites="Fuehner2021">Fühner et al. (<a href="#ref-Fuehner2021" role="doc-biblioref">2021</a>)</span> in <code>notebooks/data/fggk21.arrow</code>. After that file was created there were changes in the master RDS file on the <a href="https://osf.io/2d8rj/">osf.io site</a> for the project. We will recreate the Arrow file here then split it into two separate tables, one with a row for each child in the study and one with a row for each test result.</p>
<p>The <code>Arrow</code> package for Julia does not export any function names, which means that the function to read an Arrow file must be called as <code>Arrow.Table</code>. It returns a <em>column table</em>, as described in the <a href="https://github.com/JuliaData/Tables.jl">Tables package</a>. This is like a read-only data frame, which can be easily converted to a full-fledged <code>DataFrame</code> if desired.</p>
<p>This arrangement allows for the <code>Arrow</code> package not to depend on the <code>DataFrames</code> package, which is a heavy-weight dependency, but still easily produce a <code>DataFrame</code> if warranted.</p>
<p>Load the packages to be used.</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AlgebraOfGraphics</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Arrow</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CairoMakie</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Chain</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrameMacros</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Downloads</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">KernelDensity</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">PyCall  </span><span class="co"># show reading Arrow in Python</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">RCall   </span><span class="co"># show reading Arrow in R</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsBase</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>CairoMakie.<span class="fu">activate!</span>(; <span class="kw">type</span><span class="op">=</span><span class="st">"svg"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AlgebraOfGraphics</span>: density</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Info: Precompiling AlgebraOfGraphics [cbdf2221-f076-402e-a563-3d30da359d67]
└ @ Base loading.jl:1515</code></pre>
</div>
</div>
</section>
<section id="downloading-and-importing-the-rds-file" class="level2">
<h2 class="anchored" data-anchor-id="downloading-and-importing-the-rds-file">Downloading and importing the RDS file</h2>
<p>This is similar to some of the code shown by Julius Krumbiegel on Monday. In the data directory of the emotikon project on osf.io under Data, the url for the rds data file is found to be [https://osf.io/xawdb/]. Note that we want version 2 of this file.</p>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fn <span class="op">=</span> <span class="bu">Downloads</span>.<span class="fu">download</span>(<span class="st">"https://osf.io/xawdb/download?version=2"</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dfrm <span class="op">=</span> <span class="fu">rcopy</span>(R<span class="st">"readRDS(</span><span class="sc">$</span>fn<span class="st">)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div class="data-frame"><p>525,126 rows × 7 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Cohort</th><th>School</th><th>Child</th><th>Sex</th><th>age</th><th>Test</th><th>score</th></tr><tr><th></th><th title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th><th title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th><th title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th><th title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th><th title="Float64">Float64</th><th title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>S20_r</td><td>5.26316</td></tr><tr><th>2</th><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>BPT</td><td>3.7</td></tr><tr><th>3</th><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>SLJ</td><td>125.0</td></tr><tr><th>4</th><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>Star_r</td><td>2.47146</td></tr><tr><th>5</th><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>Run</td><td>1053.0</td></tr><tr><th>6</th><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>S20_r</td><td>5.0</td></tr><tr><th>7</th><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>BPT</td><td>4.1</td></tr><tr><th>8</th><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>SLJ</td><td>116.0</td></tr><tr><th>9</th><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>Star_r</td><td>1.76778</td></tr><tr><th>10</th><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>Run</td><td>1089.0</td></tr><tr><th>11</th><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>S20_r</td><td>4.54545</td></tr><tr><th>12</th><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>BPT</td><td>3.9</td></tr><tr><th>13</th><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>SLJ</td><td>111.0</td></tr><tr><th>14</th><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>Star_r</td><td>1.98875</td></tr><tr><th>15</th><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>Run</td><td>864.0</td></tr><tr><th>16</th><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>S20_r</td><td>4.54545</td></tr><tr><th>17</th><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>BPT</td><td>3.0</td></tr><tr><th>18</th><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>SLJ</td><td>114.0</td></tr><tr><th>19</th><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>Star_r</td><td>1.84464</td></tr><tr><th>20</th><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>Run</td><td>835.0</td></tr><tr><th>21</th><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>S20_r</td><td>4.34783</td></tr><tr><th>22</th><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>BPT</td><td>3.3</td></tr><tr><th>23</th><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>SLJ</td><td>118.0</td></tr><tr><th>24</th><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>Star_r</td><td>1.90682</td></tr><tr><th>25</th><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>Run</td><td>860.0</td></tr><tr><th>26</th><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>S20_r</td><td>4.34783</td></tr><tr><th>27</th><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>BPT</td><td>4.3</td></tr><tr><th>28</th><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>SLJ</td><td>130.0</td></tr><tr><th>29</th><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>Star_r</td><td>1.99655</td></tr><tr><th>30</th><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>Run</td><td>960.0</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
<p>Now write this file as a Arrow file and read it back in.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>arrowfn <span class="op">=</span> <span class="fu">joinpath</span>(<span class="st">"data"</span>, <span class="st">"fggk21.arrow"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Arrow.<span class="fu">write</span>(arrowfn, dfrm; compress<span class="op">=:</span>lz4)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>tbl <span class="op">=</span> Arrow.<span class="fu">Table</span>(arrowfn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Arrow.Table with 525126 rows, 7 columns, and schema:
 :Cohort  String
 :School  String
 :Child   String
 :Sex     String
 :age     Float64
 :Test    String
 :score   Float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filesize</span>(arrowfn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>3077850</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(tbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div class="data-frame"><p>525,126 rows × 7 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Cohort</th><th>School</th><th>Child</th><th>Sex</th><th>age</th><th>Test</th><th>score</th></tr><tr><th></th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="Float64">Float64</th><th title="String">String</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>S20_r</td><td>5.26316</td></tr><tr><th>2</th><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>BPT</td><td>3.7</td></tr><tr><th>3</th><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>SLJ</td><td>125.0</td></tr><tr><th>4</th><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>Star_r</td><td>2.47146</td></tr><tr><th>5</th><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>Run</td><td>1053.0</td></tr><tr><th>6</th><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>S20_r</td><td>5.0</td></tr><tr><th>7</th><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>BPT</td><td>4.1</td></tr><tr><th>8</th><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>SLJ</td><td>116.0</td></tr><tr><th>9</th><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>Star_r</td><td>1.76778</td></tr><tr><th>10</th><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>Run</td><td>1089.0</td></tr><tr><th>11</th><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>S20_r</td><td>4.54545</td></tr><tr><th>12</th><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>BPT</td><td>3.9</td></tr><tr><th>13</th><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>SLJ</td><td>111.0</td></tr><tr><th>14</th><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>Star_r</td><td>1.98875</td></tr><tr><th>15</th><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>Run</td><td>864.0</td></tr><tr><th>16</th><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>S20_r</td><td>4.54545</td></tr><tr><th>17</th><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>BPT</td><td>3.0</td></tr><tr><th>18</th><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>SLJ</td><td>114.0</td></tr><tr><th>19</th><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>Star_r</td><td>1.84464</td></tr><tr><th>20</th><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>Run</td><td>835.0</td></tr><tr><th>21</th><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>S20_r</td><td>4.34783</td></tr><tr><th>22</th><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>BPT</td><td>3.3</td></tr><tr><th>23</th><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>SLJ</td><td>118.0</td></tr><tr><th>24</th><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>Star_r</td><td>1.90682</td></tr><tr><th>25</th><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>Run</td><td>860.0</td></tr><tr><th>26</th><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>S20_r</td><td>4.34783</td></tr><tr><th>27</th><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>BPT</td><td>4.3</td></tr><tr><th>28</th><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>SLJ</td><td>130.0</td></tr><tr><th>29</th><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>Star_r</td><td>1.99655</td></tr><tr><th>30</th><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>Run</td><td>960.0</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="avoiding-needless-repetition" class="level2">
<h2 class="anchored" data-anchor-id="avoiding-needless-repetition">Avoiding needless repetition</h2>
<p>One of the principles of relational database design is that information should not be repeated needlessly. Each row of <code>df</code> is determined by a combination of <code>Child</code> and <code>Test</code>, together producing a <code>score</code>, which can be converted to a <code>zScore</code>.</p>
<p>The other columns in the table, <code>Cohort</code>, <code>School</code>, <code>age</code>, and <code>Sex</code>, are properties of the <code>Child</code>.</p>
<p>Storing these values redundantly in the full table takes up space but, more importantly, allows for inconsistency. As it stands, a given <code>Child</code> could be recorded as being in one <code>Cohort</code> for the <code>Run</code> test and in another <code>Cohort</code> for the <code>S20_r</code> test and nothing about the table would detect this as being an error.</p>
<p>The approach used in relational databases is to store the information for <code>score</code> in one table that contains only <code>Child</code>, <code>Test</code> and <code>score</code>, store the information for the <code>Child</code> in another table including <code>Cohort</code>, <code>School</code>, <code>age</code> and <code>Sex</code>. These tables can then be combined to create the table to be used for analysis by <em>joining</em> the different tables together.</p>
<p>The maintainers of the <code>DataFrames</code> package have put in a lot of work over the past few years to make joins quite efficient in Julia. Thus the processing penalty of reassembling the big table from three smaller tables is minimal.</p>
<p>It is important to note that the main advantage of using smaller tables that are joined together to produce the analysis table is the fact that the information in the analysis table is consistent by design.</p>
</section>
<section id="creating-the-smaller-table" class="level2">
<h2 class="anchored" data-anchor-id="creating-the-smaller-table">Creating the smaller table</h2>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Child <span class="op">=</span> <span class="fu">unique</span>(<span class="fu">select</span>(df, <span class="op">:</span>Child, <span class="op">:</span>School, <span class="op">:</span>Cohort, <span class="op">:</span>Sex, <span class="op">:</span>age))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div class="data-frame"><p>108,295 rows × 5 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Child</th><th>School</th><th>Cohort</th><th>Sex</th><th>age</th></tr><tr><th></th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>C002352</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>2</th><td>C002353</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>3</th><td>C002354</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>4</th><td>C002355</td><td>S100122</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>5</th><td>C002356</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>6</th><td>C002357</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>7</th><td>C002358</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>8</th><td>C002359</td><td>S100183</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>9</th><td>C002360</td><td>S100195</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>10</th><td>C002361</td><td>S100213</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>11</th><td>C002362</td><td>S100237</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>12</th><td>C002363</td><td>S100237</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>13</th><td>C002364</td><td>S100250</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>14</th><td>C002365</td><td>S100304</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>15</th><td>C002366</td><td>S100304</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>16</th><td>C002367</td><td>S100316</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>17</th><td>C002368</td><td>S100365</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>18</th><td>C002369</td><td>S100365</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>19</th><td>C002370</td><td>S100365</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>20</th><td>C002371</td><td>S100432</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>21</th><td>C002372</td><td>S100432</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>22</th><td>C002373</td><td>S100481</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>23</th><td>C002374</td><td>S100481</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>24</th><td>C002375</td><td>S100481</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>25</th><td>C002376</td><td>S100493</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>26</th><td>C002377</td><td>S100493</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>27</th><td>C002378</td><td>S100547</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>28</th><td>C002379</td><td>S100547</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>29</th><td>C002380</td><td>S100547</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>30</th><td>C002381</td><td>S100547</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(Child.Child))  <span class="co"># should be 108295</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>108295</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filesize</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  Arrow.<span class="fu">write</span>(<span class="st">"./data/fggk21_Child.arrow"</span>, Child; compress<span class="op">=:</span>lz4)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>1774946</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filesize</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  Arrow.<span class="fu">write</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"./data/fggk21_Score.arrow"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(df, <span class="op">:</span>Child, <span class="op">:</span><span class="bu">Test</span>, <span class="op">:</span>score);</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    compress<span class="op">=:</span>lz4,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>2794058</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>A careful examination of the file sizes versus that of <code>./data/fggk21.arrow</code> will show that the separate tables combined take up more space than the original because of the compression. Compression algorithms are often more successful when applied to larger files.</p>
</div>
</div>
<p>Now read the Arrow tables in and reassemble the original table.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Score <span class="op">=</span> <span class="fu">DataFrame</span>(Arrow.<span class="fu">Table</span>(<span class="st">"./data/fggk21_Score.arrow"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div class="data-frame"><p>525,126 rows × 3 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Child</th><th>Test</th><th>score</th></tr><tr><th></th><th title="String">String</th><th title="String">String</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>C002352</td><td>S20_r</td><td>5.26316</td></tr><tr><th>2</th><td>C002352</td><td>BPT</td><td>3.7</td></tr><tr><th>3</th><td>C002352</td><td>SLJ</td><td>125.0</td></tr><tr><th>4</th><td>C002352</td><td>Star_r</td><td>2.47146</td></tr><tr><th>5</th><td>C002352</td><td>Run</td><td>1053.0</td></tr><tr><th>6</th><td>C002353</td><td>S20_r</td><td>5.0</td></tr><tr><th>7</th><td>C002353</td><td>BPT</td><td>4.1</td></tr><tr><th>8</th><td>C002353</td><td>SLJ</td><td>116.0</td></tr><tr><th>9</th><td>C002353</td><td>Star_r</td><td>1.76778</td></tr><tr><th>10</th><td>C002353</td><td>Run</td><td>1089.0</td></tr><tr><th>11</th><td>C002354</td><td>S20_r</td><td>4.54545</td></tr><tr><th>12</th><td>C002354</td><td>BPT</td><td>3.9</td></tr><tr><th>13</th><td>C002354</td><td>SLJ</td><td>111.0</td></tr><tr><th>14</th><td>C002354</td><td>Star_r</td><td>1.98875</td></tr><tr><th>15</th><td>C002354</td><td>Run</td><td>864.0</td></tr><tr><th>16</th><td>C002355</td><td>S20_r</td><td>4.54545</td></tr><tr><th>17</th><td>C002355</td><td>BPT</td><td>3.0</td></tr><tr><th>18</th><td>C002355</td><td>SLJ</td><td>114.0</td></tr><tr><th>19</th><td>C002355</td><td>Star_r</td><td>1.84464</td></tr><tr><th>20</th><td>C002355</td><td>Run</td><td>835.0</td></tr><tr><th>21</th><td>C002356</td><td>S20_r</td><td>4.34783</td></tr><tr><th>22</th><td>C002356</td><td>BPT</td><td>3.3</td></tr><tr><th>23</th><td>C002356</td><td>SLJ</td><td>118.0</td></tr><tr><th>24</th><td>C002356</td><td>Star_r</td><td>1.90682</td></tr><tr><th>25</th><td>C002356</td><td>Run</td><td>860.0</td></tr><tr><th>26</th><td>C002357</td><td>S20_r</td><td>4.34783</td></tr><tr><th>27</th><td>C002357</td><td>BPT</td><td>4.3</td></tr><tr><th>28</th><td>C002357</td><td>SLJ</td><td>130.0</td></tr><tr><th>29</th><td>C002357</td><td>Star_r</td><td>1.99655</td></tr><tr><th>30</th><td>C002357</td><td>Run</td><td>960.0</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
<p>At this point we can create the z-score column by standardizing the scores for each <code>Test</code>. The code to do this follows Julius’s presentation on Monday.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@transform</span>!(<span class="fu">groupby</span>(Score, <span class="op">:</span><span class="bu">Test</span>), <span class="op">:</span>zScore <span class="op">=</span> <span class="pp">@c</span> <span class="fu">zscore</span>(<span class="op">:</span>score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div class="data-frame"><p>525,126 rows × 4 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Child</th><th>Test</th><th>score</th><th>zScore</th></tr><tr><th></th><th title="String">String</th><th title="String">String</th><th title="Float64">Float64</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>C002352</td><td>S20_r</td><td>5.26316</td><td>1.7913</td></tr><tr><th>2</th><td>C002352</td><td>BPT</td><td>3.7</td><td>-0.0622317</td></tr><tr><th>3</th><td>C002352</td><td>SLJ</td><td>125.0</td><td>-0.0336567</td></tr><tr><th>4</th><td>C002352</td><td>Star_r</td><td>2.47146</td><td>1.46874</td></tr><tr><th>5</th><td>C002352</td><td>Run</td><td>1053.0</td><td>0.331058</td></tr><tr><th>6</th><td>C002353</td><td>S20_r</td><td>5.0</td><td>1.15471</td></tr><tr><th>7</th><td>C002353</td><td>BPT</td><td>4.1</td><td>0.498354</td></tr><tr><th>8</th><td>C002353</td><td>SLJ</td><td>116.0</td><td>-0.498822</td></tr><tr><th>9</th><td>C002353</td><td>Star_r</td><td>1.76778</td><td>-0.9773</td></tr><tr><th>10</th><td>C002353</td><td>Run</td><td>1089.0</td><td>0.574056</td></tr><tr><th>11</th><td>C002354</td><td>S20_r</td><td>4.54545</td><td>0.0551481</td></tr><tr><th>12</th><td>C002354</td><td>BPT</td><td>3.9</td><td>0.218061</td></tr><tr><th>13</th><td>C002354</td><td>SLJ</td><td>111.0</td><td>-0.757248</td></tr><tr><th>14</th><td>C002354</td><td>Star_r</td><td>1.98875</td><td>-0.209186</td></tr><tr><th>15</th><td>C002354</td><td>Run</td><td>864.0</td><td>-0.944681</td></tr><tr><th>16</th><td>C002355</td><td>S20_r</td><td>4.54545</td><td>0.0551481</td></tr><tr><th>17</th><td>C002355</td><td>BPT</td><td>3.0</td><td>-1.04326</td></tr><tr><th>18</th><td>C002355</td><td>SLJ</td><td>114.0</td><td>-0.602193</td></tr><tr><th>19</th><td>C002355</td><td>Star_r</td><td>1.84464</td><td>-0.71013</td></tr><tr><th>20</th><td>C002355</td><td>Run</td><td>835.0</td><td>-1.14043</td></tr><tr><th>21</th><td>C002356</td><td>S20_r</td><td>4.34783</td><td>-0.422921</td></tr><tr><th>22</th><td>C002356</td><td>BPT</td><td>3.3</td><td>-0.622817</td></tr><tr><th>23</th><td>C002356</td><td>SLJ</td><td>118.0</td><td>-0.395452</td></tr><tr><th>24</th><td>C002356</td><td>Star_r</td><td>1.90682</td><td>-0.493992</td></tr><tr><th>25</th><td>C002356</td><td>Run</td><td>860.0</td><td>-0.97168</td></tr><tr><th>26</th><td>C002357</td><td>S20_r</td><td>4.34783</td><td>-0.422921</td></tr><tr><th>27</th><td>C002357</td><td>BPT</td><td>4.3</td><td>0.778646</td></tr><tr><th>28</th><td>C002357</td><td>SLJ</td><td>130.0</td><td>0.224769</td></tr><tr><th>29</th><td>C002357</td><td>Star_r</td><td>1.99655</td><td>-0.182076</td></tr><tr><th>30</th><td>C002357</td><td>Run</td><td>960.0</td><td>-0.296686</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Child <span class="op">=</span> <span class="fu">DataFrame</span>(Arrow.<span class="fu">Table</span>(<span class="st">"./data/fggk21_Child.arrow"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">

<div class="data-frame"><p>108,295 rows × 5 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Child</th><th>School</th><th>Cohort</th><th>Sex</th><th>age</th></tr><tr><th></th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>C002352</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>2</th><td>C002353</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>3</th><td>C002354</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>4</th><td>C002355</td><td>S100122</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>5</th><td>C002356</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>6</th><td>C002357</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>7</th><td>C002358</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>8</th><td>C002359</td><td>S100183</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>9</th><td>C002360</td><td>S100195</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>10</th><td>C002361</td><td>S100213</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>11</th><td>C002362</td><td>S100237</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>12</th><td>C002363</td><td>S100237</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>13</th><td>C002364</td><td>S100250</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>14</th><td>C002365</td><td>S100304</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>15</th><td>C002366</td><td>S100304</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>16</th><td>C002367</td><td>S100316</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>17</th><td>C002368</td><td>S100365</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>18</th><td>C002369</td><td>S100365</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>19</th><td>C002370</td><td>S100365</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>20</th><td>C002371</td><td>S100432</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>21</th><td>C002372</td><td>S100432</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>22</th><td>C002373</td><td>S100481</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>23</th><td>C002374</td><td>S100481</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>24</th><td>C002375</td><td>S100481</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>25</th><td>C002376</td><td>S100493</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>26</th><td>C002377</td><td>S100493</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>27</th><td>C002378</td><td>S100547</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>28</th><td>C002379</td><td>S100547</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>29</th><td>C002380</td><td>S100547</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>30</th><td>C002381</td><td>S100547</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> <span class="fu">disallowmissing!</span>(<span class="fu">leftjoin</span>(Score, Child; on<span class="op">=:</span>Child))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">

<div class="data-frame"><p>525,126 rows × 8 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Child</th><th>Test</th><th>score</th><th>zScore</th><th>School</th><th>Cohort</th><th>Sex</th><th>age</th></tr><tr><th></th><th title="String">String</th><th title="String">String</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>C002352</td><td>S20_r</td><td>5.26316</td><td>1.7913</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>2</th><td>C002352</td><td>BPT</td><td>3.7</td><td>-0.0622317</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>3</th><td>C002352</td><td>SLJ</td><td>125.0</td><td>-0.0336567</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>4</th><td>C002352</td><td>Star_r</td><td>2.47146</td><td>1.46874</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>5</th><td>C002352</td><td>Run</td><td>1053.0</td><td>0.331058</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>6</th><td>C002353</td><td>S20_r</td><td>5.0</td><td>1.15471</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>7</th><td>C002353</td><td>BPT</td><td>4.1</td><td>0.498354</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>8</th><td>C002353</td><td>SLJ</td><td>116.0</td><td>-0.498822</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>9</th><td>C002353</td><td>Star_r</td><td>1.76778</td><td>-0.9773</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>10</th><td>C002353</td><td>Run</td><td>1089.0</td><td>0.574056</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>11</th><td>C002354</td><td>S20_r</td><td>4.54545</td><td>0.0551481</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>12</th><td>C002354</td><td>BPT</td><td>3.9</td><td>0.218061</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>13</th><td>C002354</td><td>SLJ</td><td>111.0</td><td>-0.757248</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>14</th><td>C002354</td><td>Star_r</td><td>1.98875</td><td>-0.209186</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>15</th><td>C002354</td><td>Run</td><td>864.0</td><td>-0.944681</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>16</th><td>C002355</td><td>S20_r</td><td>4.54545</td><td>0.0551481</td><td>S100122</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>17</th><td>C002355</td><td>BPT</td><td>3.0</td><td>-1.04326</td><td>S100122</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>18</th><td>C002355</td><td>SLJ</td><td>114.0</td><td>-0.602193</td><td>S100122</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>19</th><td>C002355</td><td>Star_r</td><td>1.84464</td><td>-0.71013</td><td>S100122</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>20</th><td>C002355</td><td>Run</td><td>835.0</td><td>-1.14043</td><td>S100122</td><td>2013</td><td>female</td><td>7.99452</td></tr><tr><th>21</th><td>C002356</td><td>S20_r</td><td>4.34783</td><td>-0.422921</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>22</th><td>C002356</td><td>BPT</td><td>3.3</td><td>-0.622817</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>23</th><td>C002356</td><td>SLJ</td><td>118.0</td><td>-0.395452</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>24</th><td>C002356</td><td>Star_r</td><td>1.90682</td><td>-0.493992</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>25</th><td>C002356</td><td>Run</td><td>860.0</td><td>-0.97168</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>26</th><td>C002357</td><td>S20_r</td><td>4.34783</td><td>-0.422921</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>27</th><td>C002357</td><td>BPT</td><td>4.3</td><td>0.778646</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>28</th><td>C002357</td><td>SLJ</td><td>130.0</td><td>0.224769</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>29</th><td>C002357</td><td>Star_r</td><td>1.99655</td><td>-0.182076</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>30</th><td>C002357</td><td>Run</td><td>960.0</td><td>-0.296686</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The call to <code>disallowmissing!</code> is because the join will create columns that allow for missing values but we know that we should not get missing values in the result. This call will fail if, for some reason, missing values were created.</p>
</div>
</div>
</section>
<section id="discovering-patterns-in-the-data" class="level2">
<h2 class="anchored" data-anchor-id="discovering-patterns-in-the-data">Discovering patterns in the data</h2>
<p>One of the motivations for creating the <code>Child</code> table was be able to bin the ages according to the age of each child, not the age of each <code>Child-Test</code> combination. Not all children have all 5 test results. We can check the number of results by grouping on <code>:Child</code> and evaluate the number of rows in each group.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>nobsChild <span class="op">=</span> <span class="fu">combine</span>(<span class="fu">groupby</span>(Score, <span class="op">:</span>Child), nrow <span class="op">=&gt;</span> <span class="op">:</span>ntest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div class="data-frame"><p>108,295 rows × 2 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Child</th><th>ntest</th></tr><tr><th></th><th title="String">String</th><th title="Int64">Int64</th></tr></thead><tbody><tr><th>1</th><td>C002352</td><td>5</td></tr><tr><th>2</th><td>C002353</td><td>5</td></tr><tr><th>3</th><td>C002354</td><td>5</td></tr><tr><th>4</th><td>C002355</td><td>5</td></tr><tr><th>5</th><td>C002356</td><td>5</td></tr><tr><th>6</th><td>C002357</td><td>5</td></tr><tr><th>7</th><td>C002358</td><td>5</td></tr><tr><th>8</th><td>C002359</td><td>4</td></tr><tr><th>9</th><td>C002360</td><td>5</td></tr><tr><th>10</th><td>C002361</td><td>4</td></tr><tr><th>11</th><td>C002362</td><td>5</td></tr><tr><th>12</th><td>C002363</td><td>5</td></tr><tr><th>13</th><td>C002364</td><td>5</td></tr><tr><th>14</th><td>C002365</td><td>5</td></tr><tr><th>15</th><td>C002366</td><td>5</td></tr><tr><th>16</th><td>C002367</td><td>5</td></tr><tr><th>17</th><td>C002368</td><td>5</td></tr><tr><th>18</th><td>C002369</td><td>5</td></tr><tr><th>19</th><td>C002370</td><td>5</td></tr><tr><th>20</th><td>C002371</td><td>4</td></tr><tr><th>21</th><td>C002372</td><td>5</td></tr><tr><th>22</th><td>C002373</td><td>5</td></tr><tr><th>23</th><td>C002374</td><td>5</td></tr><tr><th>24</th><td>C002375</td><td>5</td></tr><tr><th>25</th><td>C002376</td><td>5</td></tr><tr><th>26</th><td>C002377</td><td>5</td></tr><tr><th>27</th><td>C002378</td><td>5</td></tr><tr><th>28</th><td>C002379</td><td>5</td></tr><tr><th>29</th><td>C002380</td><td>5</td></tr><tr><th>30</th><td>C002381</td><td>5</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
<p>Now create a table of the number of children with 1, 2, …, 5 test scores.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(<span class="fu">groupby</span>(nobsChild, <span class="op">:</span>ntest), nrow)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div class="data-frame"><p>5 rows × 2 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>ntest</th><th>nrow</th></tr><tr><th></th><th title="Int64">Int64</th><th title="Int64">Int64</th></tr></thead><tbody><tr><th>1</th><td>1</td><td>462</td></tr><tr><th>2</th><td>2</td><td>729</td></tr><tr><th>3</th><td>3</td><td>1739</td></tr><tr><th>4</th><td>4</td><td>8836</td></tr><tr><th>5</th><td>5</td><td>96529</td></tr></tbody></table></div>
</div>
</div>
<p>A natural question at this point is whether there is something about those students who have few observations. For example, are they from only a few schools?</p>
<p>One approach to examining properties like is to add the number of observations for each child to the :Child table. Later we can group the table according to this <code>:ntest</code> to look at properties of <code>:Child</code> by <code>:ntest</code>.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>gdf <span class="op">=</span> <span class="fu">groupby</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">disallowmissing!</span>(<span class="fu">leftjoin</span>(Child, nobsChild; on<span class="op">=:</span>Child)), <span class="op">:</span>ntest</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

<p><b>GroupedDataFrame with 5 groups based on key: ntest</b></p><p><i>First Group (462 rows): ntest = 1</i></p><div class="data-frame"><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Child</th><th>School</th><th>Cohort</th><th>Sex</th><th>age</th><th>ntest</th></tr><tr><th></th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="Float64">Float64</th><th title="Int64">Int64</th></tr></thead><tbody><tr><th>1</th><td>C002452</td><td>S101175</td><td>2013</td><td>male</td><td>7.99452</td><td>1</td></tr><tr><th>2</th><td>C002625</td><td>S103329</td><td>2013</td><td>male</td><td>7.99452</td><td>1</td></tr><tr><th>3</th><td>C002754</td><td>S104814</td><td>2013</td><td>female</td><td>7.99452</td><td>1</td></tr><tr><th>4</th><td>C003269</td><td>S102258</td><td>2012</td><td>female</td><td>7.99726</td><td>1</td></tr><tr><th>5</th><td>C003599</td><td>S105843</td><td>2012</td><td>female</td><td>7.99726</td><td>1</td></tr><tr><th>6</th><td>C003807</td><td>S100754</td><td>2011</td><td>male</td><td>8.0</td><td>1</td></tr><tr><th>7</th><td>C003985</td><td>S102945</td><td>2011</td><td>male</td><td>8.0</td><td>1</td></tr><tr><th>8</th><td>C004086</td><td>S104255</td><td>2011</td><td>male</td><td>8.0</td><td>1</td></tr><tr><th>9</th><td>C004657</td><td>S101400</td><td>2014</td><td>male</td><td>8.03833</td><td>1</td></tr><tr><th>10</th><td>C005036</td><td>S105909</td><td>2014</td><td>male</td><td>8.03833</td><td>1</td></tr><tr><th>11</th><td>C005440</td><td>S101023</td><td>2019</td><td>male</td><td>8.05202</td><td>1</td></tr><tr><th>12</th><td>C005523</td><td>S101825</td><td>2019</td><td>female</td><td>8.05202</td><td>1</td></tr><tr><th>13</th><td>C005697</td><td>S103615</td><td>2019</td><td>male</td><td>8.05202</td><td>1</td></tr><tr><th>14</th><td>C005759</td><td>S104632</td><td>2019</td><td>female</td><td>8.05202</td><td>1</td></tr><tr><th>15</th><td>C005810</td><td>S104954</td><td>2019</td><td>female</td><td>8.05202</td><td>1</td></tr><tr><th>16</th><td>C005835</td><td>S105053</td><td>2019</td><td>male</td><td>8.05202</td><td>1</td></tr><tr><th>17</th><td>C005854</td><td>S105405</td><td>2019</td><td>male</td><td>8.05202</td><td>1</td></tr><tr><th>18</th><td>C006550</td><td>S103329</td><td>2013</td><td>male</td><td>8.0794</td><td>1</td></tr><tr><th>19</th><td>C006760</td><td>S105181</td><td>2013</td><td>female</td><td>8.0794</td><td>1</td></tr><tr><th>20</th><td>C007031</td><td>S113244</td><td>2013</td><td>male</td><td>8.0794</td><td>1</td></tr><tr><th>21</th><td>C007050</td><td>S100195</td><td>2012</td><td>female</td><td>8.08214</td><td>1</td></tr><tr><th>22</th><td>C007305</td><td>S102350</td><td>2012</td><td>male</td><td>8.08214</td><td>1</td></tr><tr><th>23</th><td>C007828</td><td>S111405</td><td>2012</td><td>female</td><td>8.08214</td><td>1</td></tr><tr><th>24</th><td>C008698</td><td>S104917</td><td>2016</td><td>female</td><td>8.09309</td><td>1</td></tr><tr><th>25</th><td>C008707</td><td>S102271</td><td>2016</td><td>male</td><td>8.09582</td><td>1</td></tr><tr><th>26</th><td>C009596</td><td>S103421</td><td>2014</td><td>female</td><td>8.1232</td><td>1</td></tr><tr><th>27</th><td>C009651</td><td>S103706</td><td>2014</td><td>female</td><td>8.1232</td><td>1</td></tr><tr><th>28</th><td>C009879</td><td>S105909</td><td>2014</td><td>female</td><td>8.1232</td><td>1</td></tr><tr><th>29</th><td>C010203</td><td>S102660</td><td>2016</td><td>male</td><td>8.12594</td><td>1</td></tr><tr><th>30</th><td>C010204</td><td>S102660</td><td>2016</td><td>male</td><td>8.12594</td><td>1</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div><p>⋮</p><p><i>Last Group (96529 rows): ntest = 5</i></p><div class="data-frame"><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Child</th><th>School</th><th>Cohort</th><th>Sex</th><th>age</th><th>ntest</th></tr><tr><th></th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="Float64">Float64</th><th title="Int64">Int64</th></tr></thead><tbody><tr><th>1</th><td>C002352</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>2</th><td>C002353</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>3</th><td>C002354</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>4</th><td>C002355</td><td>S100122</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>5</th><td>C002356</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>6</th><td>C002357</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>7</th><td>C002358</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>8</th><td>C002360</td><td>S100195</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>9</th><td>C002362</td><td>S100237</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>10</th><td>C002363</td><td>S100237</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>11</th><td>C002364</td><td>S100250</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>12</th><td>C002365</td><td>S100304</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>13</th><td>C002366</td><td>S100304</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>14</th><td>C002367</td><td>S100316</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>15</th><td>C002368</td><td>S100365</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>16</th><td>C002369</td><td>S100365</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>17</th><td>C002370</td><td>S100365</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>18</th><td>C002372</td><td>S100432</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>19</th><td>C002373</td><td>S100481</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>20</th><td>C002374</td><td>S100481</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>21</th><td>C002375</td><td>S100481</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>22</th><td>C002376</td><td>S100493</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>23</th><td>C002377</td><td>S100493</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>24</th><td>C002378</td><td>S100547</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>25</th><td>C002379</td><td>S100547</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>26</th><td>C002380</td><td>S100547</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>27</th><td>C002381</td><td>S100547</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>28</th><td>C002382</td><td>S100547</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>29</th><td>C002383</td><td>S100584</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>30</th><td>C002384</td><td>S100596</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
<p>Are the sexes represented more-or-less equally?</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(<span class="fu">groupby</span>(<span class="fu">first</span>(gdf), <span class="op">:</span>Sex), nrow <span class="op">=&gt;</span> <span class="op">:</span>nchild)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div class="data-frame"><p>2 rows × 2 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Sex</th><th>nchild</th></tr><tr><th></th><th title="String">String</th><th title="Int64">Int64</th></tr></thead><tbody><tr><th>1</th><td>male</td><td>230</td></tr><tr><th>2</th><td>female</td><td>232</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(<span class="fu">groupby</span>(<span class="fu">last</span>(gdf), <span class="op">:</span>Sex), nrow <span class="op">=&gt;</span> <span class="op">:</span>nchild)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div class="data-frame"><p>2 rows × 2 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Sex</th><th>nchild</th></tr><tr><th></th><th title="String">String</th><th title="Int64">Int64</th></tr></thead><tbody><tr><th>1</th><td>male</td><td>47552</td></tr><tr><th>2</th><td>female</td><td>48977</td></tr></tbody></table></div>
</div>
</div>
<p>What about the distribution of ages?</p>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="st">    ridgeplot!(ax::Axis, df::AbstractDataFrame, densvar::Symbol, group::Symbol; normalize=false)</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="st">    ridgeplot!(f::Figure, args...; pos=(1,1) kwargs...)</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="st">    ridgeplot(args...; kwargs...)</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="st">Create a "ridge plot".</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="st">A ridge plot is stacked plot of densities for a given variable (`densvar`) grouped by a different variable (`group`). Because densities can very widely in scale, it is sometimes useful to `normalize` the densities so that each density has a maximum of 1.</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="st">The non-mutating method creates a Figure before calling the method for Figure.</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="st">The method for Figure places the ridge plot in the grid position specified by `pos`, default is (1,1).</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ridgeplot!</span>(</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  ax<span class="op">::</span><span class="dt">Axis</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  df<span class="op">::</span><span class="dt">AbstractDataFrame</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  densvar<span class="op">::</span><span class="dt">Symbol</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  group<span class="op">::</span><span class="dt">Symbol</span>;</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  normalize<span class="op">=</span><span class="cn">false</span>,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># `normalize` makes it so that the max density is always 1</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># `normalize` works on the density not the area/mass</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  gdf <span class="op">=</span> <span class="fu">groupby</span>(df, group)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  dens <span class="op">=</span> <span class="fu">combine</span>(gdf, densvar <span class="op">=&gt;</span> kde <span class="op">=&gt;</span> <span class="op">:</span>kde)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort!</span>(dens, group)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  spacing <span class="op">=</span> normalize ? <span class="fl">1.0</span> <span class="op">:</span> <span class="fl">0.9</span> <span class="op">*</span> <span class="fu">maximum</span>(dens[!, <span class="op">:</span>kde]) <span class="cf">do</span> val</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">maximum</span>(val.density)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  nticks <span class="op">=</span> <span class="fu">length</span>(gdf)</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (idx, row) <span class="kw">in</span> <span class="fu">enumerate</span>(<span class="fu">eachrow</span>(dens))</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    dd <span class="op">=</span> <span class="cf">if</span> normalize</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>      row.kde.density <span class="op">./</span> <span class="fu">maximum</span>(row.kde.density)</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>      row.kde.density</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    offset <span class="op">=</span> idx <span class="op">*</span> spacing</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    lower <span class="op">=</span> <span class="fu">Node</span>(<span class="fu">Point2f</span>.(row.kde.x, offset))</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    upper <span class="op">=</span> <span class="fu">Node</span>(<span class="fu">Point2f</span>.(row.kde.x, dd <span class="op">.+</span> offset))</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">band!</span>(ax, lower, upper; color<span class="op">=</span>(<span class="op">:</span>black, <span class="fl">0.3</span>))</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines!</span>(ax, upper; color<span class="op">=</span>(<span class="op">:</span>black, <span class="fl">1.0</span>))</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  ax.yticks[] <span class="op">=</span> (</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1</span><span class="op">:</span>spacing<span class="op">:</span>(nticks <span class="op">*</span> spacing), <span class="fu">string</span>.(dens[!, group])</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylims!</span>(ax, <span class="fl">0</span>, (nticks <span class="op">+</span> <span class="fl">2</span>) <span class="op">*</span> spacing)</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>  ax.xlabel[] <span class="op">=</span> <span class="fu">string</span>(densvar)</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>  ax.ylabel[] <span class="op">=</span> <span class="fu">string</span>(group)</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ax</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ridgeplot!</span>(f<span class="op">::</span><span class="dt">Figure</span>, args<span class="op">...</span>; pos<span class="op">=</span>(<span class="fl">1</span>, <span class="fl">1</span>), kwargs<span class="op">...</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ridgeplot!</span>(<span class="fu">Axis</span>(f[pos<span class="op">...</span>]), args<span class="op">...</span>; kwargs<span class="op">...</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="st">    ridgeplot(args...; kwargs...)</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="st">See [ridgeplot!](@ref).</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ridgeplot</span>(args<span class="op">...</span>; kwargs<span class="op">...</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">ridgeplot!</span>(<span class="fu">Figure</span>(), args<span class="op">...</span>; kwargs<span class="op">...</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ridgeplot</span>(<span class="fu">parent</span>(gdf), <span class="op">:</span>age, <span class="op">:</span>ntest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parent</span>(gdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">

<div class="data-frame"><p>108,295 rows × 6 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Child</th><th>School</th><th>Cohort</th><th>Sex</th><th>age</th><th>ntest</th></tr><tr><th></th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="Float64">Float64</th><th title="Int64">Int64</th></tr></thead><tbody><tr><th>1</th><td>C002352</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>2</th><td>C002353</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>3</th><td>C002354</td><td>S100067</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>4</th><td>C002355</td><td>S100122</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>5</th><td>C002356</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>6</th><td>C002357</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>7</th><td>C002358</td><td>S100146</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>8</th><td>C002359</td><td>S100183</td><td>2013</td><td>female</td><td>7.99452</td><td>4</td></tr><tr><th>9</th><td>C002360</td><td>S100195</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>10</th><td>C002361</td><td>S100213</td><td>2013</td><td>male</td><td>7.99452</td><td>4</td></tr><tr><th>11</th><td>C002362</td><td>S100237</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>12</th><td>C002363</td><td>S100237</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>13</th><td>C002364</td><td>S100250</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>14</th><td>C002365</td><td>S100304</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>15</th><td>C002366</td><td>S100304</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>16</th><td>C002367</td><td>S100316</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>17</th><td>C002368</td><td>S100365</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>18</th><td>C002369</td><td>S100365</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>19</th><td>C002370</td><td>S100365</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>20</th><td>C002371</td><td>S100432</td><td>2013</td><td>female</td><td>7.99452</td><td>4</td></tr><tr><th>21</th><td>C002372</td><td>S100432</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>22</th><td>C002373</td><td>S100481</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>23</th><td>C002374</td><td>S100481</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>24</th><td>C002375</td><td>S100481</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>25</th><td>C002376</td><td>S100493</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>26</th><td>C002377</td><td>S100493</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>27</th><td>C002378</td><td>S100547</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>28</th><td>C002379</td><td>S100547</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>29</th><td>C002380</td><td>S100547</td><td>2013</td><td>male</td><td>7.99452</td><td>5</td></tr><tr><th>30</th><td>C002381</td><td>S100547</td><td>2013</td><td>female</td><td>7.99452</td><td>5</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="reading-arrow-files-in-other-languages" class="level2">
<h2 class="anchored" data-anchor-id="reading-arrow-files-in-other-languages">Reading Arrow files in other languages</h2>
<p>There are Arrow implementations for R (the <code>arrow</code> package) and for Python (<code>pyarrow</code>). They can be accessed within Julia using the <code>RCall</code> and <code>PyCall</code> packages.</p>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>feather <span class="op">=</span> <span class="fu">pyimport</span>(<span class="st">"pyarrow.feather"</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>feather.<span class="fu">read_table</span>(<span class="st">"./data/fggk21.arrow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>PyObject pyarrow.Table
Cohort: dictionary&lt;values=string, indices=int8, ordered=0&gt; not null
School: dictionary&lt;values=string, indices=int16, ordered=0&gt; not null
Child: dictionary&lt;values=string, indices=int32, ordered=0&gt; not null
Sex: dictionary&lt;values=string, indices=int8, ordered=0&gt; not null
age: double not null
Test: dictionary&lt;values=string, indices=int8, ordered=0&gt; not null
score: double not null
----
Cohort: [  -- dictionary:
["2011","2012","2013","2014","2015","2016","2017","2018","2019"]  -- indices:
[2,2,2,2,2,...,7,7,7,7,7]]
School: [  -- dictionary:
["S100572","S100833","S100912","S100948","S100997",...,"S400713","S400865","S700010","S401031","S401055"]  -- indices:
[419,419,419,419,419,...,275,275,275,275,275]]
Child: [  -- dictionary:
["C002352","C002353","C002354","C002355","C002356",...,"C117959","C117962","C117964","C117965","C117966"]  -- indices:
[0,0,0,0,0,...,108294,108294,108294,108294,108294]]
Sex: [  -- dictionary:
["female","male"]  -- indices:
[1,1,1,1,1,...,1,1,1,1,1]]
age: [[7.994524298425736,7.994524298425736,7.994524298425736,7.994524298425736,7.994524298425736,...,9.10609171800137,9.10609171800137,9.10609171800137,9.10609171800137,9.10609171800137]]
Test: [  -- dictionary:
["Run","Star_r","S20_r","SLJ","BPT"]  -- indices:
[2,4,3,1,0,...,2,4,3,1,0]]
score: [[5.2631578947368425,3.7,125,2.4714563106796112,1053,...,4.545454545454545,3.8,100,2.1850643776824032,990]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>R<span class="st">"""</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="st">fggk21 &lt;- arrow::read_feather("./data/fggk21.arrow")</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="st">nrow(fggk21)</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>RObject{IntSxp}
[1] 525126</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>R<span class="st">"tibble::glimpse(fggk21)"</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 525,126
Columns: 7</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$ Cohort &lt;fct&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 201…
$ School &lt;fct&gt; S100067, S100067, S100067, S100067, S100067, S100067, S100067, …
$ Child  &lt;fct&gt; C002352, C002352, C002352, C002352, C002352, C002353, C002353, …
$ Sex    &lt;fct&gt; male, male, male, male, male, male, male, male, male, male, mal…
$ age    &lt;dbl&gt; 7.994524, 7.994524, 7.994524, 7.994524, 7.994524, 7.994524, 7.9…
$ Test   &lt;fct&gt; S20_r, BPT, SLJ, Star_r, Run, S20_r, BPT, SLJ, Star_r, Run, S20…
$ score  &lt;dbl&gt; 5.263158, 3.700000, 125.000000, 2.471456, 1053.000000, 5.000000…</code></pre>
</div>
</div>
</section>
<section id="references" class="level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Fuehner2021" class="csl-entry" role="doc-biblioentry">
Fühner, Thea, Urs Granacher, Kathleen Golle, and Reinhold Kliegl. 2021. <span>“Age and Sex Effects in Physical Fitness Components of 108,295 Third Graders Including 515 Primary Schools and 9 Cohorts.”</span> <em>Scientific Reports</em> 11 (1). <a href="https://doi.org/10.1038/s41598-021-97000-4">https://doi.org/10.1038/s41598-021-97000-4</a>.
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./sleepstudy_speed.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">The sleepstudy: Speed - for a change …</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./glmm.html" class="pagination-link">
        <span class="nav-page-text">Generalized linear mixed models</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>