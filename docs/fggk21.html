<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Phillip Alday, Douglas Bates, Reinhold Kliegl, and Julius Krumbiegel">
<meta name="dcterms.date" content="2022-07-02">

<title>SMLP2022 - Basics with Emotikon Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./shrinkageplot.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">SMLP2022</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html">About</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/RePsychLing/SMLP2022"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Basics with Emotikon Project</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">SMLP2022 - Advanced frequentist methods</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./useful_packages.html" class="sidebar-item-text sidebar-link">Useful packages</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sleepstudy.html" class="sidebar-item-text sidebar-link">Analysis of the sleepstudy data</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sleepstudy_speed.html" class="sidebar-item-text sidebar-link">The sleepstudy: Speed - for a change …</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Arrow.html" class="sidebar-item-text sidebar-link">Notes on saved data files</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glmm.html" class="sidebar-item-text sidebar-link">Generalized linear mixed models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kb07.html" class="sidebar-item-text sidebar-link">Bootstrapping a fitted model</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kwdyz11.html" class="sidebar-item-text sidebar-link">RePsychLing Kliegl et al.&nbsp;(2010)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kkl15.html" class="sidebar-item-text sidebar-link">RePsychLing Kliegl, Kuschela, &amp; Laubrock (2015)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./shrinkageplot.html" class="sidebar-item-text sidebar-link">More on shrinkage plots</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fggk21.html" class="sidebar-item-text sidebar-link active">Basics with Emotikon Project</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#packages-and-functions" id="toc-packages-and-functions" class="nav-link active" data-scroll-target="#packages-and-functions">Packages and functions</a></li>
  <li><a href="#readme" id="toc-readme" class="nav-link" data-scroll-target="#readme">Readme</a></li>
  <li><a href="#preprocessing" id="toc-preprocessing" class="nav-link" data-scroll-target="#preprocessing">Preprocessing</a>
  <ul class="collapse">
  <li><a href="#read-data" id="toc-read-data" class="nav-link" data-scroll-target="#read-data">Read data</a></li>
  <li><a href="#extract-a-stratified-subsample" id="toc-extract-a-stratified-subsample" class="nav-link" data-scroll-target="#extract-a-stratified-subsample">Extract a stratified subsample</a></li>
  <li><a href="#no-evidence-for-age-x-sex-x-test-interaction" id="toc-no-evidence-for-age-x-sex-x-test-interaction" class="nav-link" data-scroll-target="#no-evidence-for-age-x-sex-x-test-interaction">No evidence for <code>age x Sex x Test</code> interaction</a></li>
  <li><a href="#seqdiffcoding-of-test" id="toc-seqdiffcoding-of-test" class="nav-link" data-scroll-target="#seqdiffcoding-of-test"><em>SeqDiffCoding</em> of <code>Test</code></a></li>
  </ul></li>
  <li><a href="#model-complexification" id="toc-model-complexification" class="nav-link" data-scroll-target="#model-complexification">Model complexification</a>
  <ul class="collapse">
  <li><a href="#lmm-m_ovi" id="toc-lmm-m_ovi" class="nav-link" data-scroll-target="#lmm-m_ovi">LMM <code>m_ovi</code></a></li>
  <li><a href="#lmm-m_zcp" id="toc-lmm-m_zcp" class="nav-link" data-scroll-target="#lmm-m_zcp">LMM <code>m_zcp</code></a></li>
  <li><a href="#lmm-m_cpx" id="toc-lmm-m_cpx" class="nav-link" data-scroll-target="#lmm-m_cpx">LMM <code>m_cpx</code></a></li>
  <li><a href="#model-comparisons" id="toc-model-comparisons" class="nav-link" data-scroll-target="#model-comparisons">Model comparisons</a></li>
  <li><a href="#fitting-an-overparameterized-lmm" id="toc-fitting-an-overparameterized-lmm" class="nav-link" data-scroll-target="#fitting-an-overparameterized-lmm">Fitting an overparameterized LMM</a></li>
  <li><a href="#fitting-the-published-lmm-m1-to-the-reduced-data" id="toc-fitting-the-published-lmm-m1-to-the-reduced-data" class="nav-link" data-scroll-target="#fitting-the-published-lmm-m1-to-the-reduced-data">Fitting the published LMM <code>m1</code> to the reduced data</a></li>
  <li><a href="#principle-component-analysis-of-random-effect-structure-repca" id="toc-principle-component-analysis-of-random-effect-structure-repca" class="nav-link" data-scroll-target="#principle-component-analysis-of-random-effect-structure-repca">Principle Component Analysis of Random Effect Structure (rePCA)</a></li>
  <li><a href="#effects-in-res" id="toc-effects-in-res" class="nav-link" data-scroll-target="#effects-in-res">Effects in RES</a></li>
  <li><a href="#summary-of-results-for-stratified-subset-of-data" id="toc-summary-of-results-for-stratified-subset-of-data" class="nav-link" data-scroll-target="#summary-of-results-for-stratified-subset-of-data">Summary of results for stratified subset of data</a></li>
  </ul></li>
  <li><a href="#age-x-sex-nested-in-levels-of-test" id="toc-age-x-sex-nested-in-levels-of-test" class="nav-link" data-scroll-target="#age-x-sex-nested-in-levels-of-test"><code>Age x Sex</code> nested in levels of <code>Test</code></a></li>
  <li><a href="#glossary-of-mixedmodels.jl-commands" id="toc-glossary-of-mixedmodels.jl-commands" class="nav-link" data-scroll-target="#glossary-of-mixedmodels.jl-commands">Glossary of <em>MixedModels.jl</em> commands</a>
  <ul class="collapse">
  <li><a href="#overall-summary-statistics" id="toc-overall-summary-statistics" class="nav-link" data-scroll-target="#overall-summary-statistics">Overall summary statistics</a></li>
  <li><a href="#fixed-effect-statistics" id="toc-fixed-effect-statistics" class="nav-link" data-scroll-target="#fixed-effect-statistics">Fixed-effect statistics</a></li>
  <li><a href="#covariance-parameter-estimates" id="toc-covariance-parameter-estimates" class="nav-link" data-scroll-target="#covariance-parameter-estimates">Covariance parameter estimates</a></li>
  <li><a href="#model-predictions" id="toc-model-predictions" class="nav-link" data-scroll-target="#model-predictions">Model “predictions”</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/RePsychLing/SMLP2022/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Basics with Emotikon Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Phillip Alday, Douglas Bates, Reinhold Kliegl, and Julius Krumbiegel </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2022-07-02</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>This script uses a subset of data reported in <span class="citation" data-cites="Fuehner2021">Fühner et al. (<a href="#ref-Fuehner2021" role="doc-biblioref">2021</a>)</span>. To circumvent delays associated with model fitting we work with models that are less complex than those in the reference publication. All the data to reproduce the models in the publication are used here, too; the script requires only a few changes to specify the more complex models in the article.</p>
<p>The script is structured in four main sections:</p>
<ol type="1">
<li><strong>Setup</strong> with reading and examing the data, plotting the main results, and specifying the contrasts for the fixed factor <code>Test</code></li>
<li>a demonstration of <strong>model complexification</strong> to determine a parsimonious random-effect structure appropriate for and supported by the data, including also a quite elaborate demonstration of <strong>principle component analyses (PCAs)</strong> of levels (scores) and effects,</li>
<li>specification of <strong>nested fixed effects or interactions</strong> in the levels of another, superordinate factors,</li>
<li>a <strong>Glossary of MixedModels.jl commands</strong> to inspect the information generated for a fitted model object.</li>
</ol>
<section id="packages-and-functions" class="level2">
<h2 class="anchored" data-anchor-id="packages-and-functions">Packages and functions</h2>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AlgebraOfGraphics</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AlgebraOfGraphics</span>: linear</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Arrow</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CairoMakie</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CategoricalArrays</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Chain</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrameMacros</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModels</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModelsMakie</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModelsMakie</span>: simplelinreg</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">contains</span>(<span class="fu">first</span>(<span class="bu">Sys</span>.<span class="fu">cpu_info</span>()).model, <span class="st">"Intel"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="im">using</span> <span class="bu">MKL             </span><span class="co"># faster LAPACK on Intel processors</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ProgressMeter</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Statistics</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsBase</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>datadir <span class="op">=</span> <span class="fu">joinpath</span>(<span class="pp">@__DIR__</span>, <span class="st">"data"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>ProgressMeter.<span class="fu">ijulia_behavior</span>(<span class="op">:</span>clear)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>CairoMakie.<span class="fu">activate!</span>(; <span class="kw">type</span><span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="readme" class="level2">
<h2 class="anchored" data-anchor-id="readme">Readme</h2>
<p>Number of scores: 525126 in ‘./data/fggk21.arrow’</p>
<ol type="1">
<li><p>Cohort: 9 levels; 2011-2019</p></li>
<li><p>School: 515 levels</p></li>
<li><p>Child: 108295 levels; all children are between 8.0 and 8.99 years old</p></li>
<li><p>Sex: “Girls” (n=55,086), “Boys” (n= 53,209)</p></li>
<li><p>age: testdate - middle of month of birthdate</p></li>
<li><p>Test: 5 levels</p>
<ul>
<li>Endurance (<code>Run</code>): 6 minute endurance run [m]; to nearest 9m in 9x18m field</li>
<li>Coordination (<code>Star_r</code>): star coordination run [m/s]; 9x9m field, 4 x diagonal = 50.912 m</li>
<li>Speed(<code>S20_r</code>): 20-meters sprint [m/s]</li>
<li>Muscle power low (<code>SLJ</code>): standing long jump [cm]</li>
<li>Muscle power up (<code>BPT</code>): 1-kg medicine ball push test [m]</li>
</ul></li>
<li><p>score - see units</p></li>
</ol>
</section>
<section id="preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="preprocessing">Preprocessing</h2>
<section id="read-data" class="level3">
<h3 class="anchored" data-anchor-id="read-data">Read data</h3>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="pp">@chain</span> <span class="st">"fggk21.arrow"</span> <span class="cf">begin</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">joinpath</span>(datadir, _)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  Arrow.Table</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  DataFrame</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>age <span class="op">=&gt;</span> (x <span class="op">-&gt;</span> x <span class="op">.-</span> <span class="fl">8.5</span>) <span class="op">=&gt;</span> <span class="op">:</span>a1,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>Sex <span class="op">=&gt;</span> categorical <span class="op">=&gt;</span> <span class="op">:</span>Sex,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span><span class="bu">Test</span> <span class="op">=&gt;</span> categorical <span class="op">=&gt;</span> <span class="op">:</span><span class="bu">Test</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#levels!(df.Sex, ["Boys", "Girls"])</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">levels!</span>(df.<span class="bu">Test</span>, [<span class="st">"Run"</span>, <span class="st">"Star_r"</span>, <span class="st">"S20_r"</span>, <span class="st">"SLJ"</span>, <span class="st">"BPT"</span>])</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">recode!</span>(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  df.<span class="bu">Test</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Run"</span> <span class="op">=&gt;</span> <span class="st">"Endurance"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Star_r"</span> <span class="op">=&gt;</span> <span class="st">"Coordination"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S20_r"</span> <span class="op">=&gt;</span> <span class="st">"Speed"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SLJ"</span> <span class="op">=&gt;</span> <span class="st">"PowerLOW"</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"BPT"</span> <span class="op">=&gt;</span> <span class="st">"PowerUP"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div class="data-frame"><p>8 rows × 7 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>variable</th><th>mean</th><th>min</th><th>median</th><th>max</th><th>nmissing</th><th>eltype</th></tr><tr><th></th><th title="Symbol">Symbol</th><th title="Union{Nothing, Float64}">Union…</th><th title="Any">Any</th><th title="Union{Nothing, Float64}">Union…</th><th title="Any">Any</th><th title="Int64">Int64</th><th title="DataType">DataType</th></tr></thead><tbody><tr><th>1</th><td>Cohort</td><td></td><td>2011</td><td></td><td>2019</td><td>0</td><td>String</td></tr><tr><th>2</th><td>School</td><td></td><td>S100043</td><td></td><td>S800200</td><td>0</td><td>String</td></tr><tr><th>3</th><td>Child</td><td></td><td>C002352</td><td></td><td>C117966</td><td>0</td><td>String</td></tr><tr><th>4</th><td>Sex</td><td></td><td>female</td><td></td><td>male</td><td>0</td><td>CategoricalValue{String, UInt32}</td></tr><tr><th>5</th><td>age</td><td>8.56073</td><td>7.99452</td><td>8.55852</td><td>9.10609</td><td>0</td><td>Float64</td></tr><tr><th>6</th><td>Test</td><td></td><td>Endurance</td><td></td><td>PowerUP</td><td>0</td><td>CategoricalValue{String, UInt32}</td></tr><tr><th>7</th><td>score</td><td>226.141</td><td>1.14152</td><td>4.65116</td><td>1530.0</td><td>0</td><td>Float64</td></tr><tr><th>8</th><td>a1</td><td>0.0607297</td><td>-0.505476</td><td>0.0585216</td><td>0.606092</td><td>0</td><td>Float64</td></tr></tbody></table></div>
</div>
</div>
<section id="transformations" class="level4">
<h4 class="anchored" data-anchor-id="transformations">Transformations</h4>
<p>We center <code>age</code> at 8.5 years and compute z-scores for each <code>Test</code>. With these variables the data frame <code>df</code> contains all variables used for the final model in the original publication.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select!</span>(<span class="fu">groupby</span>(df, <span class="op">:</span><span class="bu">Test</span>), <span class="op">:</span>, <span class="op">:</span>score <span class="op">=&gt;</span> zscore <span class="op">=&gt;</span> <span class="op">:</span>zScore)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>dfx <span class="op">=</span> df[<span class="op">:</span>, <span class="fu">Not</span>(<span class="op">:</span>score)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div class="data-frame"><p>525,126 rows × 8 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Test</th><th>Cohort</th><th>School</th><th>Child</th><th>Sex</th><th>age</th><th>a1</th><th>zScore</th></tr><tr><th></th><th title="CategoricalValue{String, UInt32}">Cat…</th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="CategoricalValue{String, UInt32}">Cat…</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>Speed</td><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>1.7913</td></tr><tr><th>2</th><td>PowerUP</td><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.0622317</td></tr><tr><th>3</th><td>PowerLOW</td><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.0336567</td></tr><tr><th>4</th><td>Coordination</td><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>1.46874</td></tr><tr><th>5</th><td>Endurance</td><td>2013</td><td>S100067</td><td>C002352</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>0.331058</td></tr><tr><th>6</th><td>Speed</td><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>1.15471</td></tr><tr><th>7</th><td>PowerUP</td><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>0.498354</td></tr><tr><th>8</th><td>PowerLOW</td><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.498822</td></tr><tr><th>9</th><td>Coordination</td><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.9773</td></tr><tr><th>10</th><td>Endurance</td><td>2013</td><td>S100067</td><td>C002353</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>0.574056</td></tr><tr><th>11</th><td>Speed</td><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>0.0551481</td></tr><tr><th>12</th><td>PowerUP</td><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>0.218061</td></tr><tr><th>13</th><td>PowerLOW</td><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.757248</td></tr><tr><th>14</th><td>Coordination</td><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.209186</td></tr><tr><th>15</th><td>Endurance</td><td>2013</td><td>S100067</td><td>C002354</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.944681</td></tr><tr><th>16</th><td>Speed</td><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>-0.505476</td><td>0.0551481</td></tr><tr><th>17</th><td>PowerUP</td><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>-0.505476</td><td>-1.04326</td></tr><tr><th>18</th><td>PowerLOW</td><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>-0.505476</td><td>-0.602193</td></tr><tr><th>19</th><td>Coordination</td><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>-0.505476</td><td>-0.71013</td></tr><tr><th>20</th><td>Endurance</td><td>2013</td><td>S100122</td><td>C002355</td><td>female</td><td>7.99452</td><td>-0.505476</td><td>-1.14043</td></tr><tr><th>21</th><td>Speed</td><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.422921</td></tr><tr><th>22</th><td>PowerUP</td><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.622817</td></tr><tr><th>23</th><td>PowerLOW</td><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.395452</td></tr><tr><th>24</th><td>Coordination</td><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.493992</td></tr><tr><th>25</th><td>Endurance</td><td>2013</td><td>S100146</td><td>C002356</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.97168</td></tr><tr><th>26</th><td>Speed</td><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.422921</td></tr><tr><th>27</th><td>PowerUP</td><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>0.778646</td></tr><tr><th>28</th><td>PowerLOW</td><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>0.224769</td></tr><tr><th>29</th><td>Coordination</td><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.182076</td></tr><tr><th>30</th><td>Endurance</td><td>2013</td><td>S100146</td><td>C002357</td><td>male</td><td>7.99452</td><td>-0.505476</td><td>-0.296686</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
</section>
</section>
<section id="extract-a-stratified-subsample" class="level3">
<h3 class="anchored" data-anchor-id="extract-a-stratified-subsample">Extract a stratified subsample</h3>
<p>For the prupose of the tutorial, we extract a random sample of 1000 boys and 1000 girls. <code>Child</code>, <code>School</code>, and <code>Cohort</code> are grouping variables. Traditionally, they are called random factors because the units (levels) of the factor are assumed to be a random sample from the population of their units (levels).</p>
<p>Cohort has only nine “groups” and could have been included as a set of polynomical fixed-effect contrasts rather than a random factor. This choice warrants a short excursion: The secular trends are very different for different tests and require the inclusion of interaction terms with <code>Test</code> contrasts (see Figure 4 in <span class="citation" data-cites="Fuehner2021">(<a href="#ref-Fuehner2021" role="doc-biblioref">Fühner et al., 2021</a>)</span>. The authors opted to absorb these effects in cohort-related variance components for the <code>Test</code> contrasts and plan to address the details of secular changes in a separate analysis.</p>
<p>For complex designs, when they are in the theoretical focus of an article, factors and covariates should be specified as part of the fixed effects. If they are not in the theoretical focus, but serve as statistical control variables, they could be put in the RES - if supported by the data.</p>
<p><strong>Stratified sampling:</strong> We generate a <code>Child</code> table with information about children. <code>MersenneTwister(42)</code> specifies <strong>42</strong> as the seed for the random number generator to ensure reproducibility of the stratification. For a different pattern of results choose, for example, <strong>84</strong>. We randomly sample 1000 boys and 1000 girls from this table; they are stored in <code>samp</code>. Then, we extract the corresponding subset of these children’s test scores from <code>df</code> and store them <code>dat</code>.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Child <span class="op">=</span> <span class="fu">unique</span>(<span class="fu">select</span>(df, <span class="op">:</span>Cohort, <span class="op">:</span>School, <span class="op">:</span>Child, <span class="op">:</span>Sex, <span class="op">:</span>age))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  rng <span class="op">=</span> <span class="fu">MersenneTwister</span>(<span class="fl">42</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">groupby</span>(Child, <span class="op">:</span>Sex), x <span class="op">-&gt;</span> x[<span class="fu">rand</span>(rng, <span class="fl">1</span><span class="op">:</span><span class="fu">nrow</span>(x), <span class="fl">1000</span>), <span class="op">:</span>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">insamp</span>(x) <span class="op">=</span> x <span class="op">∈</span> sample.Child</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>dat <span class="op">=</span> <span class="pp">@subset</span>(df, <span class="fu">insamp</span>(<span class="op">:</span>Child))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div class="data-frame"><p>9,615 rows × 9 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Test</th><th>Cohort</th><th>School</th><th>Child</th><th>Sex</th><th>age</th><th>score</th><th>a1</th><th>zScore</th></tr><tr><th></th><th title="CategoricalValue{String, UInt32}">Cat…</th><th title="String">String</th><th title="String">String</th><th title="String">String</th><th title="CategoricalValue{String, UInt32}">Cat…</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>Speed</td><td>2013</td><td>S101825</td><td>C002497</td><td>male</td><td>7.99452</td><td>4.08163</td><td>-0.505476</td><td>-1.06685</td></tr><tr><th>2</th><td>PowerUP</td><td>2013</td><td>S101825</td><td>C002497</td><td>male</td><td>7.99452</td><td>3.5</td><td>-0.505476</td><td>-0.342524</td></tr><tr><th>3</th><td>PowerLOW</td><td>2013</td><td>S101825</td><td>C002497</td><td>male</td><td>7.99452</td><td>140.0</td><td>-0.505476</td><td>0.74162</td></tr><tr><th>4</th><td>Coordination</td><td>2013</td><td>S101825</td><td>C002497</td><td>male</td><td>7.99452</td><td>2.02032</td><td>-0.505476</td><td>-0.0994548</td></tr><tr><th>5</th><td>Endurance</td><td>2013</td><td>S101825</td><td>C002497</td><td>male</td><td>7.99452</td><td>1089.0</td><td>-0.505476</td><td>0.574056</td></tr><tr><th>6</th><td>Speed</td><td>2013</td><td>S102090</td><td>C002514</td><td>male</td><td>7.99452</td><td>4.44444</td><td>-0.505476</td><td>-0.189199</td></tr><tr><th>7</th><td>PowerUP</td><td>2013</td><td>S102090</td><td>C002514</td><td>male</td><td>7.99452</td><td>4.1</td><td>-0.505476</td><td>0.498354</td></tr><tr><th>8</th><td>PowerLOW</td><td>2013</td><td>S102090</td><td>C002514</td><td>male</td><td>7.99452</td><td>120.0</td><td>-0.505476</td><td>-0.292082</td></tr><tr><th>9</th><td>Coordination</td><td>2013</td><td>S102090</td><td>C002514</td><td>male</td><td>7.99452</td><td>2.09514</td><td>-0.505476</td><td>0.160648</td></tr><tr><th>10</th><td>Endurance</td><td>2013</td><td>S102090</td><td>C002514</td><td>male</td><td>7.99452</td><td>927.0</td><td>-0.505476</td><td>-0.519434</td></tr><tr><th>11</th><td>Speed</td><td>2013</td><td>S103366</td><td>C002633</td><td>male</td><td>7.99452</td><td>4.7619</td><td>-0.505476</td><td>0.578748</td></tr><tr><th>12</th><td>PowerUP</td><td>2013</td><td>S103366</td><td>C002633</td><td>male</td><td>7.99452</td><td>3.9</td><td>-0.505476</td><td>0.218061</td></tr><tr><th>13</th><td>PowerLOW</td><td>2013</td><td>S103366</td><td>C002633</td><td>male</td><td>7.99452</td><td>138.0</td><td>-0.505476</td><td>0.638249</td></tr><tr><th>14</th><td>Coordination</td><td>2013</td><td>S103366</td><td>C002633</td><td>male</td><td>7.99452</td><td>2.33541</td><td>-0.505476</td><td>0.995839</td></tr><tr><th>15</th><td>Endurance</td><td>2013</td><td>S103366</td><td>C002633</td><td>male</td><td>7.99452</td><td>1007.0</td><td>-0.505476</td><td>0.0205607</td></tr><tr><th>16</th><td>Speed</td><td>2013</td><td>S104000</td><td>C002710</td><td>male</td><td>7.99452</td><td>5.12821</td><td>-0.505476</td><td>1.46484</td></tr><tr><th>17</th><td>PowerUP</td><td>2013</td><td>S104000</td><td>C002710</td><td>male</td><td>7.99452</td><td>4.5</td><td>-0.505476</td><td>1.05894</td></tr><tr><th>18</th><td>PowerLOW</td><td>2013</td><td>S104000</td><td>C002710</td><td>male</td><td>7.99452</td><td>165.0</td><td>-0.505476</td><td>2.03375</td></tr><tr><th>19</th><td>Coordination</td><td>2013</td><td>S104000</td><td>C002710</td><td>male</td><td>7.99452</td><td>2.62433</td><td>-0.505476</td><td>2.00013</td></tr><tr><th>20</th><td>Endurance</td><td>2013</td><td>S104000</td><td>C002710</td><td>male</td><td>7.99452</td><td>1500.0</td><td>-0.505476</td><td>3.34828</td></tr><tr><th>21</th><td>Speed</td><td>2013</td><td>S104255</td><td>C002715</td><td>male</td><td>7.99452</td><td>4.44444</td><td>-0.505476</td><td>-0.189199</td></tr><tr><th>22</th><td>PowerUP</td><td>2013</td><td>S104255</td><td>C002715</td><td>male</td><td>7.99452</td><td>3.5</td><td>-0.505476</td><td>-0.342524</td></tr><tr><th>23</th><td>PowerLOW</td><td>2013</td><td>S104255</td><td>C002715</td><td>male</td><td>7.99452</td><td>128.0</td><td>-0.505476</td><td>0.121399</td></tr><tr><th>24</th><td>Coordination</td><td>2013</td><td>S104255</td><td>C002715</td><td>male</td><td>7.99452</td><td>1.98875</td><td>-0.505476</td><td>-0.209186</td></tr><tr><th>25</th><td>Endurance</td><td>2013</td><td>S104255</td><td>C002715</td><td>male</td><td>7.99452</td><td>960.0</td><td>-0.505476</td><td>-0.296686</td></tr><tr><th>26</th><td>Speed</td><td>2013</td><td>S104632</td><td>C002732</td><td>male</td><td>7.99452</td><td>5.12821</td><td>-0.505476</td><td>1.46484</td></tr><tr><th>27</th><td>PowerUP</td><td>2013</td><td>S104632</td><td>C002732</td><td>male</td><td>7.99452</td><td>4.7</td><td>-0.505476</td><td>1.33923</td></tr><tr><th>28</th><td>PowerLOW</td><td>2013</td><td>S104632</td><td>C002732</td><td>male</td><td>7.99452</td><td>159.0</td><td>-0.505476</td><td>1.72364</td></tr><tr><th>29</th><td>Coordination</td><td>2013</td><td>S104632</td><td>C002732</td><td>male</td><td>7.99452</td><td>2.01233</td><td>-0.505476</td><td>-0.127213</td></tr><tr><th>30</th><td>Endurance</td><td>2013</td><td>S104632</td><td>C002732</td><td>male</td><td>7.99452</td><td>1071.0</td><td>-0.505476</td><td>0.452557</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
<p>Due to missing scores for some tests we have about 2% less than 10,000 observtions.</p>
</section>
<section id="no-evidence-for-age-x-sex-x-test-interaction" class="level3">
<h3 class="anchored" data-anchor-id="no-evidence-for-age-x-sex-x-test-interaction">No evidence for <code>age x Sex x Test</code> interaction</h3>
<p>The main results are captured in the figure constructed in this section. We build it both for the full data and the stratified subset.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> <span class="fu">combine</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(df, <span class="op">:</span>, <span class="op">:</span>age <span class="op">=&gt;</span> <span class="fu">ByRow</span>(x <span class="op">-&gt;</span> <span class="fu">round</span>(x; digits<span class="op">=</span><span class="fl">1</span>)) <span class="op">=&gt;</span> <span class="op">:</span>age),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    [<span class="op">:</span>Sex, <span class="op">:</span><span class="bu">Test</span>, <span class="op">:</span>age],</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>zScore <span class="op">=&gt;</span> mean <span class="op">=&gt;</span> <span class="op">:</span>zScore,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>zScore <span class="op">=&gt;</span> length <span class="op">=&gt;</span> <span class="op">:</span>n,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

<div class="data-frame"><p>120 rows × 5 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Sex</th><th>Test</th><th>age</th><th>zScore</th><th>n</th></tr><tr><th></th><th title="CategoricalValue{String, UInt32}">Cat…</th><th title="CategoricalValue{String, UInt32}">Cat…</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Int64">Int64</th></tr></thead><tbody><tr><th>1</th><td>male</td><td>Speed</td><td>8.0</td><td>-0.0265138</td><td>1223</td></tr><tr><th>2</th><td>male</td><td>PowerUP</td><td>8.0</td><td>0.026973</td><td>1227</td></tr><tr><th>3</th><td>male</td><td>PowerLOW</td><td>8.0</td><td>0.121609</td><td>1227</td></tr><tr><th>4</th><td>male</td><td>Coordination</td><td>8.0</td><td>-0.0571726</td><td>1186</td></tr><tr><th>5</th><td>male</td><td>Endurance</td><td>8.0</td><td>0.292695</td><td>1210</td></tr><tr><th>6</th><td>female</td><td>Speed</td><td>8.0</td><td>-0.35164</td><td>1411</td></tr><tr><th>7</th><td>female</td><td>PowerUP</td><td>8.0</td><td>-0.610355</td><td>1417</td></tr><tr><th>8</th><td>female</td><td>PowerLOW</td><td>8.0</td><td>-0.279872</td><td>1418</td></tr><tr><th>9</th><td>female</td><td>Coordination</td><td>8.0</td><td>-0.268221</td><td>1381</td></tr><tr><th>10</th><td>female</td><td>Endurance</td><td>8.0</td><td>-0.245573</td><td>1387</td></tr><tr><th>11</th><td>male</td><td>Speed</td><td>8.1</td><td>0.0608397</td><td>3042</td></tr><tr><th>12</th><td>male</td><td>PowerUP</td><td>8.1</td><td>0.0955413</td><td>3069</td></tr><tr><th>13</th><td>male</td><td>PowerLOW</td><td>8.1</td><td>0.123099</td><td>3069</td></tr><tr><th>14</th><td>male</td><td>Coordination</td><td>8.1</td><td>-0.0112098</td><td>2986</td></tr><tr><th>15</th><td>male</td><td>Endurance</td><td>8.1</td><td>0.228915</td><td>2989</td></tr><tr><th>16</th><td>female</td><td>Speed</td><td>8.1</td><td>-0.25567</td><td>3395</td></tr><tr><th>17</th><td>female</td><td>PowerLOW</td><td>8.1</td><td>-0.283061</td><td>3426</td></tr><tr><th>18</th><td>female</td><td>Coordination</td><td>8.1</td><td>-0.248837</td><td>3362</td></tr><tr><th>19</th><td>female</td><td>Endurance</td><td>8.1</td><td>-0.267019</td><td>3368</td></tr><tr><th>20</th><td>female</td><td>PowerUP</td><td>8.1</td><td>-0.577338</td><td>3439</td></tr><tr><th>21</th><td>female</td><td>Speed</td><td>8.2</td><td>-0.250296</td><td>5415</td></tr><tr><th>22</th><td>female</td><td>PowerUP</td><td>8.2</td><td>-0.490636</td><td>5507</td></tr><tr><th>23</th><td>female</td><td>PowerLOW</td><td>8.2</td><td>-0.259983</td><td>5489</td></tr><tr><th>24</th><td>female</td><td>Coordination</td><td>8.2</td><td>-0.207378</td><td>5398</td></tr><tr><th>25</th><td>female</td><td>Endurance</td><td>8.2</td><td>-0.262365</td><td>5398</td></tr><tr><th>26</th><td>male</td><td>Speed</td><td>8.2</td><td>0.053516</td><td>4752</td></tr><tr><th>27</th><td>male</td><td>PowerUP</td><td>8.2</td><td>0.141768</td><td>4811</td></tr><tr><th>28</th><td>male</td><td>PowerLOW</td><td>8.2</td><td>0.109677</td><td>4802</td></tr><tr><th>29</th><td>male</td><td>Coordination</td><td>8.2</td><td>-0.00553236</td><td>4680</td></tr><tr><th>30</th><td>male</td><td>Endurance</td><td>8.2</td><td>0.230148</td><td>4714</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
<section id="figures-of-interaction" class="level4">
<h4 class="anchored" data-anchor-id="figures-of-interaction">Figure(s) of interaction</h4>
<p>The core results of the article are reported in Figure 2 of <span class="citation" data-cites="Fuehner2021">Fühner et al. (<a href="#ref-Fuehner2021" role="doc-biblioref">2021</a>)</span>. In summary:</p>
<ul>
<li>Main effects of <code>age</code> and <code>Sex</code>: There are developmental gains in the ninth year of life; boys outperform girls. There is no main effect of <code>Test</code> because of z-scoring.</li>
<li>Interactions of <code>Test</code> and <code>age</code>: Tests differ in how much children improve during the year (i.e., the magnitude of developmental gain), that is slopes depend on <code>Test</code>.</li>
<li>Interactions of <code>Test</code> and <code>Sex</code>: The sex difference is test dependent, that is the difference between the slopes depends on <code>Test</code>.</li>
<li>The most distinctive result is the absence of evidence for an <code>age x Sex x Test</code> interaction, that is the slopes for boys and girls are statistically parallel for each of the five tests.</li>
</ul>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  design1 <span class="op">=</span> <span class="fu">mapping</span>(<span class="op">:</span>age, <span class="op">:</span>zScore; color<span class="op">=:</span>Sex, col<span class="op">=:</span><span class="bu">Test</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  lines1 <span class="op">=</span> design1 <span class="op">*</span> <span class="fu">linear</span>()</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  means1 <span class="op">=</span> design1 <span class="op">*</span> <span class="fu">visual</span>(Scatter; markersize<span class="op">=</span><span class="fl">5</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw</span>(<span class="fu">data</span>(df2) <span class="op">*</span> means1 <span class="op">+</span> <span class="fu">data</span>(df) <span class="op">*</span> lines1;)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">
<div id="fig-agetrends" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="fggk21_files/figure-html/fig-agetrends-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 1: Age trends by sex for each Test for the full data set</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><a href="#fig-agetrends">Figure&nbsp;1</a> shows performance differences for the <strong>full set of data</strong> between 8.0 and 9.2 years by sex in the five physical fitness tests presented as z-transformed data computed separately for each test.</p>
<ul>
<li><code>Endurance</code> = cardiorespiratory endurance (i.e., 6-min-run test),</li>
<li><code>Coordination</code> = star-run test,</li>
<li><code>Speed</code> = 20-m linear sprint test,</li>
<li><code>PowerLOW</code> = power of lower limbs (i.e., standing long jump test),</li>
<li><code>PowerUP</code> = power of upper limbs (i.e., ball push test),</li>
<li>SD = standard deviation. Points are binned observed child means; lines are simple regression fits to the observations.</li>
</ul>
<p>What do the results look like for the stratified subsample? Here the parallelism is much less clear. In the final LMM we test whether the two regression lines in each of the five panels are statistically parallel for this subset of data. That is, we test the interaction of <code>Sex</code> and <code>age</code> as nested within the levels of <code>Test</code>. Most people want to know the signficance of these five Sex x age interactions.</p>
<p>The theoretical focus of the article, however, is on comparisons between tests displayed next to each other. We ask whether the degree of parallelism is statistically the same for <code>Endurance</code> and <code>Coordination</code> (H1), <code>Coordination</code> and <code>Speed</code> (H2), <code>Speed</code> and <code>PowerLOW</code> (H3), and <code>PowerLow</code> and <code>PowerUP</code> (H4). Hypotheses H1 to H4 require <code>Sequential Difference</code> contrasts c1 to c4 for <code>Test</code>; they are tested as fixed effects for`<code>H1 x age x Sex</code>, <code>H2 x age x Sex</code>, <code>H3 x age x Sex</code>, and <code>H4 x age x Sex</code>.</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dat2 <span class="op">=</span> <span class="fu">combine</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(dat, <span class="op">:</span>, <span class="op">:</span>age <span class="op">=&gt;</span> <span class="fu">ByRow</span>(x <span class="op">-&gt;</span> <span class="fu">round</span>(x; digits<span class="op">=</span><span class="fl">1</span>)) <span class="op">=&gt;</span> <span class="op">:</span>age),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    [<span class="op">:</span>Sex, <span class="op">:</span><span class="bu">Test</span>, <span class="op">:</span>age],</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>zScore <span class="op">=&gt;</span> mean <span class="op">=&gt;</span> <span class="op">:</span>zScore,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>zScore <span class="op">=&gt;</span> length <span class="op">=&gt;</span> <span class="op">:</span>n,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">

<div class="data-frame"><p>120 rows × 5 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Sex</th><th>Test</th><th>age</th><th>zScore</th><th>n</th></tr><tr><th></th><th title="CategoricalValue{String, UInt32}">Cat…</th><th title="CategoricalValue{String, UInt32}">Cat…</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Int64">Int64</th></tr></thead><tbody><tr><th>1</th><td>male</td><td>Speed</td><td>8.0</td><td>0.150743</td><td>25</td></tr><tr><th>2</th><td>male</td><td>PowerUP</td><td>8.0</td><td>0.0779146</td><td>24</td></tr><tr><th>3</th><td>male</td><td>PowerLOW</td><td>8.0</td><td>0.412902</td><td>25</td></tr><tr><th>4</th><td>male</td><td>Coordination</td><td>8.0</td><td>0.188266</td><td>25</td></tr><tr><th>5</th><td>male</td><td>Endurance</td><td>8.0</td><td>0.325118</td><td>25</td></tr><tr><th>6</th><td>female</td><td>Speed</td><td>8.0</td><td>-0.616063</td><td>20</td></tr><tr><th>7</th><td>female</td><td>PowerUP</td><td>8.0</td><td>-0.307488</td><td>20</td></tr><tr><th>8</th><td>female</td><td>PowerLOW</td><td>8.0</td><td>-0.354104</td><td>20</td></tr><tr><th>9</th><td>female</td><td>Coordination</td><td>8.0</td><td>-0.179897</td><td>17</td></tr><tr><th>10</th><td>female</td><td>Endurance</td><td>8.0</td><td>0.248867</td><td>17</td></tr><tr><th>11</th><td>male</td><td>Speed</td><td>8.1</td><td>0.374019</td><td>52</td></tr><tr><th>12</th><td>male</td><td>PowerUP</td><td>8.1</td><td>-0.0487561</td><td>52</td></tr><tr><th>13</th><td>male</td><td>PowerLOW</td><td>8.1</td><td>0.27049</td><td>52</td></tr><tr><th>14</th><td>male</td><td>Coordination</td><td>8.1</td><td>0.0147354</td><td>51</td></tr><tr><th>15</th><td>male</td><td>Endurance</td><td>8.1</td><td>0.560691</td><td>50</td></tr><tr><th>16</th><td>female</td><td>Speed</td><td>8.1</td><td>-0.301287</td><td>67</td></tr><tr><th>17</th><td>female</td><td>PowerUP</td><td>8.1</td><td>-0.580164</td><td>69</td></tr><tr><th>18</th><td>female</td><td>PowerLOW</td><td>8.1</td><td>-0.310809</td><td>69</td></tr><tr><th>19</th><td>female</td><td>Coordination</td><td>8.1</td><td>-0.117615</td><td>67</td></tr><tr><th>20</th><td>female</td><td>Endurance</td><td>8.1</td><td>-0.370734</td><td>67</td></tr><tr><th>21</th><td>female</td><td>Speed</td><td>8.2</td><td>-0.23471</td><td>106</td></tr><tr><th>22</th><td>female</td><td>PowerUP</td><td>8.2</td><td>-0.462286</td><td>110</td></tr><tr><th>23</th><td>female</td><td>PowerLOW</td><td>8.2</td><td>-0.22712</td><td>109</td></tr><tr><th>24</th><td>female</td><td>Coordination</td><td>8.2</td><td>-0.167625</td><td>106</td></tr><tr><th>25</th><td>female</td><td>Endurance</td><td>8.2</td><td>-0.174125</td><td>108</td></tr><tr><th>26</th><td>male</td><td>Speed</td><td>8.2</td><td>-0.15485</td><td>79</td></tr><tr><th>27</th><td>male</td><td>PowerUP</td><td>8.2</td><td>-0.0335271</td><td>83</td></tr><tr><th>28</th><td>male</td><td>PowerLOW</td><td>8.2</td><td>0.0537613</td><td>81</td></tr><tr><th>29</th><td>male</td><td>Coordination</td><td>8.2</td><td>-0.224568</td><td>83</td></tr><tr><th>30</th><td>male</td><td>Endurance</td><td>8.2</td><td>0.185428</td><td>80</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  design2 <span class="op">=</span> <span class="fu">mapping</span>(<span class="op">:</span>age, <span class="op">:</span>zScore; color<span class="op">=:</span>Sex, col<span class="op">=:</span><span class="bu">Test</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  lines2 <span class="op">=</span> design2 <span class="op">*</span> <span class="fu">linear</span>()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  means2 <span class="op">=</span> design2 <span class="op">*</span> <span class="fu">visual</span>(Scatter; markersize<span class="op">=</span><span class="fl">5</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw</span>(<span class="fu">data</span>(dat2) <span class="op">*</span> means2 <span class="op">+</span> <span class="fu">data</span>(dat) <span class="op">*</span> lines2;)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<div id="fig-agetrendssamp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="fggk21_files/figure-html/fig-agetrendssamp-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 2: Age trends by sex for each Test for the stratified sample</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><a href="#fig-agetrendssamp">Figure&nbsp;2</a> Performance differences for <strong>subset of data</strong> between 8.0 and 9.2 years by sex in the five physical fitness tests presented as z-transformed data computed separately for each test.</p>
<ul>
<li><code>Endurance</code> = cardiorespiratory endurance (i.e., 6-min-run test),</li>
<li><code>Coordination</code> = star-run test,</li>
<li><code>Speed</code> = 20-m linear sprint test,</li>
<li><code>PowerLOW</code> = power of lower limbs (i.e., standing long jump test),</li>
<li><code>PowerUP</code> = power of upper limbs (i.e., ball push test),</li>
<li>SD = standard deviation. Points are binned observed child means; lines are simple regression fits to the observations.</li>
</ul>
</section>
<section id="regression-on-age-by-sex-for-each-test" class="level4">
<h4 class="anchored" data-anchor-id="regression-on-age-by-sex-for-each-test">Regression on <code>age</code> by <code>Sex</code> for each <code>Test</code></h4>
<p>Another set of relevant statistics are the slopes for the regression of performance on age for boys and girls in each of the five tests. The lines in Figures 1 and 2, however, are computed directly from the raw data with the <code>linear()</code> command.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(df, [<span class="op">:</span>Sex, <span class="op">:</span><span class="bu">Test</span>]),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  [<span class="op">:</span>age, <span class="op">:</span>zScore] <span class="op">=&gt;</span> simplelinreg <span class="op">=&gt;</span> <span class="op">:</span>coef,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div class="data-frame"><p>10 rows × 3 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Sex</th><th>Test</th><th>coef</th></tr><tr><th></th><th title="CategoricalValue{String, UInt32}">Cat…</th><th title="CategoricalValue{String, UInt32}">Cat…</th><th title="Tuple{Float64, Float64}">Tuple…</th></tr></thead><tbody><tr><th>1</th><td>female</td><td>Endurance</td><td>(-0.692022, 0.0523217)</td></tr><tr><th>2</th><td>female</td><td>Coordination</td><td>(-2.50524, 0.279119)</td></tr><tr><th>3</th><td>female</td><td>Speed</td><td>(-2.34431, 0.255687)</td></tr><tr><th>4</th><td>female</td><td>PowerLOW</td><td>(-1.87241, 0.196917)</td></tr><tr><th>5</th><td>female</td><td>PowerUP</td><td>(-4.82271, 0.524799)</td></tr><tr><th>6</th><td>male</td><td>Endurance</td><td>(0.00256718, 0.0291899)</td></tr><tr><th>7</th><td>male</td><td>Coordination</td><td>(-2.47279, 0.302819)</td></tr><tr><th>8</th><td>male</td><td>Speed</td><td>(-2.12689, 0.267153)</td></tr><tr><th>9</th><td>male</td><td>PowerLOW</td><td>(-1.4307, 0.189659)</td></tr><tr><th>10</th><td>male</td><td>PowerUP</td><td>(-4.35864, 0.549005)</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(dat, [<span class="op">:</span>Sex, <span class="op">:</span><span class="bu">Test</span>]),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  [<span class="op">:</span>age, <span class="op">:</span>zScore] <span class="op">=&gt;</span> simplelinreg <span class="op">=&gt;</span> <span class="op">:</span>coef,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div class="data-frame"><p>10 rows × 3 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Sex</th><th>Test</th><th>coef</th></tr><tr><th></th><th title="CategoricalValue{String, UInt32}">Cat…</th><th title="CategoricalValue{String, UInt32}">Cat…</th><th title="Tuple{Float64, Float64}">Tuple…</th></tr></thead><tbody><tr><th>1</th><td>female</td><td>Endurance</td><td>(0.0307573, -0.0338037)</td></tr><tr><th>2</th><td>female</td><td>Coordination</td><td>(-1.03107, 0.105189)</td></tr><tr><th>3</th><td>female</td><td>Speed</td><td>(-2.00661, 0.212806)</td></tr><tr><th>4</th><td>female</td><td>PowerLOW</td><td>(-1.04703, 0.102421)</td></tr><tr><th>5</th><td>female</td><td>PowerUP</td><td>(-4.03432, 0.431796)</td></tr><tr><th>6</th><td>male</td><td>Endurance</td><td>(0.922801, -0.0732062)</td></tr><tr><th>7</th><td>male</td><td>Coordination</td><td>(-3.1484, 0.384406)</td></tr><tr><th>8</th><td>male</td><td>Speed</td><td>(-1.87647, 0.241661)</td></tr><tr><th>9</th><td>male</td><td>PowerLOW</td><td>(-0.576212, 0.0897968)</td></tr><tr><th>10</th><td>male</td><td>PowerUP</td><td>(-5.60153, 0.688667)</td></tr></tbody></table></div>
</div>
</div>
</section>
</section>
<section id="seqdiffcoding-of-test" class="level3">
<h3 class="anchored" data-anchor-id="seqdiffcoding-of-test"><em>SeqDiffCoding</em> of <code>Test</code></h3>
<p><em>SeqDiffCoding</em> was used in the publication. This specification tests pairwise differences between the five neighboring levels of <code>Test</code>, that is:</p>
<ul>
<li>H1: <code>Star_r</code> - <code>Run</code> (2-1)</li>
<li>H2: <code>S20_r</code> - <code>Star_r</code> (3-2)</li>
<li>H3: <code>SLJ</code> - <code>S20_r</code> (4-3)</li>
<li>H4: <code>BPT</code> - <code>SLJ</code> (5-4)</li>
</ul>
<p>The levels were sorted such that these contrasts map onto four <em>a priori</em> hypotheses; in other words, they are <em>theoretically</em> motivated pairwise comparisons. The motivation also encompasses theoretically motivated interactions with <code>Sex</code>. The order of levels can also be explicitly specified during contrast construction. This is very useful if levels are in a different order in the dataframe.</p>
<p>Note that random factors <code>Child</code>, <code>School</code>, and <code>Cohort</code> are declared as <code>Grouping</code> variables. Technically, this specification is required for variables with a very large number of levels (e.g., 100K+ children). We recommend the explicit specification for all random factors as a general coding style.</p>
<p>The first command recodes names indicating the physical fitness components used in the above figures and tables back to the shorter actual test names. This reduces clutter in LMM outputs.</p>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">recode!</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  dat.<span class="bu">Test</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Endurance"</span> <span class="op">=&gt;</span> <span class="st">"Run"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Coordination"</span> <span class="op">=&gt;</span> <span class="st">"Star_r"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Speed"</span> <span class="op">=&gt;</span> <span class="st">"S20_r"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"PowerLOW"</span> <span class="op">=&gt;</span> <span class="st">"SLJ"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"PowerUP"</span> <span class="op">=&gt;</span> <span class="st">"BMT"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>contrasts <span class="op">=</span> <span class="fu">merge</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Dict</span>(nm <span class="op">=&gt;</span> <span class="fu">SeqDiffCoding</span>() <span class="cf">for</span> nm <span class="kw">in</span> (<span class="op">:</span><span class="bu">Test</span>, <span class="op">:</span>Sex)),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Dict</span>(nm <span class="op">=&gt;</span> <span class="fu">Grouping</span>() <span class="cf">for</span> nm <span class="kw">in</span> (<span class="op">:</span>Child, <span class="op">:</span>School, <span class="op">:</span>Cohort)),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The statistical disadvantage of <em>SeqDiffCoding</em> is that the contrasts are not orthogonal, that is the contrasts are correlated. This is obvious from the fact that levels 2, 3, and 4 are all used in two contrasts. One consequence of this is that correlation parameters estimated between neighboring contrasts (e.g., 2-1 and 3-2) are difficult to interpret. Usually, they will be negative because assuming some practical limitations on the overall range (e.g., between levels 1 and 3), a small “2-1” effect “correlates” negatively with a larger “3-2” effect for mathematical reasons.</p>
<p>Obviously, the tradeoff between theoretical motivation and statistical purity is something that must be considered carefully when planning the analysis.</p>
<p>Various options for contrast coding are the topic of the <em>MixedModelsTutorial_contrasts_emotikon.jl</em> and <em>MixedModelsTutorial_contrasts_kwdyz.jl</em> notebooks.</p>
</section>
</section>
<section id="model-complexification" class="level2">
<h2 class="anchored" data-anchor-id="model-complexification">Model complexification</h2>
<p>We fit and compare three LMMs with the same fixed-effect structure but increasing complexity of the random-effect structure for <code>School</code>. We ignore the other two random factors <code>Child</code> and <code>Cohort</code> to avoid undue delays when fitting the models.</p>
<ol type="1">
<li>LMM <code>m_ovi</code>: allowing only varying intercepts (“Grand Means”);</li>
<li>LMM <code>m_zcp</code>: adding variance components (VCs) for the four <code>Test</code> contrasts, <code>Sex</code>, and <code>age</code> to LMM <code>m_ovi</code>, yielding the zero-correlation parameters LMM;</li>
<li>LMM <code>m_cpx</code>: adding correlation parameters (CPs) to LMM <code>m_zcp</code>; yielding a complex LMM.</li>
</ol>
<p>In a final part illustrate how to check whether the complex model is supported by the data, rather than leading to a singular fit and, if supported by the data, whether there is an increase in goodness of fit associated with the model complexification.</p>
<section id="lmm-m_ovi" class="level3">
<h3 class="anchored" data-anchor-id="lmm-m_ovi">LMM <code>m_ovi</code></h3>
<p>In its random-effect structure (RES) we only vary intercepts (i.e., Grand Means) for <code>School</code> (LMM <code>m_ovi</code>), that is we allow that the schools differ in the average fitness of its children, average over the five tests.</p>
<p>It is well known that such a simple RES is likely to be anti-conservative with respect to fixed-effect test statistics.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>m_ovi <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span> zScore <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">*</span> Sex <span class="op">*</span> a1 <span class="op">+</span> (<span class="fl">1</span> <span class="op">|</span> School)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 17    Time: 0:00:00 (15.76 ms/it)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 44%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">σ_School</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0327</td>
<td style="text-align: right;">0.0185</td>
<td style="text-align: right;">-1.77</td>
<td style="text-align: right;">0.0773</td>
<td style="text-align: right;">0.3082</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0302</td>
<td style="text-align: right;">0.0308</td>
<td style="text-align: right;">-0.98</td>
<td style="text-align: right;">0.3274</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">-0.0011</td>
<td style="text-align: right;">0.0307</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.9719</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0132</td>
<td style="text-align: right;">0.0306</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.6661</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0590</td>
<td style="text-align: right;">0.0305</td>
<td style="text-align: right;">-1.94</td>
<td style="text-align: right;">0.0527</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.4210</td>
<td style="text-align: right;">0.0209</td>
<td style="text-align: right;">20.18</td>
<td style="text-align: right;">&lt;1e-89</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.2362</td>
<td style="text-align: right;">0.0357</td>
<td style="text-align: right;">6.61</td>
<td style="text-align: right;">&lt;1e-10</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: male</td>
<td style="text-align: right;">-0.3026</td>
<td style="text-align: right;">0.0616</td>
<td style="text-align: right;">-4.91</td>
<td style="text-align: right;">&lt;1e-06</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: male</td>
<td style="text-align: right;">0.1129</td>
<td style="text-align: right;">0.0615</td>
<td style="text-align: right;">1.84</td>
<td style="text-align: right;">0.0662</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: male</td>
<td style="text-align: right;">-0.0073</td>
<td style="text-align: right;">0.0612</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">0.9049</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: male</td>
<td style="text-align: right;">0.2534</td>
<td style="text-align: right;">0.0609</td>
<td style="text-align: right;">4.16</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.3003</td>
<td style="text-align: right;">0.1056</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">0.0044</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0146</td>
<td style="text-align: right;">0.1050</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">0.8893</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.1331</td>
<td style="text-align: right;">0.1046</td>
<td style="text-align: right;">-1.27</td>
<td style="text-align: right;">0.2032</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4661</td>
<td style="text-align: right;">0.1043</td>
<td style="text-align: right;">4.47</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex: male &amp; a1</td>
<td style="text-align: right;">0.1140</td>
<td style="text-align: right;">0.0712</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">0.1095</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; Sex: male &amp; a1</td>
<td style="text-align: right;">0.3349</td>
<td style="text-align: right;">0.2112</td>
<td style="text-align: right;">1.59</td>
<td style="text-align: right;">0.1127</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; Sex: male &amp; a1</td>
<td style="text-align: right;">-0.2487</td>
<td style="text-align: right;">0.2100</td>
<td style="text-align: right;">-1.18</td>
<td style="text-align: right;">0.2363</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; Sex: male &amp; a1</td>
<td style="text-align: right;">-0.0512</td>
<td style="text-align: right;">0.2091</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: right;">0.8064</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; Sex: male &amp; a1</td>
<td style="text-align: right;">0.2678</td>
<td style="text-align: right;">0.2087</td>
<td style="text-align: right;">1.28</td>
<td style="text-align: right;">0.1994</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.9295</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Is the model singular (overparameterized, degenerate)? In other words: Is the model not supported by the data?</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m_ovi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>false</code></pre>
</div>
</div>
<p>Models varying only in intercepts are almost always supported by the data.</p>
</section>
<section id="lmm-m_zcp" class="level3">
<h3 class="anchored" data-anchor-id="lmm-m_zcp">LMM <code>m_zcp</code></h3>
<p>In this LMM we allow that schools differ not only in <code>GM</code>, but also in the size of the four contrasts defined for <code>Test</code>, in the difference between boys and girls (<code>Sex</code>) and the developmental gain children achieve within the third grade (<code>age</code>).</p>
<p>We assume that there is covariance associated with these CPs beyond residual noise, that is we assume that there is no detectable evidence in the data that the CPs are different from zero.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>m_zcp <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    zScore <span class="op">~</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>      <span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">*</span> Sex <span class="op">*</span> a1 <span class="op">+</span> <span class="fu">zerocorr</span>(<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">+</span> Sex <span class="op">+</span> a1 <span class="op">|</span> School)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 191   Time: 0:00:00 ( 1.26 ms/it)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 44%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">σ_School</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0301</td>
<td style="text-align: right;">0.0187</td>
<td style="text-align: right;">-1.61</td>
<td style="text-align: right;">0.1075</td>
<td style="text-align: right;">0.2927</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0274</td>
<td style="text-align: right;">0.0302</td>
<td style="text-align: right;">-0.91</td>
<td style="text-align: right;">0.3650</td>
<td style="text-align: right;">0.1404</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">-0.0025</td>
<td style="text-align: right;">0.0298</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">0.9323</td>
<td style="text-align: right;">0.1186</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0121</td>
<td style="text-align: right;">0.0296</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.6825</td>
<td style="text-align: right;">0.1118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0538</td>
<td style="text-align: right;">0.0301</td>
<td style="text-align: right;">-1.79</td>
<td style="text-align: right;">0.0736</td>
<td style="text-align: right;">0.1539</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.4241</td>
<td style="text-align: right;">0.0330</td>
<td style="text-align: right;">12.84</td>
<td style="text-align: right;">&lt;1e-37</td>
<td style="text-align: right;">0.4668</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.2498</td>
<td style="text-align: right;">0.0575</td>
<td style="text-align: right;">4.35</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;">0.7804</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: male</td>
<td style="text-align: right;">-0.3046</td>
<td style="text-align: right;">0.0586</td>
<td style="text-align: right;">-5.20</td>
<td style="text-align: right;">&lt;1e-06</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: male</td>
<td style="text-align: right;">0.1115</td>
<td style="text-align: right;">0.0583</td>
<td style="text-align: right;">1.91</td>
<td style="text-align: right;">0.0561</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: male</td>
<td style="text-align: right;">-0.0031</td>
<td style="text-align: right;">0.0580</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.9573</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: male</td>
<td style="text-align: right;">0.2550</td>
<td style="text-align: right;">0.0580</td>
<td style="text-align: right;">4.40</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.2902</td>
<td style="text-align: right;">0.1004</td>
<td style="text-align: right;">2.89</td>
<td style="text-align: right;">0.0038</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0024</td>
<td style="text-align: right;">0.0997</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.9809</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.1387</td>
<td style="text-align: right;">0.0992</td>
<td style="text-align: right;">-1.40</td>
<td style="text-align: right;">0.1622</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4658</td>
<td style="text-align: right;">0.0992</td>
<td style="text-align: right;">4.69</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex: male &amp; a1</td>
<td style="text-align: right;">0.0438</td>
<td style="text-align: right;">0.0812</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.5900</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; Sex: male &amp; a1</td>
<td style="text-align: right;">0.3487</td>
<td style="text-align: right;">0.2007</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">0.0823</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; Sex: male &amp; a1</td>
<td style="text-align: right;">-0.2556</td>
<td style="text-align: right;">0.1993</td>
<td style="text-align: right;">-1.28</td>
<td style="text-align: right;">0.1996</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; Sex: male &amp; a1</td>
<td style="text-align: right;">-0.0561</td>
<td style="text-align: right;">0.1983</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">0.7771</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; Sex: male &amp; a1</td>
<td style="text-align: right;">0.2776</td>
<td style="text-align: right;">0.1984</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">0.1618</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.8780</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Depending on sampling, this model estimating variance components for <code>School</code> may or may not be supported by the data.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m_zcp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>false</code></pre>
</div>
</div>
</section>
<section id="lmm-m_cpx" class="level3">
<h3 class="anchored" data-anchor-id="lmm-m_cpx">LMM <code>m_cpx</code></h3>
<p>In the complex LMM investigated in this sequence we give up the assumption of zero-correlation between VCs.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>m_cpx <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    zScore <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">*</span> Sex <span class="op">*</span> a1 <span class="op">+</span> (<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">+</span> Sex <span class="op">+</span> a1 <span class="op">|</span> School)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 1713      Time: 0:00:01 ( 0.59 ms/it)
  objective:  26013.411466300993</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="17">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 44%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">σ_School</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0313</td>
<td style="text-align: right;">0.0188</td>
<td style="text-align: right;">-1.66</td>
<td style="text-align: right;">0.0971</td>
<td style="text-align: right;">0.2971</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0260</td>
<td style="text-align: right;">0.0316</td>
<td style="text-align: right;">-0.82</td>
<td style="text-align: right;">0.4112</td>
<td style="text-align: right;">0.2249</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">-0.0054</td>
<td style="text-align: right;">0.0311</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">0.8613</td>
<td style="text-align: right;">0.2015</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0139</td>
<td style="text-align: right;">0.0301</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.6455</td>
<td style="text-align: right;">0.1606</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0477</td>
<td style="text-align: right;">0.0300</td>
<td style="text-align: right;">-1.59</td>
<td style="text-align: right;">0.1114</td>
<td style="text-align: right;">0.1640</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.4245</td>
<td style="text-align: right;">0.0330</td>
<td style="text-align: right;">12.87</td>
<td style="text-align: right;">&lt;1e-37</td>
<td style="text-align: right;">0.4670</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.2531</td>
<td style="text-align: right;">0.0580</td>
<td style="text-align: right;">4.36</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;">0.7967</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: male</td>
<td style="text-align: right;">-0.3070</td>
<td style="text-align: right;">0.0587</td>
<td style="text-align: right;">-5.23</td>
<td style="text-align: right;">&lt;1e-06</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: male</td>
<td style="text-align: right;">0.1104</td>
<td style="text-align: right;">0.0585</td>
<td style="text-align: right;">1.89</td>
<td style="text-align: right;">0.0590</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: male</td>
<td style="text-align: right;">-0.0015</td>
<td style="text-align: right;">0.0579</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.9795</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: male</td>
<td style="text-align: right;">0.2614</td>
<td style="text-align: right;">0.0576</td>
<td style="text-align: right;">4.54</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.2885</td>
<td style="text-align: right;">0.1006</td>
<td style="text-align: right;">2.87</td>
<td style="text-align: right;">0.0041</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0005</td>
<td style="text-align: right;">0.0999</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.9959</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.1389</td>
<td style="text-align: right;">0.0990</td>
<td style="text-align: right;">-1.40</td>
<td style="text-align: right;">0.1606</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4584</td>
<td style="text-align: right;">0.0986</td>
<td style="text-align: right;">4.65</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex: male &amp; a1</td>
<td style="text-align: right;">0.0425</td>
<td style="text-align: right;">0.0810</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.5999</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; Sex: male &amp; a1</td>
<td style="text-align: right;">0.3488</td>
<td style="text-align: right;">0.2012</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">0.0829</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; Sex: male &amp; a1</td>
<td style="text-align: right;">-0.2506</td>
<td style="text-align: right;">0.1997</td>
<td style="text-align: right;">-1.26</td>
<td style="text-align: right;">0.2095</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; Sex: male &amp; a1</td>
<td style="text-align: right;">-0.0645</td>
<td style="text-align: right;">0.1979</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;">0.7444</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; Sex: male &amp; a1</td>
<td style="text-align: right;">0.2822</td>
<td style="text-align: right;">0.1971</td>
<td style="text-align: right;">1.43</td>
<td style="text-align: right;">0.1524</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.8736</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We also need to see the VCs and CPs of the random-effect structure (RES).</p>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m_cpx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Variance</th>
<th style="text-align: right;">Std.Dev</th>
<th style="text-align: right;">Corr.</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">School</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.088280</td>
<td style="text-align: right;">0.297120</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.050580</td>
<td style="text-align: right;">0.224901</td>
<td style="text-align: right;">+0.14</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.040588</td>
<td style="text-align: right;">0.201465</td>
<td style="text-align: right;">+0.01</td>
<td style="text-align: right;">-0.40</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.025807</td>
<td style="text-align: right;">0.160645</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.026909</td>
<td style="text-align: right;">0.164040</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: right;">+0.19</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">+0.37</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.218091</td>
<td style="text-align: right;">0.467002</td>
<td style="text-align: right;">+0.13</td>
<td style="text-align: right;">+0.07</td>
<td style="text-align: right;">+0.02</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">+0.36</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.634688</td>
<td style="text-align: right;">0.796673</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">-0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.763258</td>
<td style="text-align: right;">0.873646</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m_cpx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>true</code></pre>
</div>
</div>
<p>The complex model may or may not be supported by the data.</p>
</section>
<section id="model-comparisons" class="level3">
<h3 class="anchored" data-anchor-id="model-comparisons">Model comparisons</h3>
<p>The checks of model singularity indicate that the three models are supported by the data. Does model complexification also increase the goodness of fit or are we only fitting noise?</p>
<section id="lrt-and-goodness-of-fit-statistics" class="level4">
<h4 class="anchored" data-anchor-id="lrt-and-goodness-of-fit-statistics">LRT and goodness-of-fit statistics</h4>
<p>As the thee models are strictly hierarchically nested, we compare them with a likelihood-ratio tests (LRT) and AIC and BIC goodness-of-fit statistics derived from them.</p>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>MixedModels.<span class="fu">likelihoodratiotest</span>(m_ovi, m_zcp, m_cpx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 78%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">model-dof</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">χ²</th>
<th style="text-align: right;">χ²-dof</th>
<th style="text-align: left;">P(&gt;χ²)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">zScore ~ 1 + Test + Sex + a1 + Test &amp; Sex + Test &amp; a1 + Sex &amp; a1 + Test &amp; Sex &amp; a1 + (1 | School)</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">26373</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">zScore ~ 1 + Test + Sex + a1 + Test &amp; Sex + Test &amp; a1 + Sex &amp; a1 + Test &amp; Sex &amp; a1 + MixedModels.ZeroCorr((1 + Test + Sex + a1 | School))</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">26045</td>
<td style="text-align: right;">328</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">&lt;1e-67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zScore ~ 1 + Test + Sex + a1 + Test &amp; Sex + Test &amp; a1 + Sex &amp; a1 + Test &amp; Sex &amp; a1 + (1 + Test + Sex + a1 | School)</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">26013</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">0.0675</td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>gof_summary <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  nms <span class="op">=</span> [<span class="op">:</span>m_ovi, <span class="op">:</span>m_zcp, <span class="op">:</span>m_cpx]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  mods <span class="op">=</span> <span class="fu">eval</span>.(nms)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">DataFrame</span>(;</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span>nms,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    dof<span class="op">=</span><span class="fu">dof</span>.(mods),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    deviance<span class="op">=</span><span class="fu">deviance</span>.(mods),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    AIC<span class="op">=</span><span class="fu">aic</span>.(mods),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    AICc<span class="op">=</span><span class="fu">aicc</span>.(mods),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    BIC<span class="op">=</span><span class="fu">bic</span>.(mods),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">

<div class="data-frame"><p>3 rows × 6 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>name</th><th>dof</th><th>deviance</th><th>AIC</th><th>AICc</th><th>BIC</th></tr><tr><th></th><th title="Symbol">Symbol</th><th title="Int64">Int64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>m_ovi</td><td>22</td><td>26373.1</td><td>26417.1</td><td>26417.3</td><td>26574.9</td></tr><tr><th>2</th><td>m_zcp</td><td>28</td><td>26044.8</td><td>26100.8</td><td>26101.0</td><td>26301.6</td></tr><tr><th>3</th><td>m_cpx</td><td>49</td><td>26013.4</td><td>26111.4</td><td>26111.9</td><td>26462.8</td></tr></tbody></table></div>
</div>
</div>
<p>These statistics will depend on sampling. In general, smaller deviance, AIC, and BIC indicate an improvement in goodness of fit. Usually, χ² should be larger than the associated degrees of freedom; for AIC and BIC the decrease should amount to more than 5, according to some literature. Severity of meeting these criteria increases from deviance to AIC to BIC. Therefore, it is not always the case that the criteria are unanimous in their verdict. Basicly, the more confirmatory the analysis, the more one may go with deviance and AIC; for exploratory analyses the BIC is probably a better guide. There are grey zones here.</p>
</section>
<section id="comparing-fixed-effects-of-m_ovi-m_zcp-and-m_cpx" class="level4">
<h4 class="anchored" data-anchor-id="comparing-fixed-effects-of-m_ovi-m_zcp-and-m_cpx">Comparing fixed effects of <code>m_ovi</code>, <code>m_zcp</code>, and <code>m_cpx</code></h4>
<p>We check whether enriching the RES changed the significance of fixed effects in the final model.</p>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>m_ovi_fe <span class="op">=</span> <span class="fu">DataFrame</span>(<span class="fu">coeftable</span>(m_ovi));</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>m_zcp_fe <span class="op">=</span> <span class="fu">DataFrame</span>(<span class="fu">coeftable</span>(m_zcp));</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>m_cpx_fe <span class="op">=</span> <span class="fu">DataFrame</span>(<span class="fu">coeftable</span>(m_cpx));</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>m_all <span class="op">=</span> <span class="fu">hcat</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  m_ovi_fe[<span class="op">:</span>, [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>]],</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">leftjoin</span>(</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    m_zcp_fe[<span class="op">:</span>, [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>]],</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    m_cpx_fe[<span class="op">:</span>, [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>]];</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=:</span>Name,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    makeunique<span class="op">=</span><span class="cn">true</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  makeunique<span class="op">=</span><span class="cn">true</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rename!</span>(</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  m_all,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Coef."</span> <span class="op">=&gt;</span> <span class="st">"b_ovi"</span>,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Coef._2"</span> <span class="op">=&gt;</span> <span class="st">"b_zcp"</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Coef._1"</span> <span class="op">=&gt;</span> <span class="st">"b_cpx"</span>,</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"z"</span> <span class="op">=&gt;</span> <span class="st">"z_ovi"</span>,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"z_2"</span> <span class="op">=&gt;</span> <span class="st">"z_zcp"</span>,</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"z_1"</span> <span class="op">=&gt;</span> <span class="st">"z_cpx"</span>,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>m_all2 <span class="op">=</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>.(</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    m_all[<span class="op">:</span>, [<span class="op">:</span>b_ovi, <span class="op">:</span>b_zcp, <span class="op">:</span>b_cpx, <span class="op">:</span>z_ovi, <span class="op">:</span>z_zcp, <span class="op">:</span>z_cpx]],</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    digits<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>m_all3 <span class="op">=</span> <span class="fu">hcat</span>(m_all.Name, m_all2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">

<div class="data-frame"><p>20 rows × 7 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>x1</th><th>b_ovi</th><th>b_zcp</th><th>b_cpx</th><th>z_ovi</th><th>z_zcp</th><th>z_cpx</th></tr><tr><th></th><th title="String">String</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>(Intercept)</td><td>-0.03</td><td>-0.03</td><td>-0.03</td><td>-1.77</td><td>-1.61</td><td>-1.66</td></tr><tr><th>2</th><td>Test: Star_r</td><td>-0.03</td><td>-0.03</td><td>-0.03</td><td>-0.98</td><td>-0.91</td><td>-0.82</td></tr><tr><th>3</th><td>Test: S20_r</td><td>-0.0</td><td>-0.0</td><td>-0.01</td><td>-0.04</td><td>-0.08</td><td>-0.17</td></tr><tr><th>4</th><td>Test: SLJ</td><td>0.01</td><td>0.01</td><td>0.01</td><td>0.43</td><td>0.41</td><td>0.46</td></tr><tr><th>5</th><td>Test: BMT</td><td>-0.06</td><td>-0.05</td><td>-0.05</td><td>-1.94</td><td>-1.79</td><td>-1.59</td></tr><tr><th>6</th><td>Sex: male</td><td>0.42</td><td>0.42</td><td>0.42</td><td>20.18</td><td>12.84</td><td>12.87</td></tr><tr><th>7</th><td>a1</td><td>0.24</td><td>0.25</td><td>0.25</td><td>6.61</td><td>4.35</td><td>4.36</td></tr><tr><th>8</th><td>Test: Star_r &amp; Sex: male</td><td>-0.3</td><td>-0.3</td><td>-0.31</td><td>-4.91</td><td>-5.2</td><td>-5.23</td></tr><tr><th>9</th><td>Test: S20_r &amp; Sex: male</td><td>0.11</td><td>0.11</td><td>0.11</td><td>1.84</td><td>1.91</td><td>1.89</td></tr><tr><th>10</th><td>Test: SLJ &amp; Sex: male</td><td>-0.01</td><td>-0.0</td><td>-0.0</td><td>-0.12</td><td>-0.05</td><td>-0.03</td></tr><tr><th>11</th><td>Test: BMT &amp; Sex: male</td><td>0.25</td><td>0.26</td><td>0.26</td><td>4.16</td><td>4.4</td><td>4.54</td></tr><tr><th>12</th><td>Test: Star_r &amp; a1</td><td>0.3</td><td>0.29</td><td>0.29</td><td>2.84</td><td>2.89</td><td>2.87</td></tr><tr><th>13</th><td>Test: S20_r &amp; a1</td><td>-0.01</td><td>-0.0</td><td>-0.0</td><td>-0.14</td><td>-0.02</td><td>-0.01</td></tr><tr><th>14</th><td>Test: SLJ &amp; a1</td><td>-0.13</td><td>-0.14</td><td>-0.14</td><td>-1.27</td><td>-1.4</td><td>-1.4</td></tr><tr><th>15</th><td>Test: BMT &amp; a1</td><td>0.47</td><td>0.47</td><td>0.46</td><td>4.47</td><td>4.69</td><td>4.65</td></tr><tr><th>16</th><td>Sex: male &amp; a1</td><td>0.11</td><td>0.04</td><td>0.04</td><td>1.6</td><td>0.54</td><td>0.52</td></tr><tr><th>17</th><td>Test: Star_r &amp; Sex: male &amp; a1</td><td>0.33</td><td>0.35</td><td>0.35</td><td>1.59</td><td>1.74</td><td>1.73</td></tr><tr><th>18</th><td>Test: S20_r &amp; Sex: male &amp; a1</td><td>-0.25</td><td>-0.26</td><td>-0.25</td><td>-1.18</td><td>-1.28</td><td>-1.26</td></tr><tr><th>19</th><td>Test: SLJ &amp; Sex: male &amp; a1</td><td>-0.05</td><td>-0.06</td><td>-0.06</td><td>-0.25</td><td>-0.28</td><td>-0.33</td></tr><tr><th>20</th><td>Test: BMT &amp; Sex: male &amp; a1</td><td>0.27</td><td>0.28</td><td>0.28</td><td>1.28</td><td>1.4</td><td>1.43</td></tr></tbody></table></div>
</div>
</div>
<p>The three models usually do <strong>not</strong> differ in fixed-effect estimates. For main effects of <code>age</code> and <code>Sex</code>, z-values decrease strongly with the complexity of the model (i.e., standard errors are larger). For other coefficients, the changes are not very large and not consistent.</p>
<p>In general, dropping significant variance components and/or correlation parameters may lead to anti-conservative estimates of fixed effects <span class="citation" data-cites="Schielzeth2008">(e.g., <a href="#ref-Schielzeth2008" role="doc-biblioref">Schielzeth &amp; Forstmeier, 2008</a>)</span>. Basically, some of the variance allocated to <code>age</code> and <code>Sex</code> in LMM <code>m_ovi</code> could also be due to differences between schools. This ambiguity increased the uncertainty of the respective fixed effects in the other two LMMs.</p>
</section>
</section>
<section id="fitting-an-overparameterized-lmm" class="level3">
<h3 class="anchored" data-anchor-id="fitting-an-overparameterized-lmm">Fitting an overparameterized LMM</h3>
<p>The complex LMM was not overparameterized with respect to <code>School</code>, because there are over 400 schools in the data. When the number of units (levels) of a grouping factor is small relative to the number of parameters we are trying to estimate, we often end up with an overparameterized / degenerate random-effect structure.</p>
<p>As an illustration, we fit a full CP matrix for the <code>Cohort</code>. As there are only nine cohorts in the data, we may be asking too much to estimate 5*6/2 = 15 VC/CP parameters.</p>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>m_cpxCohort <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span> zScore <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">*</span> a1 <span class="op">*</span> Sex <span class="op">+</span> (<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Cohort)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 44%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">σ_Cohort</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0113</td>
<td style="text-align: right;">0.0141</td>
<td style="text-align: right;">-0.80</td>
<td style="text-align: right;">0.4230</td>
<td style="text-align: right;">0.0291</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0340</td>
<td style="text-align: right;">0.0358</td>
<td style="text-align: right;">-0.95</td>
<td style="text-align: right;">0.3419</td>
<td style="text-align: right;">0.0464</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">-0.0067</td>
<td style="text-align: right;">0.0401</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">0.8670</td>
<td style="text-align: right;">0.0715</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0208</td>
<td style="text-align: right;">0.0399</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.6017</td>
<td style="text-align: right;">0.0709</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0637</td>
<td style="text-align: right;">0.0358</td>
<td style="text-align: right;">-1.78</td>
<td style="text-align: right;">0.0748</td>
<td style="text-align: right;">0.0480</td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.2095</td>
<td style="text-align: right;">0.0351</td>
<td style="text-align: right;">5.96</td>
<td style="text-align: right;">&lt;1e-08</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.4341</td>
<td style="text-align: right;">0.0203</td>
<td style="text-align: right;">21.36</td>
<td style="text-align: right;">&lt;1e-99</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.2871</td>
<td style="text-align: right;">0.1108</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">0.0096</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0408</td>
<td style="text-align: right;">0.1107</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">0.7123</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.1086</td>
<td style="text-align: right;">0.1102</td>
<td style="text-align: right;">-0.99</td>
<td style="text-align: right;">0.3244</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4528</td>
<td style="text-align: right;">0.1098</td>
<td style="text-align: right;">4.12</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: male</td>
<td style="text-align: right;">-0.2996</td>
<td style="text-align: right;">0.0646</td>
<td style="text-align: right;">-4.64</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: male</td>
<td style="text-align: right;">0.1203</td>
<td style="text-align: right;">0.0644</td>
<td style="text-align: right;">1.87</td>
<td style="text-align: right;">0.0618</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: male</td>
<td style="text-align: right;">-0.0131</td>
<td style="text-align: right;">0.0641</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">0.8385</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: male</td>
<td style="text-align: right;">0.2528</td>
<td style="text-align: right;">0.0639</td>
<td style="text-align: right;">3.96</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">a1 &amp; Sex: male</td>
<td style="text-align: right;">0.1032</td>
<td style="text-align: right;">0.0695</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">0.1379</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.3178</td>
<td style="text-align: right;">0.2212</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">0.1507</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.2518</td>
<td style="text-align: right;">0.2200</td>
<td style="text-align: right;">-1.14</td>
<td style="text-align: right;">0.2525</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.0400</td>
<td style="text-align: right;">0.2191</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.8550</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.2671</td>
<td style="text-align: right;">0.2187</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">0.2219</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.9739</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m_cpxCohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Variance</th>
<th style="text-align: right;">Std.Dev</th>
<th style="text-align: right;">Corr.</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cohort</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0008484</td>
<td style="text-align: right;">0.0291275</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0021498</td>
<td style="text-align: right;">0.0463656</td>
<td style="text-align: right;">+0.93</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0051130</td>
<td style="text-align: right;">0.0715051</td>
<td style="text-align: right;">+0.70</td>
<td style="text-align: right;">+0.91</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0050332</td>
<td style="text-align: right;">0.0709452</td>
<td style="text-align: right;">-0.74</td>
<td style="text-align: right;">-0.93</td>
<td style="text-align: right;">-1.00</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0023066</td>
<td style="text-align: right;">0.0480275</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">+0.32</td>
<td style="text-align: right;">+0.68</td>
<td style="text-align: right;">-0.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.9484911</td>
<td style="text-align: right;">0.9739051</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m_cpxCohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>true</code></pre>
</div>
</div>
<p>The model is overparameterized with several CPs estimated between |.98| and |1.00|. How about the <strong>zero-correlation parameter</strong> (zcp) version of this LMM?</p>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>m_zcpCohort <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    zScore <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">*</span> a1 <span class="op">*</span> Sex <span class="op">+</span> <span class="fu">zerocorr</span>(<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Cohort)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 44%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">σ_Cohort</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0101</td>
<td style="text-align: right;">0.0132</td>
<td style="text-align: right;">-0.76</td>
<td style="text-align: right;">0.4455</td>
<td style="text-align: right;">0.0252</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0320</td>
<td style="text-align: right;">0.0345</td>
<td style="text-align: right;">-0.93</td>
<td style="text-align: right;">0.3532</td>
<td style="text-align: right;">0.0363</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">-0.0027</td>
<td style="text-align: right;">0.0341</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">0.9367</td>
<td style="text-align: right;">0.0333</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0154</td>
<td style="text-align: right;">0.0321</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.6317</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0613</td>
<td style="text-align: right;">0.0319</td>
<td style="text-align: right;">-1.92</td>
<td style="text-align: right;">0.0548</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.2142</td>
<td style="text-align: right;">0.0352</td>
<td style="text-align: right;">6.08</td>
<td style="text-align: right;">&lt;1e-08</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.4340</td>
<td style="text-align: right;">0.0203</td>
<td style="text-align: right;">21.33</td>
<td style="text-align: right;">&lt;1e-99</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.2925</td>
<td style="text-align: right;">0.1111</td>
<td style="text-align: right;">2.63</td>
<td style="text-align: right;">0.0085</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0248</td>
<td style="text-align: right;">0.1104</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">0.8224</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.1306</td>
<td style="text-align: right;">0.1096</td>
<td style="text-align: right;">-1.19</td>
<td style="text-align: right;">0.2335</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4642</td>
<td style="text-align: right;">0.1094</td>
<td style="text-align: right;">4.24</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: male</td>
<td style="text-align: right;">-0.3003</td>
<td style="text-align: right;">0.0646</td>
<td style="text-align: right;">-4.65</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: male</td>
<td style="text-align: right;">0.1193</td>
<td style="text-align: right;">0.0644</td>
<td style="text-align: right;">1.85</td>
<td style="text-align: right;">0.0641</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: male</td>
<td style="text-align: right;">-0.0119</td>
<td style="text-align: right;">0.0641</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">0.8528</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: male</td>
<td style="text-align: right;">0.2528</td>
<td style="text-align: right;">0.0639</td>
<td style="text-align: right;">3.96</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">a1 &amp; Sex: male</td>
<td style="text-align: right;">0.1020</td>
<td style="text-align: right;">0.0696</td>
<td style="text-align: right;">1.47</td>
<td style="text-align: right;">0.1428</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.3192</td>
<td style="text-align: right;">0.2213</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">0.1492</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.2509</td>
<td style="text-align: right;">0.2202</td>
<td style="text-align: right;">-1.14</td>
<td style="text-align: right;">0.2545</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.0415</td>
<td style="text-align: right;">0.2192</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">0.8498</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.2695</td>
<td style="text-align: right;">0.2188</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">0.2180</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.9746</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m_zcpCohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>true</code></pre>
</div>
</div>
<p>This <code>zcpLMM</code> is also singular. Three of the five VCs are estimated as zero. This raises the possibility that LMM <code>m_oviCohort</code> might fit as well as LMM <code>m_zcpCohort</code>.</p>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>m_oviCohort <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span> zScore <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">*</span> a1 <span class="op">*</span> Sex <span class="op">+</span> (<span class="fl">1</span> <span class="op">|</span> Cohort)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 44%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">σ_Cohort</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0101</td>
<td style="text-align: right;">0.0132</td>
<td style="text-align: right;">-0.76</td>
<td style="text-align: right;">0.4470</td>
<td style="text-align: right;">0.0253</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0309</td>
<td style="text-align: right;">0.0323</td>
<td style="text-align: right;">-0.96</td>
<td style="text-align: right;">0.3387</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">-0.0012</td>
<td style="text-align: right;">0.0322</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.9707</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0153</td>
<td style="text-align: right;">0.0321</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.6327</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0613</td>
<td style="text-align: right;">0.0320</td>
<td style="text-align: right;">-1.92</td>
<td style="text-align: right;">0.0552</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.2142</td>
<td style="text-align: right;">0.0352</td>
<td style="text-align: right;">6.08</td>
<td style="text-align: right;">&lt;1e-08</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.4341</td>
<td style="text-align: right;">0.0204</td>
<td style="text-align: right;">21.33</td>
<td style="text-align: right;">&lt;1e-99</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.2981</td>
<td style="text-align: right;">0.1107</td>
<td style="text-align: right;">2.69</td>
<td style="text-align: right;">0.0071</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0181</td>
<td style="text-align: right;">0.1101</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">0.8693</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.1308</td>
<td style="text-align: right;">0.1096</td>
<td style="text-align: right;">-1.19</td>
<td style="text-align: right;">0.2329</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4643</td>
<td style="text-align: right;">0.1094</td>
<td style="text-align: right;">4.24</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: male</td>
<td style="text-align: right;">-0.3008</td>
<td style="text-align: right;">0.0646</td>
<td style="text-align: right;">-4.66</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: male</td>
<td style="text-align: right;">0.1191</td>
<td style="text-align: right;">0.0644</td>
<td style="text-align: right;">1.85</td>
<td style="text-align: right;">0.0645</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: male</td>
<td style="text-align: right;">-0.0118</td>
<td style="text-align: right;">0.0642</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.8535</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: male</td>
<td style="text-align: right;">0.2528</td>
<td style="text-align: right;">0.0639</td>
<td style="text-align: right;">3.96</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">a1 &amp; Sex: male</td>
<td style="text-align: right;">0.1019</td>
<td style="text-align: right;">0.0696</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">0.1431</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.3186</td>
<td style="text-align: right;">0.2214</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">0.1500</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.2504</td>
<td style="text-align: right;">0.2202</td>
<td style="text-align: right;">-1.14</td>
<td style="text-align: right;">0.2555</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.0413</td>
<td style="text-align: right;">0.2193</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">0.8505</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.2693</td>
<td style="text-align: right;">0.2188</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">0.2185</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.9749</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m_oviCohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>false</code></pre>
</div>
</div>
<p>This solves the problem with singularity, but does LMM <code>m_zcpCohort</code> fit noise relative to the LMM <code>m_oviCohort</code>?</p>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>MixedModels.<span class="fu">likelihoodratiotest</span>(m_oviCohort, m_zcpCohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 77%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">model-dof</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">χ²</th>
<th style="text-align: right;">χ²-dof</th>
<th style="text-align: left;">P(&gt;χ²)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">zScore ~ 1 + Test + a1 + Sex + Test &amp; a1 + Test &amp; Sex + a1 &amp; Sex + Test &amp; a1 &amp; Sex + (1 | Cohort)</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">26802</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">zScore ~ 1 + Test + a1 + Sex + Test &amp; a1 + Test &amp; Sex + a1 &amp; Sex + Test &amp; a1 &amp; Sex + MixedModels.ZeroCorr((1 + Test | Cohort))</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">26801</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0.9239</td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>gof_summary2 <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  mods <span class="op">=</span> [m_oviCohort, m_zcpCohort, m_cpxCohort]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">DataFrame</span>(;</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    dof<span class="op">=</span><span class="fu">dof</span>.(mods),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    deviance<span class="op">=</span><span class="fu">deviance</span>.(mods),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    AIC<span class="op">=</span><span class="fu">aic</span>.(mods),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    AICc<span class="op">=</span><span class="fu">aicc</span>.(mods),</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    BIC<span class="op">=</span><span class="fu">bic</span>.(mods),</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">

<div class="data-frame"><p>3 rows × 5 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>dof</th><th>deviance</th><th>AIC</th><th>AICc</th><th>BIC</th></tr><tr><th></th><th title="Int64">Int64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>22</td><td>26801.6</td><td>26845.6</td><td>26845.7</td><td>27003.4</td></tr><tr><th>2</th><td>26</td><td>26800.7</td><td>26852.7</td><td>26852.8</td><td>27039.1</td></tr><tr><th>3</th><td>36</td><td>26792.3</td><td>26864.3</td><td>26864.6</td><td>27122.5</td></tr></tbody></table></div>
</div>
</div>
<p>Indeed, adding VCs is fitting noise. Again, the goodness of fit statistics unanimously favor the selection of the LMM <code>m_oviCohort</code>.</p>
<p>Not shown here, but the <code>Cohort</code>-related VCs for the <code>Test</code> contrasts could be estimated reliably for the <strong>full</strong> data. Thus, the small number of cohorts does not necessarily prevent the determination of reliable differences between tests across cohorts. What if we include VCs and CPs related to random factors <code>Child</code> and <code>School</code>?</p>
</section>
<section id="fitting-the-published-lmm-m1-to-the-reduced-data" class="level3">
<h3 class="anchored" data-anchor-id="fitting-the-published-lmm-m1-to-the-reduced-data">Fitting the published LMM <code>m1</code> to the reduced data</h3>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following LMMs <code>m1</code>, <code>m2</code>, etc. take a bit longer (e.g., close to 6 minutes in the Pluto notebook, close to 3 minutes in the REPL on a MacBook Pro).</p>
</div>
</div>
<p>LMM <code>m1</code> reported in <span class="citation" data-cites="Fuehner2021">Fühner et al. (<a href="#ref-Fuehner2021" role="doc-biblioref">2021</a>)</span> included random factors for <code>School</code>, <code>Child</code>, and <code>Cohort</code>. The RES for <code>School</code> was specified like in LMM <code>m_cpx</code>. The RES for <code>Child</code> included VCs and CPs for <code>Test</code>, but not for linear developmental gain in the ninth year of life <code>a1</code> or <code>Sex</code>; they are between-<code>Child</code> effects.</p>
<p>The RES for <code>Cohort</code> included only VCs, no CPs for <code>Test</code>. The <em>parsimony</em> was due to the small number of nine levels for this grouping factor.</p>
<p>Here we fit this LMM <code>m1</code> for the reduced data. For a different subset of similar size on MacBook Pro [13 | 15 | 16] this took [303 | 250 | 244 ] s; for LMM <code>m1a</code> (i.e., dropping 1 school-relate VC for <code>Sex</code>), times are [212 | 165 | 160] s. The corresponding <code>lme4</code> times for LMM <code>m1</code> are [397 | 348 | 195].</p>
<p>Finally, times for fitting the full set of data –not in this script–, for LMM <code>m1</code>are [60 | 62 | 85] minutes (!); for LMM <code>m1a</code> the times were [46 | 48 | 34] minutes. It was not possible to fit the full set of data with <code>lme4</code>; after about 13 to 18 minutes the program stopped with: <code>Error in eval_f(x, ...) : Downdated VtV is not positive definite.</code></p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    zScore <span class="op">~</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>      <span class="fl">1</span> <span class="op">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Test</span> <span class="op">*</span> a1 <span class="op">*</span> Sex <span class="op">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>      (<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">+</span> a1 <span class="op">+</span> Sex <span class="op">|</span> School) <span class="op">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>      (<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Child) <span class="op">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">zerocorr</span>(<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Cohort)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 1706      Time: 0:00:16 ( 9.86 ms/it)
  objective:  24859.928545253322</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="32">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 35%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">σ_Child</th>
<th style="text-align: right;">σ_School</th>
<th style="text-align: right;">σ_Cohort</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0199</td>
<td style="text-align: right;">0.0182</td>
<td style="text-align: right;">-1.09</td>
<td style="text-align: right;">0.2738</td>
<td style="text-align: right;">0.5955</td>
<td style="text-align: right;">0.1890</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0252</td>
<td style="text-align: right;">0.0364</td>
<td style="text-align: right;">-0.69</td>
<td style="text-align: right;">0.4878</td>
<td style="text-align: right;">0.7440</td>
<td style="text-align: right;">0.3460</td>
<td style="text-align: right;">0.0543</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">-0.0075</td>
<td style="text-align: right;">0.0339</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">0.8251</td>
<td style="text-align: right;">0.6421</td>
<td style="text-align: right;">0.3562</td>
<td style="text-align: right;">0.0446</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0095</td>
<td style="text-align: right;">0.0281</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.7361</td>
<td style="text-align: right;">0.5581</td>
<td style="text-align: right;">0.3175</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0477</td>
<td style="text-align: right;">0.0285</td>
<td style="text-align: right;">-1.68</td>
<td style="text-align: right;">0.0939</td>
<td style="text-align: right;">0.7417</td>
<td style="text-align: right;">0.2282</td>
<td style="text-align: right;">0.0176</td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.2161</td>
<td style="text-align: right;">0.0533</td>
<td style="text-align: right;">4.06</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.1577</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.4289</td>
<td style="text-align: right;">0.0316</td>
<td style="text-align: right;">13.56</td>
<td style="text-align: right;">&lt;1e-41</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.1461</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.2840</td>
<td style="text-align: right;">0.0899</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">0.0016</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0099</td>
<td style="text-align: right;">0.0840</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">0.9061</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.1324</td>
<td style="text-align: right;">0.0785</td>
<td style="text-align: right;">-1.69</td>
<td style="text-align: right;">0.0916</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4621</td>
<td style="text-align: right;">0.0866</td>
<td style="text-align: right;">5.34</td>
<td style="text-align: right;">&lt;1e-07</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: male</td>
<td style="text-align: right;">-0.3042</td>
<td style="text-align: right;">0.0520</td>
<td style="text-align: right;">-5.85</td>
<td style="text-align: right;">&lt;1e-08</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: male</td>
<td style="text-align: right;">0.1156</td>
<td style="text-align: right;">0.0489</td>
<td style="text-align: right;">2.37</td>
<td style="text-align: right;">0.0180</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: male</td>
<td style="text-align: right;">-0.0003</td>
<td style="text-align: right;">0.0459</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.9941</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: male</td>
<td style="text-align: right;">0.2561</td>
<td style="text-align: right;">0.0505</td>
<td style="text-align: right;">5.07</td>
<td style="text-align: right;">&lt;1e-06</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">a1 &amp; Sex: male</td>
<td style="text-align: right;">0.1026</td>
<td style="text-align: right;">0.1052</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.3295</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.3306</td>
<td style="text-align: right;">0.1779</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">0.0631</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.2498</td>
<td style="text-align: right;">0.1666</td>
<td style="text-align: right;">-1.50</td>
<td style="text-align: right;">0.1338</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.0565</td>
<td style="text-align: right;">0.1567</td>
<td style="text-align: right;">-0.36</td>
<td style="text-align: right;">0.7185</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.2823</td>
<td style="text-align: right;">0.1727</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">0.1022</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.5454</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Variance</th>
<th style="text-align: right;">Std.Dev</th>
<th style="text-align: right;">Corr.</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Child</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.3545682</td>
<td style="text-align: right;">0.5954563</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.5535949</td>
<td style="text-align: right;">0.7440396</td>
<td style="text-align: right;">+0.04</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.4122709</td>
<td style="text-align: right;">0.6420832</td>
<td style="text-align: right;">+0.15</td>
<td style="text-align: right;">-0.53</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.3114685</td>
<td style="text-align: right;">0.5580937</td>
<td style="text-align: right;">-0.00</td>
<td style="text-align: right;">+0.03</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.5501338</td>
<td style="text-align: right;">0.7417100</td>
<td style="text-align: right;">-0.30</td>
<td style="text-align: right;">+0.15</td>
<td style="text-align: right;">-0.24</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">School</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0357246</td>
<td style="text-align: right;">0.1890096</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.1197096</td>
<td style="text-align: right;">0.3459907</td>
<td style="text-align: right;">+0.08</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.1268505</td>
<td style="text-align: right;">0.3561608</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.1008311</td>
<td style="text-align: right;">0.3175392</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">-0.51</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0520816</td>
<td style="text-align: right;">0.2282138</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">+0.01</td>
<td style="text-align: right;">+0.04</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.0248607</td>
<td style="text-align: right;">0.1576727</td>
<td style="text-align: right;">+0.13</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">+0.33</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.0213402</td>
<td style="text-align: right;">0.1460829</td>
<td style="text-align: right;">+0.29</td>
<td style="text-align: right;">-0.00</td>
<td style="text-align: right;">+0.00</td>
<td style="text-align: right;">-0.26</td>
<td style="text-align: right;">+0.91</td>
<td style="text-align: right;">+0.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohort</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0029478</td>
<td style="text-align: right;">0.0542937</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0019871</td>
<td style="text-align: right;">0.0445772</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0003083</td>
<td style="text-align: right;">0.0175598</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.2975145</td>
<td style="text-align: right;">0.5454489</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>true</code></pre>
</div>
</div>
<p>Depending on the random number for stratified samplign, LMM <code>m1</code> may or may not be supported by the data.</p>
<p>We also fit an alternative parameterization, estimating VCs and CPs for <code>Test</code> scores rather than <code>Test</code> effects by replacing the <code>1 + ...</code> in the RE terms with <code>0 + ...</code>.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    zScore <span class="op">~</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>      <span class="fl">1</span> <span class="op">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Test</span> <span class="op">*</span> a1 <span class="op">*</span> Sex <span class="op">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>      (<span class="fl">0</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">+</span> a1 <span class="op">+</span> Sex <span class="op">|</span> School) <span class="op">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>      (<span class="fl">0</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Child) <span class="op">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">zerocorr</span>(<span class="fl">0</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Cohort)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 1204      Time: 0:00:11 ( 9.72 ms/it)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="35">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 35%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">σ_Child</th>
<th style="text-align: right;">σ_School</th>
<th style="text-align: right;">σ_Cohort</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0215</td>
<td style="text-align: right;">0.0192</td>
<td style="text-align: right;">-1.12</td>
<td style="text-align: right;">0.2640</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0240</td>
<td style="text-align: right;">0.0335</td>
<td style="text-align: right;">-0.72</td>
<td style="text-align: right;">0.4726</td>
<td style="text-align: right;">0.7397</td>
<td style="text-align: right;">0.3251</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">-0.0125</td>
<td style="text-align: right;">0.0410</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">0.7597</td>
<td style="text-align: right;">0.7926</td>
<td style="text-align: right;">0.3031</td>
<td style="text-align: right;">0.0823</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0176</td>
<td style="text-align: right;">0.0393</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.6537</td>
<td style="text-align: right;">0.7930</td>
<td style="text-align: right;">0.2362</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0480</td>
<td style="text-align: right;">0.0297</td>
<td style="text-align: right;">-1.62</td>
<td style="text-align: right;">0.1061</td>
<td style="text-align: right;">0.7252</td>
<td style="text-align: right;">0.2357</td>
<td style="text-align: right;">0.0304</td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.2117</td>
<td style="text-align: right;">0.0544</td>
<td style="text-align: right;">3.89</td>
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.2437</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.4297</td>
<td style="text-align: right;">0.0317</td>
<td style="text-align: right;">13.58</td>
<td style="text-align: right;">&lt;1e-41</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.1490</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.2876</td>
<td style="text-align: right;">0.0894</td>
<td style="text-align: right;">3.22</td>
<td style="text-align: right;">0.0013</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0208</td>
<td style="text-align: right;">0.0844</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: right;">0.8055</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.1078</td>
<td style="text-align: right;">0.0795</td>
<td style="text-align: right;">-1.36</td>
<td style="text-align: right;">0.1752</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4598</td>
<td style="text-align: right;">0.0867</td>
<td style="text-align: right;">5.30</td>
<td style="text-align: right;">&lt;1e-06</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: male</td>
<td style="text-align: right;">-0.3048</td>
<td style="text-align: right;">0.0520</td>
<td style="text-align: right;">-5.87</td>
<td style="text-align: right;">&lt;1e-08</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: male</td>
<td style="text-align: right;">0.1164</td>
<td style="text-align: right;">0.0488</td>
<td style="text-align: right;">2.38</td>
<td style="text-align: right;">0.0172</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: male</td>
<td style="text-align: right;">-0.0015</td>
<td style="text-align: right;">0.0459</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.9743</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: male</td>
<td style="text-align: right;">0.2561</td>
<td style="text-align: right;">0.0505</td>
<td style="text-align: right;">5.07</td>
<td style="text-align: right;">&lt;1e-06</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">a1 &amp; Sex: male</td>
<td style="text-align: right;">0.1003</td>
<td style="text-align: right;">0.1056</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.3419</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.3313</td>
<td style="text-align: right;">0.1779</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">0.0626</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.2482</td>
<td style="text-align: right;">0.1665</td>
<td style="text-align: right;">-1.49</td>
<td style="text-align: right;">0.1360</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.0576</td>
<td style="text-align: right;">0.1564</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">0.7128</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.2802</td>
<td style="text-align: right;">0.1727</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">0.1046</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.7619</td>
<td style="text-align: right;">0.2789</td>
<td style="text-align: right;">0.0341</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.5309</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>true</code></pre>
</div>
</div>
<p>Depending on the random number generator seed, the model may or may not be supported in the alternative parameterization of scores. The fixed-effects profile is not affected (see 2.8 below).</p>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Danger
</div>
</div>
<div class="callout-body-container callout-body">
<p>RK: The order of RE terms is critical. In formula <code>f2</code> the <code>zerocorr()</code> term must be placed last as shown. If it is placed first, School-related and Child-related CPs are estimated/reported (?) as zero. This was not the case for formula <code>m1</code>. Thus, it appears to be related to the <code>0</code>-intercepts in School and Child terms. Need a reprex.</p>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Variance</th>
<th style="text-align: right;">Std.Dev</th>
<th style="text-align: right;">Corr.</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Child</td>
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;">0.5805028</td>
<td style="text-align: right;">0.7619074</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.5470959</td>
<td style="text-align: right;">0.7396593</td>
<td style="text-align: right;">+0.48</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.6282565</td>
<td style="text-align: right;">0.7926263</td>
<td style="text-align: right;">+0.60</td>
<td style="text-align: right;">+0.63</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.6289009</td>
<td style="text-align: right;">0.7930327</td>
<td style="text-align: right;">+0.53</td>
<td style="text-align: right;">+0.59</td>
<td style="text-align: right;">+0.73</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.5259559</td>
<td style="text-align: right;">0.7252282</td>
<td style="text-align: right;">+0.21</td>
<td style="text-align: right;">+0.42</td>
<td style="text-align: right;">+0.39</td>
<td style="text-align: right;">+0.50</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">School</td>
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;">0.0777884</td>
<td style="text-align: right;">0.2789058</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.1056798</td>
<td style="text-align: right;">0.3250843</td>
<td style="text-align: right;">+0.36</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0918594</td>
<td style="text-align: right;">0.3030832</td>
<td style="text-align: right;">+0.23</td>
<td style="text-align: right;">+0.37</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0557714</td>
<td style="text-align: right;">0.2361598</td>
<td style="text-align: right;">+0.51</td>
<td style="text-align: right;">+0.31</td>
<td style="text-align: right;">+0.34</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0555648</td>
<td style="text-align: right;">0.2357218</td>
<td style="text-align: right;">+0.35</td>
<td style="text-align: right;">+0.19</td>
<td style="text-align: right;">+0.25</td>
<td style="text-align: right;">+0.53</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.0593786</td>
<td style="text-align: right;">0.2436772</td>
<td style="text-align: right;">+0.37</td>
<td style="text-align: right;">+0.10</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">+0.02</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.0221873</td>
<td style="text-align: right;">0.1489539</td>
<td style="text-align: right;">+0.17</td>
<td style="text-align: right;">+0.14</td>
<td style="text-align: right;">+0.15</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">+0.73</td>
<td style="text-align: right;">+0.19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohort</td>
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;">0.0011647</td>
<td style="text-align: right;">0.0341275</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0067749</td>
<td style="text-align: right;">0.0823098</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0009263</td>
<td style="text-align: right;">0.0304359</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.2818544</td>
<td style="text-align: right;">0.5308996</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</section>
<section id="principle-component-analysis-of-random-effect-structure-repca" class="level3">
<h3 class="anchored" data-anchor-id="principle-component-analysis-of-random-effect-structure-repca">Principle Component Analysis of Random Effect Structure (rePCA)</h3>
<p>The <code>ìssingular()</code> command is sort of a shortcut for a quick inspection of the principle components (PCs) of the variance-covariance matrix of the RES. With the <code>MixedModels.PCA()</code> command, we also obtain information about the amount of cumulative variance accounted for as we add PCs.</p>
<p>The output also provides PC loadings which may facilitate interpretation of the CP matrices (if estimated). This topic will be picked uo in a separate vignette. See also <span class="citation" data-cites="Fuehner2021">Fühner et al. (<a href="#ref-Fuehner2021" role="doc-biblioref">2021</a>)</span> for an application.</p>
</section>
<section id="effects-in-res" class="level3">
<h3 class="anchored" data-anchor-id="effects-in-res">Effects in RES</h3>
<p>For every random factor, <code>MixedModels.PCA()</code> extracts as many PCs as there are VCs. Therefore, the cumulation of variance across PCs within a random factor will always add up to 100% – at the latest with the last VC, but, in the case of overparameterized LMMs, the ceiling will be reached earlier. The final PCs are usually quite small.</p>
<p>PCs are extracted in the order of the amount of unique variance they account for. The first PC accounts for the largest and the final PC for the least amount of variance. The number the PCs with percent variance above a certain threshold indicates the number of weighted composites needed and reflects the dimensionality of the orthogonal space within which (almost) all the variance can be accounted for. The weights for forming composite scores are the listed loadings. For ease of interpretation it is often useful to change the sign of some composite scores.</p>
<p>The PCA for LMM <code>m1</code> shows that each of the five PCs for <code>Child</code> accounts for a non-zero percent of unique variance.</p>
<p>For <code>School</code> fewer than seven PCs have unique variance. The exact number depends on sampling. The overparameterization of <code>School</code> might be resolved when the CPs for <code>Sex</code> are dropped from the LMM.</p>
<p><code>Cohort</code> was estimated with CPs forced to zero. Therefore, the VCs were forced to be orthogonal; they already represent the PCA solution. However, depending on sampling, not all PCs may be identified for this random factor either.</p>
<p>Importantly, again depending on sampling, a non-singular fit does not imply that unique variance is associated with all PCs (i.e., not for last PC for <code>School</code>). Embrace uncertainty!</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>MixedModels.<span class="fu">PCA</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>(Child = 
Principal components based on correlation matrix
 (Intercept)    1.0     .      .      .      .
 Test: Star_r   0.04   1.0     .      .      .
 Test: S20_r    0.15  -0.53   1.0     .      .
 Test: SLJ     -0.0    0.03  -0.37   1.0     .
 Test: BMT     -0.3    0.15  -0.24  -0.22   1.0

Normalized cumulative variances:
[0.3501, 0.6193, 0.8223, 0.9377, 1.0]

Component loadings
                 PC1    PC2    PC3    PC4    PC5
 (Intercept)   -0.25  -0.47   0.65  -0.54  -0.08
 Test: Star_r   0.55  -0.11   0.53   0.42   0.48
 Test: S20_r   -0.67   0.18   0.03   0.08   0.71
 Test: SLJ      0.25  -0.6   -0.54  -0.31   0.44
 Test: BMT      0.35   0.62   0.06  -0.65   0.25, School = 
Principal components based on correlation matrix
 (Intercept)    1.0     .      .      .      .      .      .
 Test: Star_r   0.08   1.0     .      .      .      .      .
 Test: S20_r   -0.07  -0.47   1.0     .      .      .      .
 Test: SLJ     -0.07  -0.23  -0.51   1.0     .      .      .
 Test: BMT     -0.12   0.01   0.04  -0.27   1.0     .      .
 a1             0.13  -0.35  -0.35  -0.01   0.33   1.0     .
 Sex: male      0.29  -0.0    0.0   -0.26   0.91   0.41   1.0

Normalized cumulative variances:
[0.3247, 0.5585, 0.7561, 0.9077, 0.9997, 1.0, 1.0]

Component loadings
                 PC1    PC2    PC3    PC4    PC5    PC6    PC7
 (Intercept)   -0.14   0.15  -0.16  -0.9    0.21  -0.15  -0.24
 Test: Star_r   0.05   0.21  -0.8    0.13  -0.09  -0.41   0.33
 Test: S20_r   -0.03  -0.75   0.16  -0.13   0.14  -0.49   0.36
 Test: SLJ      0.27   0.49   0.37   0.11   0.6   -0.34   0.23
 Test: BMT     -0.6   -0.02  -0.05   0.37   0.25  -0.37  -0.55
 a1            -0.38   0.34   0.39  -0.11  -0.62  -0.35   0.24
 Sex: male     -0.64   0.05  -0.07  -0.02   0.33   0.44   0.53, Cohort = 
Principal components based on correlation matrix
 (Intercept)   0.0  .    .    .    .
 Test: Star_r  0.0  1.0  .    .    .
 Test: S20_r   0.0  0.0  1.0  .    .
 Test: SLJ     0.0  0.0  0.0  0.0  .
 Test: BMT     0.0  0.0  0.0  0.0  1.0

Normalized cumulative variances:
[0.3333, 0.6667, 1.0, 1.0, 1.0]

Component loadings
                PC1   PC2   PC3     PC4     PC5
 (Intercept)   0.0   0.0   0.0   NaN       0.0
 Test: Star_r  1.0   0.0   0.0     0.0     0.0
 Test: S20_r   0.0   1.0   0.0     0.0     0.0
 Test: SLJ     0.0   0.0   0.0     0.0   NaN
 Test: BMT     0.0   0.0   1.0     0.0     0.0)</code></pre>
</div>
</div>
<section id="scores-in-res" class="level4">
<h4 class="anchored" data-anchor-id="scores-in-res">Scores in RES</h4>
<p>Now lets looks at the PCA results for the alternative parameterization of LMM <code>m2</code>. It is important to note that the reparameterization to base estimates of VCs and CPs on scores rather than effects applies only to the <code>Test</code> factor (i.e., the first factor in the formula); VCs for <code>Sex</code> and <code>age</code> refer to the associated effects.</p>
<p>Depending on sampling, the difference between LMM <code>m1</code> and LMM <code>m2</code> may show that overparameterization according to PCs may depend on the specification chosen for the other the random-effect structure.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the <em>complete</em> data, all PCs had unique variance associated with them.</p>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>MixedModels.<span class="fu">PCA</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>(Child = 
Principal components based on correlation matrix
 Test: Run     1.0    .     .     .    .
 Test: Star_r  0.48  1.0    .     .    .
 Test: S20_r   0.6   0.63  1.0    .    .
 Test: SLJ     0.53  0.59  0.73  1.0   .
 Test: BMT     0.21  0.42  0.39  0.5  1.0

Normalized cumulative variances:
[0.6141, 0.7764, 0.8692, 0.95, 1.0]

Component loadings
                 PC1    PC2    PC3    PC4    PC5
 Test: Run     -0.41   0.55   0.47   0.54  -0.07
 Test: Star_r  -0.46  -0.01  -0.81   0.34  -0.13
 Test: S20_r   -0.5    0.17  -0.02  -0.44   0.73
 Test: SLJ     -0.5   -0.06   0.16  -0.55  -0.65
 Test: BMT     -0.35  -0.81   0.31   0.31   0.15, School = 
Principal components based on correlation matrix
 Test: Run      1.0     .      .      .      .      .      .
 Test: Star_r   0.36   1.0     .      .      .      .      .
 Test: S20_r    0.23   0.37   1.0     .      .      .      .
 Test: SLJ      0.51   0.31   0.34   1.0     .      .      .
 Test: BMT      0.35   0.19   0.25   0.53   1.0     .      .
 a1             0.37   0.1   -0.15  -0.14   0.02   1.0     .
 Sex: male      0.17   0.14   0.15  -0.16   0.73   0.19   1.0

Normalized cumulative variances:
[0.3649, 0.5702, 0.7432, 0.8708, 0.9515, 1.0, 1.0]

Component loadings
                 PC1    PC2    PC3    PC4    PC5    PC6    PC7
 Test: Run     -0.45   0.01  -0.47   0.2    0.18  -0.71  -0.11
 Test: Star_r  -0.37  -0.18  -0.21  -0.59  -0.66   0.05  -0.06
 Test: S20_r   -0.35  -0.32   0.21  -0.51   0.68   0.12  -0.06
 Test: SLJ     -0.43  -0.45  -0.06   0.47  -0.07   0.34   0.52
 Test: BMT     -0.5    0.24   0.37   0.32  -0.11   0.24  -0.62
 a1            -0.1    0.5   -0.64  -0.07   0.23   0.53   0.02
 Sex: male     -0.32   0.6    0.39  -0.16  -0.04  -0.19   0.57, Cohort = 
Principal components based on correlation matrix
 Test: Run     1.0  .    .    .    .
 Test: Star_r  0.0  0.0  .    .    .
 Test: S20_r   0.0  0.0  1.0  .    .
 Test: SLJ     0.0  0.0  0.0  0.0  .
 Test: BMT     0.0  0.0  0.0  0.0  1.0

Normalized cumulative variances:
[0.3333, 0.6667, 1.0, 1.0, 1.0]

Component loadings
                PC1   PC2   PC3     PC4     PC5
 Test: Run     1.0   0.0   0.0     0.0     0.0
 Test: Star_r  0.0   0.0   0.0   NaN       0.0
 Test: S20_r   0.0   1.0   0.0     0.0     0.0
 Test: SLJ     0.0   0.0   0.0     0.0   NaN
 Test: BMT     0.0   0.0   1.0     0.0     0.0)</code></pre>
</div>
</div>
</section>
</section>
<section id="summary-of-results-for-stratified-subset-of-data" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-results-for-stratified-subset-of-data">Summary of results for stratified subset of data</h3>
<p>Returning to the theoretical focus of the article, the significant main effects of <code>age</code> and <code>Sex</code>, the interactions between <code>age</code> and c1 and c4 contrasts and the interactions between <code>Sex</code> and three test contrasts (c1, c2, c4) are replicated. Obviously, the subset of data is much noisier than the full set.</p>
</section>
</section>
<section id="age-x-sex-nested-in-levels-of-test" class="level2">
<h2 class="anchored" data-anchor-id="age-x-sex-nested-in-levels-of-test"><code>Age x Sex</code> nested in levels of <code>Test</code></h2>
<p>In this final LMM, we test <em>post-hoc</em> five <code>age x Sex</code> interactions by nesting the interaction in the levels of <code>Test</code>. As this LMM <code>m2_nested</code> is a reparameterization of LMM <code>m2</code>.</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>m2_nested <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    zScore <span class="op">~</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>      <span class="fl">1</span> <span class="op">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Test</span> <span class="op">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Test</span> <span class="op">&amp;</span> (a1 <span class="op">*</span> Sex) <span class="op">+</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>      (<span class="fl">0</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">+</span> a1 <span class="op">+</span> Sex <span class="op">|</span> School) <span class="op">+</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>      (<span class="fl">0</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Child) <span class="op">+</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">zerocorr</span>(<span class="fl">0</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Cohort)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 1261      Time: 0:00:12 (10.31 ms/it)
  objective:  24853.932242878553</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="40">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 35%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">σ_Child</th>
<th style="text-align: right;">σ_School</th>
<th style="text-align: right;">σ_Cohort</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0215</td>
<td style="text-align: right;">0.0192</td>
<td style="text-align: right;">-1.12</td>
<td style="text-align: right;">0.2640</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0240</td>
<td style="text-align: right;">0.0335</td>
<td style="text-align: right;">-0.72</td>
<td style="text-align: right;">0.4726</td>
<td style="text-align: right;">0.7409</td>
<td style="text-align: right;">0.3250</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">-0.0125</td>
<td style="text-align: right;">0.0410</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">0.7596</td>
<td style="text-align: right;">0.7938</td>
<td style="text-align: right;">0.3032</td>
<td style="text-align: right;">0.0823</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0176</td>
<td style="text-align: right;">0.0393</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.6536</td>
<td style="text-align: right;">0.7942</td>
<td style="text-align: right;">0.2361</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0480</td>
<td style="text-align: right;">0.0297</td>
<td style="text-align: right;">-1.62</td>
<td style="text-align: right;">0.1061</td>
<td style="text-align: right;">0.7265</td>
<td style="text-align: right;">0.2357</td>
<td style="text-align: right;">0.0305</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Run &amp; a1</td>
<td style="text-align: right;">-0.0548</td>
<td style="text-align: right;">0.0786</td>
<td style="text-align: right;">-0.70</td>
<td style="text-align: right;">0.4859</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.2328</td>
<td style="text-align: right;">0.0768</td>
<td style="text-align: right;">3.03</td>
<td style="text-align: right;">0.0024</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">0.2120</td>
<td style="text-align: right;">0.0807</td>
<td style="text-align: right;">2.63</td>
<td style="text-align: right;">0.0086</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">0.1043</td>
<td style="text-align: right;">0.0786</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">0.1848</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.5641</td>
<td style="text-align: right;">0.0749</td>
<td style="text-align: right;">7.53</td>
<td style="text-align: right;">&lt;1e-13</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Run &amp; Sex: male</td>
<td style="text-align: right;">0.5531</td>
<td style="text-align: right;">0.0454</td>
<td style="text-align: right;">12.18</td>
<td style="text-align: right;">&lt;1e-33</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: male</td>
<td style="text-align: right;">0.2483</td>
<td style="text-align: right;">0.0448</td>
<td style="text-align: right;">5.54</td>
<td style="text-align: right;">&lt;1e-07</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: male</td>
<td style="text-align: right;">0.3647</td>
<td style="text-align: right;">0.0466</td>
<td style="text-align: right;">7.82</td>
<td style="text-align: right;">&lt;1e-14</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: male</td>
<td style="text-align: right;">0.3632</td>
<td style="text-align: right;">0.0459</td>
<td style="text-align: right;">7.91</td>
<td style="text-align: right;">&lt;1e-14</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: male</td>
<td style="text-align: right;">0.6193</td>
<td style="text-align: right;">0.0434</td>
<td style="text-align: right;">14.26</td>
<td style="text-align: right;">&lt;1e-45</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Run &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.0488</td>
<td style="text-align: right;">0.1541</td>
<td style="text-align: right;">-0.32</td>
<td style="text-align: right;">0.7515</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.2825</td>
<td style="text-align: right;">0.1514</td>
<td style="text-align: right;">1.87</td>
<td style="text-align: right;">0.0621</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.0343</td>
<td style="text-align: right;">0.1568</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.8270</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.0233</td>
<td style="text-align: right;">0.1551</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.8805</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.2569</td>
<td style="text-align: right;">0.1468</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">0.0801</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.2440</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.1490</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.7632</td>
<td style="text-align: right;">0.2789</td>
<td style="text-align: right;">0.0341</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.5291</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The results show that none of the interactions in the panels of <a href="#fig-agetrendssamp">Figure&nbsp;2</a> is significant. The size and direction of interaction effects correspond with what is shown in <a href="#fig-agetrendssamp">Figure&nbsp;2</a>.</p>
<section id="construction-site-more-model-comparisons" class="level4">
<h4 class="anchored" data-anchor-id="construction-site-more-model-comparisons">CONSTRUCTION SITE: More model comparisons</h4>
<div class="cell" data-execution_count="40">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>gof_summary3 <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  nms <span class="op">=</span> [<span class="op">:</span>m1, <span class="op">:</span>m2, <span class="op">:</span>m2_nested]</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  mods <span class="op">=</span> <span class="fu">eval</span>.(nms)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">DataFrame</span>(;</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span>nms,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    dof<span class="op">=</span><span class="fu">dof</span>.(mods),</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    deviance<span class="op">=</span><span class="fu">deviance</span>.(mods),</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    AIC<span class="op">=</span><span class="fu">aic</span>.(mods),</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    AICc<span class="op">=</span><span class="fu">aicc</span>.(mods),</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    BIC<span class="op">=</span><span class="fu">bic</span>.(mods),</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="41">

<div class="data-frame"><p>3 rows × 6 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>name</th><th>dof</th><th>deviance</th><th>AIC</th><th>AICc</th><th>BIC</th></tr><tr><th></th><th title="Symbol">Symbol</th><th title="Int64">Int64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>m1</td><td>69</td><td>24859.9</td><td>24997.9</td><td>24998.9</td><td>25492.7</td></tr><tr><th>2</th><td>m2</td><td>69</td><td>24853.9</td><td>24991.9</td><td>24992.9</td><td>25486.7</td></tr><tr><th>3</th><td>m2_nested</td><td>69</td><td>24853.9</td><td>24991.9</td><td>24992.9</td><td>25486.7</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>n, p, q, k <span class="op">=</span> <span class="fu">size</span>(m1)  <span class="co"># nobs, fe params, VCs+CPs, re terms</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>(9615, 20, 13095, 3)</code></pre>
</div>
</div>
<p>In prinicple, the models should yield the save deviance. When models are not supported by the data, that is for singular models, there may be small differences between deviances for these reparameterizations. During optimization such models search for the absolute minimum in a very shallow surface and may end up in a local minimum instead.</p>
</section>
<section id="geometric-degrees-of-freedom" class="level4">
<h4 class="anchored" data-anchor-id="geometric-degrees-of-freedom">Geometric degrees of freedom</h4>
<p>From MixedModels documentation: “The sum of the leverage values is the rank of the model matrix and <code>n - sum(leverage(m))</code> is the degrees of freedom for residuals. The sum of the leverage values is also the trace of the so-called”hat” matrix<code>H</code>.”</p>
<p>New term: <em>geometric degrees of freedom</em>.</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>m1_geomdf <span class="op">=</span> <span class="fu">sum</span>(<span class="fu">leverage</span>(m1))  <span class="co"># geom_dof</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>5401.172562881657</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">leverage</span>(m2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>5617.992522037874</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">leverage</span>(m2_nested))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>5645.266087841611</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">-</span> m1_geomdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>4213.827437118343</code></pre>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>m1.feterm.rank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>20</code></pre>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dof</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>69</code></pre>
</div>
</div>
</section>
</section>
<section id="glossary-of-mixedmodels.jl-commands" class="level2">
<h2 class="anchored" data-anchor-id="glossary-of-mixedmodels.jl-commands">Glossary of <em>MixedModels.jl</em> commands</h2>
<p>Here we introduce most of the commands available in the <em>MixedModels.jl</em> package that allow the immediated inspection and analysis of results returned in a fitted <em>linear</em> mixed-effect model.</p>
<p>Postprocessing related to conditional modes will be dealt with in a different tutorial.</p>
<section id="overall-summary-statistics" class="level3">
<h3 class="anchored" data-anchor-id="overall-summary-statistics">Overall summary statistics</h3>
<pre><code>+ julia&gt; m1.optsum         # MixedModels.OptSummary:  gets all info 
+ julia&gt; loglikelihood(m1) # StatsBase.loglikelihood: return loglikelihood
                             of the model
+ julia&gt; deviance(m1)      # StatsBase.deviance: negative twice the log-likelihood
                             relative to saturated model
+ julia&gt; objective(m1)     # MixedModels.objective: saturated model not clear:
                             negative twice the log-likelihood
+ julia&gt; nobs(m1)          # n of observations; they are not independent
+ julia&gt; dof(m1)           # n of degrees of freedom is number of model parameters
+ julia&gt; aic(m1)           # objective(m1) + 2*dof(m1)
+ julia&gt; bic(m1)           # objective(m1) + dof(m1)*log(nobs(m1))</code></pre>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>m1.optsum            <span class="co"># MixedModels.OptSummary:  gets all info</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 5%">
<col style="width: 94%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Initialization</strong></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Initial parameter vector</td>
<td style="text-align: left;">[1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Initial objective value</td>
<td style="text-align: left;">26037.141446130794</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Optimizer settings</strong></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Optimizer (from NLopt)</td>
<td style="text-align: left;"><code>LN_BOBYQA</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Lower bounds</td>
<td style="text-align: left;">[0.0, -Inf, -Inf, -Inf, -Inf, 0.0, -Inf, -Inf, -Inf, 0.0, -Inf, -Inf, 0.0, -Inf, 0.0, 0.0, -Inf, -Inf, -Inf, -Inf, -Inf, -Inf, 0.0, -Inf, -Inf, -Inf, -Inf, -Inf, 0.0, -Inf, -Inf, -Inf, -Inf, 0.0, -Inf, -Inf, -Inf, 0.0, -Inf, -Inf, 0.0, -Inf, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ftol_rel</code></td>
<td style="text-align: left;">1.0e-12</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ftol_abs</code></td>
<td style="text-align: left;">1.0e-8</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>xtol_rel</code></td>
<td style="text-align: left;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>xtol_abs</code></td>
<td style="text-align: left;">[1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10]</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>initial_step</code></td>
<td style="text-align: left;">[0.75, 1.0, 1.0, 1.0, 1.0, 0.75, 1.0, 1.0, 1.0, 0.75, 1.0, 1.0, 0.75, 1.0, 0.75, 0.75, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.75, 1.0, 1.0, 1.0, 1.0, 1.0, 0.75, 1.0, 1.0, 1.0, 1.0, 0.75, 1.0, 1.0, 1.0, 0.75, 1.0, 1.0, 0.75, 1.0, 0.75, 0.75, 0.75, 0.75, 0.75, 0.75]</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>maxfeval</code></td>
<td style="text-align: left;">-1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>maxtime</code></td>
<td style="text-align: left;">-1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Result</strong></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Function evaluations</td>
<td style="text-align: left;">1704</td>
</tr>
<tr class="even">
<td style="text-align: left;">Final parameter vector</td>
<td style="text-align: left;">[1.0917, 0.0612, 0.1801, -0.0021, -0.4076, 1.3627, -0.6347, 0.0332, 0.2279, 0.9749, -0.4348, -0.1724, 0.9256, -0.4273, 1.1911, 0.3465, 0.0476, -0.044, -0.0421, -0.0511, 0.0385, 0.0784, 0.6325, -0.3051, -0.1291, 0.0093, -0.1029, -0.0062, 0.5756, -0.4054, 0.0178, -0.1667, 0.0038, 0.3951, -0.1482, -0.2037, -0.0918, 0.3874, 0.0413, 0.2388, 0.0225, -0.008, 0.0059, 0.0, 0.0995, 0.0817, 0.0, 0.0322]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Final objective value</td>
<td style="text-align: left;">24859.9285</td>
</tr>
<tr class="even">
<td style="text-align: left;">Return code</td>
<td style="text-align: left;"><code>FTOL_REACHED</code></td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loglikelihood</span>(m1) <span class="co"># StatsBase.loglikelihood: return loglikelihood of the model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>-12429.964272626661</code></pre>
</div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(m1)      <span class="co"># StatsBase.deviance: negative twice the log-likelihood relative to saturated mode`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>24859.928545253322</code></pre>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">objective</span>(m1)    <span class="co"># MixedModels.objective: saturated model not clear: negative twice the log-likelihood</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>24859.928545253322</code></pre>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(m1) <span class="co"># n of observations; they are not independent</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>9615</code></pre>
</div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>n_, p_, q_, k_ <span class="op">=</span> <span class="fu">size</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>(9615, 20, 13095, 3)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dof</span>(m1)  <span class="co"># n of degrees of freedom is number of model parameters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>69</code></pre>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>geom_df <span class="op">=</span> <span class="fu">sum</span>(<span class="fu">leverage</span>(m1)) <span class="co"># trace of hat / rank of model matrix / geom dof</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>5401.172562881657</code></pre>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>resid_df <span class="op">=</span> <span class="fu">nobs</span>(m1) <span class="op">-</span> geom_df  <span class="co"># eff. residual degrees of freedom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>4213.827437118343</code></pre>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aic</span>(m1)  <span class="co"># objective(m1) + 2*dof(m1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>24997.928545253322</code></pre>
</div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bic</span>(m1)  <span class="co"># objective(m1) + dof(m1)*log(nobs(m1))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>25492.733041656902</code></pre>
</div>
</div>
</section>
<section id="fixed-effect-statistics" class="level3">
<h3 class="anchored" data-anchor-id="fixed-effect-statistics">Fixed-effect statistics</h3>
<pre><code>+ julia&gt; coeftable(m1)     # StatsBase.coeftable: fixed-effects statiscs; 
                             default level=0.95
+ julia&gt; Arrow.write("./data/m_cpx_fe.arrow", DataFrame(coeftable(m1)));
+ julia&gt; coef(m1)          # StatsBase.coef - parts of the table
+ julia&gt; fixef(m1)         # MixedModels.fixef: not the same as coef() 
                             for rank-deficient case
+ julia&gt; m1.beta           # alternative extractor
+ julia&gt; fixefnames(m1)    # works also for coefnames(m1)
+ julia&gt; vcov(m1)          # StatsBase.vcov: var-cov matrix of fixed-effects coef.
+ julia&gt; stderror(m1)      # StatsBase.stderror: SE for fixed-effects coefficients
+ julia&gt; propertynames(m1) # names of available extractors</code></pre>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftable</span>(m1) <span class="co"># StatsBase.coeftable: fixed-effects statiscs; default level=0.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 41%">
<col style="width: 18%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">z</th>
<th style="text-align: left;">Pr(&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0198957</td>
<td style="text-align: right;">0.0181797</td>
<td style="text-align: right;">-1.09</td>
<td style="text-align: left;">0.2738</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0252286</td>
<td style="text-align: right;">0.0363626</td>
<td style="text-align: right;">-0.69</td>
<td style="text-align: left;">0.4878</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">-0.00750331</td>
<td style="text-align: right;">0.033948</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: left;">0.8251</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.00948514</td>
<td style="text-align: right;">0.028148</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: left;">0.7361</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0477326</td>
<td style="text-align: right;">0.0284959</td>
<td style="text-align: right;">-1.68</td>
<td style="text-align: left;">0.0939</td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.216067</td>
<td style="text-align: right;">0.0532644</td>
<td style="text-align: right;">4.06</td>
<td style="text-align: left;">&lt;1e-04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.428918</td>
<td style="text-align: right;">0.0316259</td>
<td style="text-align: right;">13.56</td>
<td style="text-align: left;">&lt;1e-41</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.284022</td>
<td style="text-align: right;">0.0898508</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: left;">0.0016</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.00990745</td>
<td style="text-align: right;">0.083981</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: left;">0.9061</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.132446</td>
<td style="text-align: right;">0.0785153</td>
<td style="text-align: right;">-1.69</td>
<td style="text-align: left;">0.0916</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.462133</td>
<td style="text-align: right;">0.0865555</td>
<td style="text-align: right;">5.34</td>
<td style="text-align: left;">&lt;1e-07</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: male</td>
<td style="text-align: right;">-0.304156</td>
<td style="text-align: right;">0.0519637</td>
<td style="text-align: right;">-5.85</td>
<td style="text-align: left;">&lt;1e-08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: male</td>
<td style="text-align: right;">0.115606</td>
<td style="text-align: right;">0.0488647</td>
<td style="text-align: right;">2.37</td>
<td style="text-align: left;">0.0180</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: male</td>
<td style="text-align: right;">-0.000338472</td>
<td style="text-align: right;">0.0459467</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: left;">0.9941</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: male</td>
<td style="text-align: right;">0.256071</td>
<td style="text-align: right;">0.0504849</td>
<td style="text-align: right;">5.07</td>
<td style="text-align: left;">&lt;1e-06</td>
</tr>
<tr class="even">
<td style="text-align: left;">a1 &amp; Sex: male</td>
<td style="text-align: right;">0.102575</td>
<td style="text-align: right;">0.105193</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: left;">0.3295</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.330641</td>
<td style="text-align: right;">0.177878</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: left;">0.0631</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.249753</td>
<td style="text-align: right;">0.166599</td>
<td style="text-align: right;">-1.50</td>
<td style="text-align: left;">0.1338</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">-0.0564921</td>
<td style="text-align: right;">0.156745</td>
<td style="text-align: right;">-0.36</td>
<td style="text-align: left;">0.7185</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: male</td>
<td style="text-align: right;">0.282304</td>
<td style="text-align: right;">0.172721</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: left;">0.1022</td>
</tr>
</tbody>
</table>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Arrow.write("./data/m_cpx_fe.arrow", DataFrame(coeftable(m1)));</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m1)              <span class="co"># StatsBase.coef; parts of the table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>20-element Vector{Float64}:
 -0.019895661169173753
 -0.0252286086466606
 -0.007503307499783369
  0.009485141256008411
 -0.04773260617184128
  0.21606682359478394
  0.4289181827805576
  0.28402239792208384
 -0.009907452850893879
 -0.13244568126871425
  0.46213334334532774
 -0.3041558420858966
  0.11560595912596357
 -0.0003384723054319844
  0.25607093229692646
  0.10257483102997447
  0.33064077723505425
 -0.24975262721592556
 -0.05649207024203066
  0.2823038814941723</code></pre>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(m1)    <span class="co"># MixedModels.fixef: not the same as coef() for rank-deficient case</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>20-element Vector{Float64}:
 -0.019895661169173753
 -0.0252286086466606
 -0.007503307499783369
  0.009485141256008411
 -0.04773260617184128
  0.21606682359478394
  0.4289181827805576
  0.28402239792208384
 -0.009907452850893879
 -0.13244568126871425
  0.46213334334532774
 -0.3041558420858966
  0.11560595912596357
 -0.0003384723054319844
  0.25607093229692646
  0.10257483102997447
  0.33064077723505425
 -0.24975262721592556
 -0.05649207024203066
  0.2823038814941723</code></pre>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>m1.β                  <span class="co"># alternative extractor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>20-element Vector{Float64}:
 -0.019895661169173753
 -0.0252286086466606
 -0.007503307499783369
  0.009485141256008411
 -0.04773260617184128
  0.21606682359478394
  0.4289181827805576
  0.28402239792208384
 -0.009907452850893879
 -0.13244568126871425
  0.46213334334532774
 -0.3041558420858966
  0.11560595912596357
 -0.0003384723054319844
  0.25607093229692646
  0.10257483102997447
  0.33064077723505425
 -0.24975262721592556
 -0.05649207024203066
  0.2823038814941723</code></pre>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixefnames</span>(m1)        <span class="co"># works also for coefnames(m1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>20-element Vector{String}:
 "(Intercept)"
 "Test: Star_r"
 "Test: S20_r"
 "Test: SLJ"
 "Test: BMT"
 "a1"
 "Sex: male"
 "Test: Star_r &amp; a1"
 "Test: S20_r &amp; a1"
 "Test: SLJ &amp; a1"
 "Test: BMT &amp; a1"
 "Test: Star_r &amp; Sex: male"
 "Test: S20_r &amp; Sex: male"
 "Test: SLJ &amp; Sex: male"
 "Test: BMT &amp; Sex: male"
 "a1 &amp; Sex: male"
 "Test: Star_r &amp; a1 &amp; Sex: male"
 "Test: S20_r &amp; a1 &amp; Sex: male"
 "Test: SLJ &amp; a1 &amp; Sex: male"
 "Test: BMT &amp; a1 &amp; Sex: male"</code></pre>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(m1)   <span class="co"># StatsBase.vcov: var-cov matrix of fixed-effects coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>20×20 Matrix{Float64}:
  0.000330501   2.43591e-5    1.96056e-5   …   3.93329e-6    2.31201e-5
  2.43591e-5    0.00132224   -0.000477655      3.76311e-6   -1.77831e-5
  1.96056e-5   -0.000477655   0.00115246       0.000111285   2.09003e-5
 -1.32449e-5   -6.17289e-5   -0.000405898     -0.00022474    9.06503e-5
 -8.81187e-5    4.90941e-5   -5.39657e-5       9.03322e-5   -0.000248286
 -0.00015691   -6.47616e-5   -7.85807e-5   …  -3.68946e-5    0.000138017
  3.32926e-5    9.72333e-7    1.73469e-6       1.382e-5      0.000209752
 -1.48292e-5   -0.000460011   0.000222094     -1.34859e-5    1.73724e-6
 -2.82151e-5    0.000222059  -0.000415524      3.90503e-5   -2.51012e-6
  2.9336e-6     1.03153e-6    0.00018521      -2.30757e-5   -1.25704e-5
  5.5421e-5    -3.20883e-5    4.23244e-5   …  -1.17946e-5    0.000107244
  5.78972e-7    2.12578e-5   -1.02265e-5      -2.92897e-6   -0.000128039
  9.42827e-7   -1.00092e-5    1.41961e-5       0.000718311   0.000168555
 -3.80592e-6    1.25308e-6   -3.91593e-6      -0.00144658    0.000587444
  1.00848e-5    2.22377e-6   -2.9881e-6        0.000587241  -0.00171884
 -9.22279e-5   -4.20131e-6   -7.74037e-6   …  -8.99195e-5   -0.00334634
 -6.14052e-6   -0.00027966    0.000137583      0.000100617   0.0021312
 -9.46166e-6    0.000136945  -0.000256438     -0.0118558    -0.00282681
  3.93329e-6    3.76311e-6    0.000111285      0.0245691    -0.0102727
  2.31201e-5   -1.77831e-5    2.09003e-5      -0.0102727     0.0298327</code></pre>
</div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(m1; corr<span class="op">=</span><span class="cn">true</span>) <span class="co"># StatsBase.vcov: correlation matrix of fixed-effects coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>20×20 Matrix{Float64}:
  1.0           0.0368485     0.0317672   …   0.0013803     0.00736303
  0.0368485     1.0          -0.386941        0.000660232  -0.00283144
  0.0317672    -0.386941      1.0             0.0209136     0.00356445
 -0.0258831    -0.0603095    -0.424772       -0.0509377     0.0186456
 -0.170098      0.0473797    -0.0557856       0.020224     -0.0504456
 -0.162042     -0.0334369    -0.0434576   …  -0.00441908    0.015002
  0.0579053     0.000845505   0.00161571      0.00278785    0.0383987
 -0.00907838   -0.140796      0.0728117      -0.000957554   0.000111942
 -0.0184805     0.0727163    -0.145748        0.00296653   -0.000173049
  0.00205523    0.000361302   0.0694859      -0.00187502   -0.000926931
  0.0352203    -0.0101952     0.014404    …  -0.000869348   0.00717354
  0.000612874   0.0112503    -0.00579714     -0.0003596    -0.0142658
  0.00106133   -0.00563312    0.00855775      0.0937828     0.019971
 -0.00455637    0.000750012  -0.00251054     -0.20086       0.074023
  0.010988      0.00121136   -0.00174349      0.0742095    -0.197118
 -0.048227     -0.00109836   -0.00216752  …  -0.00545349   -0.184178
 -0.00189888   -0.0432368     0.022784        0.00360873    0.0693674
 -0.00312399    0.0226058    -0.0453415      -0.454011     -0.0982379
  0.0013803     0.000660232   0.0209136       1.0          -0.379441
  0.00736303   -0.00283144    0.00356445     -0.379441      1.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stderror</span>(m1)       <span class="co"># StatsBase.stderror: SE for fixed-effects coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>20-element Vector{Float64}:
 0.018179695754188763
 0.036362647652246415
 0.033947966931311996
 0.028147974876918565
 0.0284958511780161
 0.05326436046683719
 0.03162592280498092
 0.0898507907685589
 0.08398095381138845
 0.07851534867595167
 0.08655549082455408
 0.051963682688124575
 0.048864694440272756
 0.04594665491480662
 0.05048494535642958
 0.10519260031429802
 0.1778777471389226
 0.1665987201208234
 0.15674526525976237
 0.17272135026035296</code></pre>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">propertynames</span>(m1)  <span class="co"># names of available extractors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>(:formula, :reterms, :Xymat, :feterm, :sqrtwts, :parmap, :dims, :A, :L, :optsum, :θ, :theta, :β, :beta, :βs, :betas, :λ, :lambda, :stderror, :σ, :sigma, :σs, :sigmas, :σρs, :sigmarhos, :b, :u, :lowerbd, :X, :y, :corr, :vcov, :PCA, :rePCA, :objective, :pvalues)</code></pre>
</div>
</div>
</section>
<section id="covariance-parameter-estimates" class="level3">
<h3 class="anchored" data-anchor-id="covariance-parameter-estimates">Covariance parameter estimates</h3>
<p>These commands inform us about the model parameters associated with the RES.</p>
<pre><code>+ julia&gt; issingular(m1)        # Test singularity for param. vector m1.theta
+ julia&gt; VarCorr(m1)           # MixedModels.VarCorr: est. of RES
+ julia&gt; propertynames(m1)
+ julia&gt; m1.σ                  # residual; or: m1.sigma
+ julia&gt; m1.σs                 # VCs; m1.sigmas
+ julia&gt; m1.θ                  # Parameter vector for RES (w/o residual); m1.theta
+ julia&gt; MixedModels.sdest(m1) #  prsqrt(MixedModels.varest(m1))
+ julia&gt; BlockDescription(m1)  #  Description of blocks of A and L in an LMM</code></pre>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m1) <span class="co"># Test if model is singular for paramter vector m1.theta (default)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>true</code></pre>
</div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>true</code></pre>
</div>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m1) <span class="co"># MixedModels.VarCorr: estimates of random-effect structure (RES)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Variance</th>
<th style="text-align: right;">Std.Dev</th>
<th style="text-align: right;">Corr.</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Child</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.3545682</td>
<td style="text-align: right;">0.5954563</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.5535949</td>
<td style="text-align: right;">0.7440396</td>
<td style="text-align: right;">+0.04</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.4122709</td>
<td style="text-align: right;">0.6420832</td>
<td style="text-align: right;">+0.15</td>
<td style="text-align: right;">-0.53</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.3114685</td>
<td style="text-align: right;">0.5580937</td>
<td style="text-align: right;">-0.00</td>
<td style="text-align: right;">+0.03</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.5501338</td>
<td style="text-align: right;">0.7417100</td>
<td style="text-align: right;">-0.30</td>
<td style="text-align: right;">+0.15</td>
<td style="text-align: right;">-0.24</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">School</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0357246</td>
<td style="text-align: right;">0.1890096</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.1197096</td>
<td style="text-align: right;">0.3459907</td>
<td style="text-align: right;">+0.08</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.1268505</td>
<td style="text-align: right;">0.3561608</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.1008311</td>
<td style="text-align: right;">0.3175392</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">-0.51</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0520816</td>
<td style="text-align: right;">0.2282138</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">+0.01</td>
<td style="text-align: right;">+0.04</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.0248607</td>
<td style="text-align: right;">0.1576727</td>
<td style="text-align: right;">+0.13</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">+0.33</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.0213402</td>
<td style="text-align: right;">0.1460829</td>
<td style="text-align: right;">+0.29</td>
<td style="text-align: right;">-0.00</td>
<td style="text-align: right;">+0.00</td>
<td style="text-align: right;">-0.26</td>
<td style="text-align: right;">+0.91</td>
<td style="text-align: right;">+0.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohort</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0029478</td>
<td style="text-align: right;">0.0542937</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0019871</td>
<td style="text-align: right;">0.0445772</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0003083</td>
<td style="text-align: right;">0.0175598</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.2975145</td>
<td style="text-align: right;">0.5454489</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Variance</th>
<th style="text-align: right;">Std.Dev</th>
<th style="text-align: right;">Corr.</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Child</td>
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;">0.5805028</td>
<td style="text-align: right;">0.7619074</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.5470959</td>
<td style="text-align: right;">0.7396593</td>
<td style="text-align: right;">+0.48</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.6282565</td>
<td style="text-align: right;">0.7926263</td>
<td style="text-align: right;">+0.60</td>
<td style="text-align: right;">+0.63</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.6289009</td>
<td style="text-align: right;">0.7930327</td>
<td style="text-align: right;">+0.53</td>
<td style="text-align: right;">+0.59</td>
<td style="text-align: right;">+0.73</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.5259559</td>
<td style="text-align: right;">0.7252282</td>
<td style="text-align: right;">+0.21</td>
<td style="text-align: right;">+0.42</td>
<td style="text-align: right;">+0.39</td>
<td style="text-align: right;">+0.50</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">School</td>
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;">0.0777884</td>
<td style="text-align: right;">0.2789058</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.1056798</td>
<td style="text-align: right;">0.3250843</td>
<td style="text-align: right;">+0.36</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0918594</td>
<td style="text-align: right;">0.3030832</td>
<td style="text-align: right;">+0.23</td>
<td style="text-align: right;">+0.37</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0557714</td>
<td style="text-align: right;">0.2361598</td>
<td style="text-align: right;">+0.51</td>
<td style="text-align: right;">+0.31</td>
<td style="text-align: right;">+0.34</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0555648</td>
<td style="text-align: right;">0.2357218</td>
<td style="text-align: right;">+0.35</td>
<td style="text-align: right;">+0.19</td>
<td style="text-align: right;">+0.25</td>
<td style="text-align: right;">+0.53</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.0593786</td>
<td style="text-align: right;">0.2436772</td>
<td style="text-align: right;">+0.37</td>
<td style="text-align: right;">+0.10</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">+0.02</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Sex: male</td>
<td style="text-align: right;">0.0221873</td>
<td style="text-align: right;">0.1489539</td>
<td style="text-align: right;">+0.17</td>
<td style="text-align: right;">+0.14</td>
<td style="text-align: right;">+0.15</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">+0.73</td>
<td style="text-align: right;">+0.19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohort</td>
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;">0.0011647</td>
<td style="text-align: right;">0.0341275</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0067749</td>
<td style="text-align: right;">0.0823098</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0009263</td>
<td style="text-align: right;">0.0304359</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.2818544</td>
<td style="text-align: right;">0.5308996</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>m1.σs      <span class="co"># VCs; m1.sigmas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>(Child = (var"(Intercept)" = 0.5954563012956545, var"Test: Star_r" = 0.7440395656928731, var"Test: S20_r" = 0.642083242243342, var"Test: SLJ" = 0.5580936633835759, var"Test: BMT" = 0.7417100325651534), School = (var"(Intercept)" = 0.18900961537081512, var"Test: Star_r" = 0.3459907312274253, var"Test: S20_r" = 0.3561607937297112, var"Test: SLJ" = 0.31753918142583637, var"Test: BMT" = 0.22821383079614746, a1 = 0.1576726836362368, var"Sex: male" = 0.1460829099567715), Cohort = (var"(Intercept)" = 0.0, var"Test: Star_r" = 0.05429365509364568, var"Test: S20_r" = 0.04457721914401475, var"Test: SLJ" = 0.0, var"Test: BMT" = 0.017559801357771326))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>m1.θ       <span class="co"># Parameter vector for RES (w/o residual); m1.theta</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>48-element Vector{Float64}:
  1.091681149690514
  0.06122032237794931
  0.18010538600424852
 -0.002115798921991684
 -0.407639295612378
  1.3627121326733238
 -0.6346633507602674
  0.033161340725922556
  0.2279159755264362
  0.9749263283676822
 -0.43480940048954275
 -0.17240321202738373
  0.9256017495380907
  ⋮
 -0.09175954127636438
  0.38741095386246566
  0.041317113041006485
  0.23876664699545527
  0.02245130461806735
 -0.008008990788460643
  0.005893532357977424
  0.0
  0.09953939472059105
  0.08172574501144028
  0.0
  0.03219330132686052</code></pre>
</div>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BlockDescription</span>(m1) <span class="co">#  Description of blocks of A and L in a LinearMixedModel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">rows</th>
<th style="text-align: left;">Child</th>
<th style="text-align: left;">School</th>
<th style="text-align: left;">Cohort</th>
<th style="text-align: left;">fixed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">9935</td>
<td style="text-align: left;">BlkDiag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">3115</td>
<td style="text-align: left;">Sparse</td>
<td style="text-align: left;">BlkDiag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">45</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">BlkDiag/Dense</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">21</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>m2.θ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>48-element Vector{Float64}:
  1.4351251540146468
  0.6689585063336703
  0.8945881052776556
  0.7976264781871568
  0.29092328451397836
  1.2221102042751668
  0.5741878852107406
  0.5615985877923488
  0.4901041933613002
  1.0483469868670556
  0.5664550767111587
  0.24119200862511742
  0.9791960565175124
  ⋮
 -0.09381253971965217
  0.3727101256397806
  0.031693097804373876
  0.2574912228403121
  0.3808427084858804
 -0.0068038419400346314
  0.0
  0.06428248565092799
  0.0
  0.15503827514152782
  0.0
  0.057328830741360075</code></pre>
</div>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BlockDescription</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">rows</th>
<th style="text-align: left;">Child</th>
<th style="text-align: left;">School</th>
<th style="text-align: left;">Cohort</th>
<th style="text-align: left;">fixed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">9935</td>
<td style="text-align: left;">BlkDiag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">3115</td>
<td style="text-align: left;">Sparse</td>
<td style="text-align: left;">BlkDiag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">45</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">BlkDiag/Dense</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">21</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
</tr>
</tbody>
</table>
</section>
<section id="model-predictions" class="level3">
<h3 class="anchored" data-anchor-id="model-predictions">Model “predictions”</h3>
<p>These commands inform us about extracion of conditional modes/means and (co-)variances, that using the model parameters to improve the predictions for units (levels) of the grouping (random) factors. We need this information, e.g., for partial-effect response profiles (e.g., facet plot) or effect profiles (e.g., caterpillar plot), or visualizing the borrowing-strength effect for correlation parameters (e.g., shrinkage plots). We are using the fit of LMM <code>m2</code>.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode jl code-with-copy"><code class="sourceCode julia"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>julia<span class="op">&gt;</span> <span class="fu">condVar</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Some plotting functions are currently available from the <code>MixedModelsMakie</code> package or via custom functions.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode jl code-with-copy"><code class="sourceCode julia"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> julia<span class="op">&gt;</span> <span class="fu">caterpillar!</span>(m2)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> julia<span class="op">&gt;</span> <span class="fu">shrinkage!</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="conditional-covariances" class="level4">
<h4 class="anchored" data-anchor-id="conditional-covariances">Conditional covariances</h4>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">condVar</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>3-element Vector{Array{Float64, 3}}:
 [0.07542670442620816 0.007778060896008802 … -0.0008706712326870283 -0.0148895913274024; 0.007778060896008802 0.30117578717575644 … -0.0010542665368989857 0.023203095240326578; … ; -0.0008706712326870283 -0.0010542665368989857 … 0.2095320148216277 -0.08228817264960842; -0.0148895913274024 0.023203095240326578 … -0.08228817264960842 0.272432823067156;;; 0.0721174039203284 0.006797076840335152 … -0.00040608979210250863 -0.013930254491114484; 0.006797076840335152 0.2987487764780418 … -0.0004258551961350167 0.02330774158457693; … ; -0.00040608979210250863 -0.0004258551961350167 … 0.20776156615572544 -0.08249534861043777; -0.013930254491114484 0.02330774158457693 … -0.08249534861043777 0.27122556017183214;;; 0.07672417474133605 0.007782199151053684 … -0.0009903300931224596 -0.014470902655515195; 0.007782199151053684 0.30253944721607445 … -0.0012740066922604602 0.02328506911334749; … ; -0.0009903300931224596 -0.0012740066922604602 … 0.20960044231588618 -0.0821445064665663; -0.014470902655515195 0.02328506911334749 … -0.0821445064665663 0.2725298797859062;;; … ;;; 0.07290752691140319 -0.00020548247912515009 … -0.0007106239486054456 -0.020032735165400727; -0.00020548247912515009 0.30181764044174186 … -0.0013544667993968932 0.024575531433736315; … ; -0.0007106239486054456 -0.0013544667993968932 … 0.20960182180943945 -0.08225466998918285; -0.020032735165400727 0.024575531433736315 … -0.08225466998918285 0.2748404903181522;;; 0.08240289822252186 0.0019449952698139283 … -0.002236364993212201 -0.012991402043288578; 0.0019449952698139283 0.3004945131454864 … -0.0010981954517667641 0.024648284330633582; … ; -0.002236364993212201 -0.0010981954517667641 … 0.20883268496069335 -0.08191603413043402; -0.012991402043288578 0.024648284330633582 … -0.08191603413043402 0.2711274191641896;;; 0.08240289822252186 0.0019449952698139283 … -0.002236364993212201 -0.012991402043288578; 0.0019449952698139283 0.3004945131454864 … -0.0010981954517667641 0.024648284330633582; … ; -0.002236364993212201 -0.0010981954517667641 … 0.20883268496069335 -0.08191603413043402; -0.012991402043288578 0.024648284330633582 … -0.08191603413043402 0.2711274191641896]
 [0.03201332228613893 0.004397440532923171 … 0.002177489999747446 0.006066923551017444; 0.004397440532923171 0.10703161922532489 … -0.017480095144768195 0.0003349202723669057; … ; 0.002177489999747446 -0.017480095144768195 … 0.02240812678040294 0.008050133654325005; 0.006066923551017444 0.0003349202723669057 … 0.008050133654325005 0.019246407169991035;;; 0.02570577601307552 0.0015649248917573796 … 0.0017000657043176027 0.0042519591047390495; 0.0015649248917573796 0.08483584842804327 … -0.01646786127585138 0.0002528482543600472; … ; 0.0017000657043176027 -0.01646786127585138 … 0.01962560504996929 0.007179689503420948; 0.0042519591047390495 0.0002528482543600472 … 0.007179689503420948 0.016301740984804185;;; 0.019101324742681627 0.0014488256928758974 … 0.00018203957041563077 0.003179131143334205; 0.0014488256928758974 0.06281298293390207 … -0.013214744786112016 0.0008931220821422633; … ; 0.00018203957041563077 -0.013214744786112016 … 0.014752128628845288 0.005065223994771072; 0.003179131143334205 0.0008931220821422633 … 0.005065223994771072 0.012432045065121957;;; … ;;; 0.03356147275376861 0.006442859822173949 … 0.0031736533908885392 0.007843405387714168; 0.006442859822173949 0.11537391081463803 … -0.016263518223212356 0.0001405000070967628; … ; 0.0031736533908885392 -0.016263518223212356 … 0.022994739819057364 0.008909015216855979; 0.007843405387714168 0.0001405000070967628 … 0.008909015216855979 0.020504136181176198;;; 0.028506269044162803 0.004687332362245225 … 0.0016503960632583746 0.006184181342629733; 0.004687332362245225 0.09400942705021262 … -0.01479230157426482 0.0002646454164114237; … ; 0.0016503960632583746 -0.01479230157426482 … 0.0199013375778105 0.007916391641568146; 0.006184181342629733 0.0002646454164114237 … 0.007916391641568146 0.01820454506381111;;; 0.03148352024438303 0.0028068250514362717 … 0.004004709554842062 0.008403258564544713; 0.0028068250514362717 0.09690407251236807 … -0.01656876972955971 0.000249842496594262; … ; 0.004004709554842062 -0.01656876972955971 … 0.021698557532286847 0.008767061938059711; 0.008403258564544713 0.000249842496594262 … 0.008767061938059711 0.019843222981041513]
 [0.0 0.0 … 0.0 0.0; 0.0 0.0019830268765478167 … 0.0 -6.185122504223227e-6; … ; 0.0 0.0 … 0.0 0.0; 0.0 -6.185122504223227e-6 … 0.0 0.00029256150423556036;;; 0.0 0.0 … 0.0 0.0; 0.0 0.001878276953541943 … 0.0 -6.172292436984793e-6; … ; 0.0 0.0 … 0.0 0.0; 0.0 -6.172292436984793e-6 … 0.0 0.0002898606808662169;;; 0.0 0.0 … 0.0 0.0; 0.0 0.001798923132456498 … 0.0 -6.099508526007712e-6; … ; 0.0 0.0 … 0.0 0.0; 0.0 -6.099508526007712e-6 … 0.0 0.000287906548935756;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0019286511521350704 … 0.0 -6.452253208503372e-6; … ; 0.0 0.0 … 0.0 0.0; 0.0 -6.452253208503372e-6 … 0.0 0.00029142898918976557;;; 0.0 0.0 … 0.0 0.0; 0.0 0.00185019938632921 … 0.0 -6.072114731339023e-6; … ; 0.0 0.0 … 0.0 0.0; 0.0 -6.072114731339023e-6 … 0.0 0.0002892097573836892;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0017700723809946587 … 0.0 -6.053407573416679e-6; … ; 0.0 0.0 … 0.0 0.0; 0.0 -6.053407573416679e-6 … 0.0 0.000286287620121245;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0017791570051395884 … 0.0 -6.2755420561367225e-6; … ; 0.0 0.0 … 0.0 0.0; 0.0 -6.2755420561367225e-6 … 0.0 0.00028648952929911226;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0016464785382481787 … 0.0 -5.469313386159436e-6; … ; 0.0 0.0 … 0.0 0.0; 0.0 -5.469313386159436e-6 … 0.0 0.0002828144160516554;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0017066657260981736 … 0.0 -5.6534209717495444e-6; … ; 0.0 0.0 … 0.0 0.0; 0.0 -5.6534209717495444e-6 … 0.0 0.0002840054056602571]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">condVar</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>3-element Vector{Array{Float64, 3}}:
 [0.19523335411609347 0.04319330246086449 … 0.049885075958329084 0.017778601952765823; 0.04319330246086449 0.19515564354125176 … 0.05543489552165503 0.04403888336783887; … ; 0.049885075958329084 0.05543489552165503 … 0.19084227715810548 0.05934276454532541; 0.017778601952765823 0.04403888336783887 … 0.05934276454532541 0.20369951908972664;;; 0.19136937077461416 0.03947053014342581 … 0.04562829330293411 0.014667359024812447; 0.03947053014342581 0.18889904544991962 … 0.05045964475106784 0.040331696740157116; … ; 0.04562829330293411 0.05045964475106784 … 0.18444924034419075 0.05455379195694386; 0.014667359024812447 0.040331696740157116 … 0.05455379195694386 0.19916105536801487;;; 0.1962907560774691 0.043610865170077215 … 0.04971194395540189 0.01812022659013002; 0.043610865170077215 0.19647597191341037 … 0.05508358082356382 0.0442704675542718; … ; 0.04971194395540189 0.05508358082356382 … 0.1898452898726911 0.059360191805678565; 0.01812022659013002 0.0442704675542718 … 0.059360191805678565 0.204757330250997;;; … ;;; 0.21074629817491167 0.051576124767729124 … 0.05699519419042287 0.016969174061697324; 0.051576124767729124 0.19732752672527198 … 0.054420630882119625 0.03621428952157521; … ; 0.05699519419042287 0.054420630882119625 … 0.1873006386358677 0.049000845082648556; 0.016969174061697324 0.03621428952157521 … 0.049000845082648556 0.18932839226525974;;; 0.2112281371468095 0.05441098477823823 … 0.057925756114080205 0.02629467160468497; 0.05441098477823823 0.20102296569537695 … 0.05738560563934567 0.04774272215772214; … ; 0.057925756114080205 0.05738560563934567 … 0.1875536434201301 0.05916529900927038; 0.02629467160468497 0.04774272215772214 … 0.05916529900927038 0.20541992843116355;;; 0.2112281371468095 0.05441098477823823 … 0.057925756114080205 0.02629467160468497; 0.05441098477823823 0.20102296569537695 … 0.05738560563934567 0.04774272215772214; … ; 0.057925756114080205 0.05738560563934567 … 0.1875536434201301 0.05916529900927038; 0.02629467160468497 0.04774272215772214 … 0.05916529900927038 0.20541992843116355]
 [0.06893750234665875 0.027624843701506176 … 0.020302289888270923 0.004614210842135138; 0.027624843701506176 0.0924009611401355 … 0.004243563057891995 0.0047653922360549345; … ; 0.020302289888270923 0.004243563057891995 … 0.056483541270777524 0.0052401981016719145; 0.004614210842135138 0.0047653922360549345 … 0.0052401981016719145 0.020068840989176467;;; 0.05873590764679962 0.021643219662326466 … 0.018958212615170604 0.00313027417462382; 0.021643219662326466 0.06855718444346845 … 0.004003091394056976 0.0032122779476219743; … ; 0.018958212615170604 0.004003091394056976 … 0.055263213441089074 0.0053752292069264955; 0.00313027417462382 0.0032122779476219743 … 0.0053752292069264955 0.016872324738517797;;; 0.0429295356212511 0.014265509867178736 … 0.009801252841880525 0.002287815751325804; 0.014265509867178736 0.047891860202778705 … -0.0011787352523036148 0.002852400181463205; … ; 0.009801252841880525 -0.0011787352523036148 … 0.04569393574217092 0.0016969508797054183; 0.002287815751325804 0.002852400181463205 … 0.0016969508797054183 0.01315728667976761;;; … ;;; 0.06979285126417656 0.029687894735718732 … 0.020607724261614047 0.006889068902012754; 0.029687894735718732 0.10396154107226319 … 0.006225014382702326 0.0068216840794921435; … ; 0.020607724261614047 0.006225014382702326 … 0.056672296855706274 0.006414956396936069; 0.006889068902012754 0.0068216840794921435 … 0.006414956396936069 0.021339280400213247;;; 0.05847510220399124 0.023687591593518693 … 0.01558298710295896 0.005262656941467362; 0.023687591593518693 0.08210142187817218 … 0.0027228733146932387 0.005302277412493336; … ; 0.01558298710295896 0.0027228733146932387 … 0.05290003692979896 0.005749951317875997; 0.005262656941467362 0.005302277412493336 … 0.005749951317875997 0.018910525143995712;;; 0.06747767618598617 0.028261130003842193 … 0.022946631292108315 0.007505671475164516; 0.028261130003842193 0.085066281230219 … 0.007956254407873264 0.007592771129540978; … ; 0.022946631292108315 0.007956254407873264 … 0.056225736503113986 0.006405731142508409; 0.007505671475164516 0.007592771129540978 … 0.006405731142508409 0.020621393474069404]
 [0.0009399607795008945 0.0 … 0.0 -1.196174650276707e-6; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; -1.196174650276707e-6 0.0 … 0.0 0.0007724957051659319;;; 0.0009075033293564738 0.0 … 0.0 -6.027979776855023e-7; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; -6.027979776855023e-7 0.0 … 0.0 0.0007495249423962104;;; 0.0008799350333624272 0.0 … 0.0 -5.390467017285931e-7; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; -5.390467017285931e-7 0.0 … 0.0 0.0007329735018575524;;; 0.0009220319038320892 0.0 … 0.0 -5.049802359259136e-7; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; -5.049802359259136e-7 0.0 … 0.0 0.0007629610132067539;;; 0.0008991392294401429 0.0 … 0.0 -6.080649630933205e-7; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; -6.080649630933205e-7 0.0 … 0.0 0.0007434694428274968;;; 0.000872558144176728 0.0 … 0.0 -3.8466256884483373e-7; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; -3.8466256884483373e-7 0.0 … 0.0 0.0007194056628668594;;; 0.000874691811882813 0.0 … 0.0 3.282221351959827e-8; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 3.282221351959827e-8 0.0 … 0.0 0.0007211595117856373;;; 0.0008295917162955104 0.0 … 0.0 5.378294602604871e-7; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 5.378294602604871e-7 0.0 … 0.0 0.0006921839036702976;;; 0.0008496787069048915 0.0 … 0.0 -4.6325843293391996e-7; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; -4.6325843293391996e-7 0.0 … 0.0 0.0007017694680640312]</code></pre>
</div>
</div>
<p>They are hard to look at. Let’s take pictures.</p>
</section>
<section id="caterpillar-plots" class="level4">
<h4 class="anchored" data-anchor-id="caterpillar-plots">Caterpillar plots</h4>
<div class="cell" data-execution_count="80">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">caterpillar!</span>(</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Figure</span>(; resolution<span class="op">=</span>(<span class="fl">800</span>, <span class="fl">400</span>)), <span class="fu">ranefinfo</span>(m1, <span class="op">:</span>Cohort)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="81">
<div id="fig-caterpillarcohort" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="fggk21_files/figure-html/fig-caterpillarcohort-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 3: Prediction intervals of the random effects for Cohort in model m1</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="shrinkage-plots" class="level4">
<h4 class="anchored" data-anchor-id="shrinkage-plots">Shrinkage plots</h4>
<p>These are just teasers. We will pick this up in a separate tutorial. Enjoy!</p>
<div class="cell" data-execution_count="81">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shrinkageplot!</span>(<span class="fu">Figure</span>(; resolution<span class="op">=</span>(<span class="fl">800</span>, <span class="fl">800</span>)), m1, <span class="op">:</span>Cohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="82">
<div id="fig-m1shrinkagecohort" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="fggk21_files/figure-html/fig-m1shrinkagecohort-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4: Shrinkage plot of the random effects for Cohort in model m1</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="82">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shrinkageplot!</span>(<span class="fu">Figure</span>(; resolution<span class="op">=</span>(<span class="fl">800</span>, <span class="fl">800</span>)), m2, <span class="op">:</span>Cohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="83">
<div id="fig-m2shrinkagecohort" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="fggk21_files/figure-html/fig-m2shrinkagecohort-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 5: Shrinkage plot of the random effects for Cohort in model m2</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="doc-bibliography">
<div id="ref-Fuehner2021" class="csl-entry" role="doc-biblioentry">
Fühner, T., Granacher, U., Golle, K., &amp; Kliegl, R. (2021). Age and sex effects in physical fitness components of 108,295 third graders including 515 primary schools and 9 cohorts. <em>Scientific Reports</em>, <em>11</em>(1). <a href="https://doi.org/10.1038/s41598-021-97000-4">https://doi.org/10.1038/s41598-021-97000-4</a>
</div>
<div id="ref-Schielzeth2008" class="csl-entry" role="doc-biblioentry">
Schielzeth, H., &amp; Forstmeier, W. (2008). Conclusions beyond support: Overconfident estimates in mixed models. <em>Behavioral Ecology</em>, <em>20</em>(2), 416–420. <a href="https://doi.org/10.1093/beheco/arn145">https://doi.org/10.1093/beheco/arn145</a>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./shrinkageplot.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">More on shrinkage plots</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>