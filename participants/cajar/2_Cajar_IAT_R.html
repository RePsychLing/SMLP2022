<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.147">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Anke Cajar (&amp; a fewrevisions: Reinhold Kliegl)">
<meta name="dcterms.date" content="2022-08-09">

<title>Detecting Faked IATs via Task-Switch Costs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="2_Cajar_IAT_R_files/libs/clipboard/clipboard.min.js"></script>
<script src="2_Cajar_IAT_R_files/libs/quarto-html/quarto.js"></script>
<script src="2_Cajar_IAT_R_files/libs/quarto-html/popper.min.js"></script>
<script src="2_Cajar_IAT_R_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="2_Cajar_IAT_R_files/libs/quarto-html/anchor.min.js"></script>
<link href="2_Cajar_IAT_R_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="2_Cajar_IAT_R_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="2_Cajar_IAT_R_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="2_Cajar_IAT_R_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="2_Cajar_IAT_R_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#anke-cajar-ac-analysismodeling-issues" id="toc-anke-cajar-ac-analysismodeling-issues" class="nav-link active" data-scroll-target="#anke-cajar-ac-analysismodeling-issues"><span class="toc-section-number">1</span>  Anke Cajar (AC): Analysis/modeling issues</a></li>
  <li><a href="#background-and-overview" id="toc-background-and-overview" class="nav-link" data-scroll-target="#background-and-overview"><span class="toc-section-number">2</span>  Background and overview</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="toc-section-number">2.1</span>  Data</a></li>
  <li><a href="#iat-and-faking-strategies" id="toc-iat-and-faking-strategies" class="nav-link" data-scroll-target="#iat-and-faking-strategies"><span class="toc-section-number">2.2</span>  IAT and faking strategies</a></li>
  </ul></li>
  <li><a href="#readme" id="toc-readme" class="nav-link" data-scroll-target="#readme"><span class="toc-section-number">3</span>  Readme</a>
  <ul class="collapse">
  <li><a href="#design" id="toc-design" class="nav-link" data-scroll-target="#design"><span class="toc-section-number">3.1</span>  Design</a></li>
  <li><a href="#variables" id="toc-variables" class="nav-link" data-scroll-target="#variables"><span class="toc-section-number">3.2</span>  Variables</a></li>
  </ul></li>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages"><span class="toc-section-number">4</span>  Load packages</a></li>
  <li><a href="#preprocessing" id="toc-preprocessing" class="nav-link" data-scroll-target="#preprocessing"><span class="toc-section-number">5</span>  Preprocessing</a>
  <ul class="collapse">
  <li><a href="#trial-data" id="toc-trial-data" class="nav-link" data-scroll-target="#trial-data"><span class="toc-section-number">5.1</span>  Trial data</a></li>
  <li><a href="#subject-data" id="toc-subject-data" class="nav-link" data-scroll-target="#subject-data"><span class="toc-section-number">5.2</span>  Subject data</a></li>
  <li><a href="#item-data" id="toc-item-data" class="nav-link" data-scroll-target="#item-data"><span class="toc-section-number">5.3</span>  Item data</a></li>
  <li><a href="#combine-data" id="toc-combine-data" class="nav-link" data-scroll-target="#combine-data"><span class="toc-section-number">5.4</span>  Combine data</a></li>
  <li><a href="#check-distribution-of-rts" id="toc-check-distribution-of-rts" class="nav-link" data-scroll-target="#check-distribution-of-rts"><span class="toc-section-number">5.5</span>  Check distribution of rt’s</a></li>
  </ul></li>
  <li><a href="#plot-switch-costs" id="toc-plot-switch-costs" class="nav-link" data-scroll-target="#plot-switch-costs"><span class="toc-section-number">6</span>  Plot switch costs</a></li>
  <li><a href="#acs-model-selection-revised" id="toc-acs-model-selection-revised" class="nav-link" data-scroll-target="#acs-model-selection-revised"><span class="toc-section-number">7</span>  AC’s model selection (revised)</a>
  <ul class="collapse">
  <li><a href="#define-contrasts" id="toc-define-contrasts" class="nav-link" data-scroll-target="#define-contrasts"><span class="toc-section-number">7.1</span>  Define contrasts</a></li>
  <li><a href="#models-that-do-not-or-did-not-converge" id="toc-models-that-do-not-or-did-not-converge" class="nav-link" data-scroll-target="#models-that-do-not-or-did-not-converge"><span class="toc-section-number">7.2</span>  Models that do not (or did not) converge</a></li>
  <li><a href="#minimal-model-works" id="toc-minimal-model-works" class="nav-link" data-scroll-target="#minimal-model-works"><span class="toc-section-number">7.3</span>  Minimal model works</a></li>
  <li><a href="#regression-diagnostics-for-model13" id="toc-regression-diagnostics-for-model13" class="nav-link" data-scroll-target="#regression-diagnostics-for-model13"><span class="toc-section-number">7.4</span>  Regression diagnostics for model13</a></li>
  </ul></li>
  <li><a href="#rks-proposal" id="toc-rks-proposal" class="nav-link" data-scroll-target="#rks-proposal"><span class="toc-section-number">8</span>  RK’s proposal</a>
  <ul class="collapse">
  <li><a href="#contrasts-and-indicator-variables" id="toc-contrasts-and-indicator-variables" class="nav-link" data-scroll-target="#contrasts-and-indicator-variables"><span class="toc-section-number">8.1</span>  Contrasts and indicator variables</a></li>
  <li><a href="#model-selection" id="toc-model-selection" class="nav-link" data-scroll-target="#model-selection"><span class="toc-section-number">8.2</span>  Model selection</a></li>
  <li><a href="#diagnostics-for-model-m1" id="toc-diagnostics-for-model-m1" class="nav-link" data-scroll-target="#diagnostics-for-model-m1"><span class="toc-section-number">8.3</span>  Diagnostics for model <code>m1</code></a></li>
  <li><a href="#plot-of-switch-costs-for-speed-scores" id="toc-plot-of-switch-costs-for-speed-scores" class="nav-link" data-scroll-target="#plot-of-switch-costs-for-speed-scores"><span class="toc-section-number">8.4</span>  Plot of switch costs for speed scores</a></li>
  <li><a href="#partial-effect-plot" id="toc-partial-effect-plot" class="nav-link" data-scroll-target="#partial-effect-plot"><span class="toc-section-number">8.5</span>  Partial effect plot</a></li>
  </ul></li>
  <li><a href="#conditional-means-of-random-effects" id="toc-conditional-means-of-random-effects" class="nav-link" data-scroll-target="#conditional-means-of-random-effects"><span class="toc-section-number">9</span>  Conditional means of random effects</a>
  <ul class="collapse">
  <li><a href="#subject-related-conditional-means-of-random-experimental-effects" id="toc-subject-related-conditional-means-of-random-experimental-effects" class="nav-link" data-scroll-target="#subject-related-conditional-means-of-random-experimental-effects"><span class="toc-section-number">9.1</span>  Subject-related conditional means of random experimental effects</a></li>
  <li><a href="#subject-related-conditional-means-of-random-quasi-experimental-effects" id="toc-subject-related-conditional-means-of-random-quasi-experimental-effects" class="nav-link" data-scroll-target="#subject-related-conditional-means-of-random-quasi-experimental-effects"><span class="toc-section-number">9.2</span>  Subject-related conditional means of random quasi-experimental effects</a></li>
  <li><a href="#add-age-as-covariate-to-model-m1" id="toc-add-age-as-covariate-to-model-m1" class="nav-link" data-scroll-target="#add-age-as-covariate-to-model-m1"><span class="toc-section-number">9.3</span>  Add <code>age</code> as covariate to model <code>m1</code></a></li>
  <li><a href="#item-related-conditional-means-of-random-effects" id="toc-item-related-conditional-means-of-random-effects" class="nav-link" data-scroll-target="#item-related-conditional-means-of-random-effects"><span class="toc-section-number">9.4</span>  Item-related conditional means of random effects</a></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix"><span class="toc-section-number">10</span>  Appendix</a>
  <ul class="collapse">
  <li><a href="#refit-model13-with-sum-contrasts" id="toc-refit-model13-with-sum-contrasts" class="nav-link" data-scroll-target="#refit-model13-with-sum-contrasts"><span class="toc-section-number">10.1</span>  Refit <code>model13</code> with sum contrasts</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="toc-section-number">10.2</span>  Session info</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Detecting Faked IATs via Task-Switch Costs</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Anke Cajar (&amp; a fewrevisions: Reinhold Kliegl) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 9, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="anke-cajar-ac-analysismodeling-issues" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Anke Cajar (AC): Analysis/modeling issues</h1>
<ul>
<li>Is the contrast coding appropriate?</li>
<li>What is currently the best method for model selection (concerning questions like: from maximal to minimal model, doing rePCA, …)? Is the stuff from the RePsychLing package and vignettes still the way to do it?</li>
<li>How do I make sure that the random effects structure of my selected model is really supported by the data (again, rePCA?)?</li>
<li>How do I decide which optimizer to use for model fitting? I heard bobyqa is supposed to be good…</li>
<li>It seems that the order in which I put the factors in the formula changes the outcome. How do I decide on the order (most important factor first, than second etc.?)?</li>
<li>Model results (model 13) don’t really fit the mean response time/switch costs plot, as part of the effects you see in the figure goes into the random effects (By chance, there were more older subjects &gt; 45 years in the no-faking group, who had considerably longer mean response times in the baseline IAT). How do I report this in a paper? Should I plot the fixed effects from the model instead of mean response times (which I’d rather not)?</li>
</ul>
</section>
<section id="background-and-overview" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Background and overview</h1>
<ul>
<li>Data are from André Krügel.</li>
<li>Revisions and additions for SMLP2022 by Reinhold Kliegl (RK)</li>
<li>Revisions do not affect the main conclusion, but highlight common problems with fitting LMMs related to
<ul>
<li>contrast specification</li>
<li>convergence issue</li>
<li>zero correlation parameters</li>
</ul></li>
<li>Addition of new chunks illustrate
<ul>
<li>selection of parsimonious LMM using random-effects PCA (<code>rePCA()</code>) and LRTs (<code>anova()</code>)</li>
<li>plotting partial effect of high-order interaction (<code>remef()</code>)</li>
<li>plotting conditional means</li>
</ul></li>
</ul>
<section id="data" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="data"><span class="header-section-number">2.1</span> Data</h2>
<p>This is data from an experiment showing that we can reliably detect whether outcomes from the Implicit Association Test (IAT) are faked by analysing task-switch costs in the combined blocks of the IAT (see next paragraph) Every participant performed two IATs: the control group performed the same normative IAT twice and the faking group was instructed to fake the second IAT by deliberately slowing down response times in the compatible block. It has been shown that switches from a target-concept word to an attribute-dimension word between consecutive trials produces stronger switch costs (i.e., response-time differences between task-repetition and task-switch trials) in the incompatible block than in the compatible block. The present data show that even after successful faking of the IAT, these switch costs are preserved (although the true compatible block became the faked incompatible block). Thus, switch costs can be used to detect IAT faking reliably and with high accuracy.</p>
</section>
<section id="iat-and-faking-strategies" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="iat-and-faking-strategies"><span class="header-section-number">2.2</span> IAT and faking strategies</h2>
<p>The IAT measures people’s implicit associations between a target concept and an attribute dimension. People have to assign consecutively presented words as fast as possible to one of four categories—two categories belong to the target concept (e.g., family vs career words) and two categories belong to the attribute dimension (e.g., male vs female words). When strongly associated concepts share the same response key in the categorization task (e.g., career and male words or family and female words), response times are usually shorter than when less associated concepts share the same response key (e.g., career and female words or family and male words). The IAT block with shorter response times is called the compatible block, whereas the block with longer response times is called the incompatible block. IAT results can be deliberately faked, most easily and reliably by slowing down response times in the actual compatible block (making it look like the incompatible block and thus reversing associations). To date, an effective and accurate method for detecting faked IATs is still missing.</p>
</section>
</section>
<section id="readme" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Readme</h1>
<section id="design" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="design"><span class="header-section-number">3.1</span> Design</h2>
<ul>
<li>Design: 2 (B-Subj/W-Item) x 2 (W) x 2 (W) x 2 (W) factorial mixed design</li>
<li>N trials: 38 Subj x 20 Item x 8 W-Item x 2 repetition of items = 12160</li>
<li>N errors: 391 (3.2%)</li>
<li>N observations: 12160-391=11769</li>
</ul>
</section>
<section id="variables" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="variables"><span class="header-section-number">3.2</span> Variables</h2>
<ul>
<li><code>Subj</code>: Participant ID (renamed from <code>ID</code>; random factor)</li>
<li><code>Item</code>: Word ID (random factor)</li>
<li><code>Group</code> (between-Subj/within-Item):
<ul>
<li>No_Faking: control group, where people took the same normative IAT twice</li>
<li>Faking: experimental group, where people were instructed to fake the retest IAT by slowing down response times in the compatible block</li>
</ul></li>
<li><code>Time</code> (within-Subj/within-Item):
<ul>
<li>Baseline: first IAT (normative IAT)</li>
<li>Retest: second IAT (normative or faked, depending on Group)</li>
</ul></li>
<li><code>Block</code> (within-Subj/within-Item):
<ul>
<li>Compatible: IAT combined block with shorter response times</li>
<li>Incompatible: IAT combined block with longer response times</li>
</ul></li>
<li><code>Switch</code> (renamed from <code>TaskSwitch</code>; within-Subj/within-Item):
<ul>
<li>Yes: Switch from target concept to attribute dimension (or the other way around) from one trial to the next</li>
<li>No: No switch from target concept to attribute dimension (or the other way around) from one trial to the next</li>
</ul></li>
<li><code>rt</code>: trial response time (DV, renamed from <code>RT</code>)</li>
</ul>
</section>
</section>
<section id="load-packages" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Load packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arrow)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(<span class="fu">library</span>(tidyverse)))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(<span class="fu">library</span>(easystats)))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(summarytools)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># respecting color vision deficiency</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>cbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#009E73"</span>, <span class="st">"#CC79A7"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#999999"</span>, <span class="st">"#E69F00"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preprocessing" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Preprocessing</h1>
<section id="trial-data" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="trial-data"><span class="header-section-number">5.1</span> Trial data</h2>
<ul>
<li>Random factors should be factors, not integers!</li>
<li>RK style preferences
<ul>
<li>Factors capitalized, continuous variables in lower case</li>
<li><code>Subj</code> instead of <code>ID</code>; prefix subject and item numbers with <code>S</code> and <code>I</code></li>
<li>Short variable names and factor levels, but respect tradeoff with mmemonic value</li>
<li>Labels should be of equal length</li>
<li>Hint: Leave out vowels in names and labels</li>
</ul></li>
<li>See Jenny Bryan’s <a href="https://docplayer.net/55248970-Naming-things-prepared-by-jenny-bryan-for-reproducible-science-workshop.html">Naming Things</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>iat <span class="ot">&lt;-</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.table</span>(<span class="st">"./data/IAT_data.dat"</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">stringsAsFactors=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Subj"</span> <span class="ot">=</span> <span class="st">"ID"</span>, <span class="st">"rt"</span> <span class="ot">=</span> <span class="st">"RT"</span>, <span class="st">"Switch"</span> <span class="ot">=</span> <span class="st">"TaskSwitch"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Group =</span> <span class="fu">relevel</span>(Group, <span class="at">ref=</span><span class="st">"No_Faking"</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Subj =</span> <span class="fu">factor</span>(<span class="fu">paste0</span>(<span class="st">"S"</span>, <span class="fu">str_pad</span>(Subj, <span class="at">width =</span> <span class="dv">3</span>, <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">pad =</span> <span class="st">"0"</span>))),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Item =</span> <span class="fu">factor</span>(<span class="fu">paste0</span>(<span class="st">"I"</span>, <span class="fu">str_pad</span>(Item, <span class="at">width =</span> <span class="dv">2</span>, <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">pad =</span> <span class="st">"0"</span>)))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rt <span class="sc">&gt;=</span> <span class="dv">400</span> <span class="sc">&amp;</span> rt <span class="sc">&lt;=</span> <span class="dv">10000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#stview(dfSummary(iat), method="render")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>factor()</code> generates alphabetic sorting of factor leveks; <code>as_factor()</code> sorts them by occurrence.</li>
<li>See IAT scoring procedure from Greenwald et al.&nbsp;(2003) for removal of <code>rt</code> outliers.</li>
</ul>
</section>
<section id="subject-data" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="subject-data"><span class="header-section-number">5.2</span> Subject data</h2>
<ul>
<li>Rename variables</li>
<li>Convert types</li>
<li>Add membership in experimental <code>Group</code></li>
<li>Replace missing <code>age</code> with median and missing <code>Gender</code> with mode</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sinfo <span class="ot">&lt;-</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.table</span>(<span class="st">"./data/IAT_subj.dat"</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Subj=</span>ID, <span class="at">age=</span>Age) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Subj =</span> <span class="fu">factor</span>(<span class="fu">paste0</span>(<span class="st">"S"</span>, <span class="fu">str_pad</span>(Subj, <span class="at">width =</span> <span class="dv">3</span>, <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">pad =</span> <span class="st">"0"</span>))))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>sGroup <span class="ot">&lt;-</span> iat <span class="sc">|&gt;</span> <span class="fu">count</span>(Subj, Group)  </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>sinfo <span class="ot">&lt;-</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  sinfo <span class="sc">|&gt;</span> </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sGroup, <span class="at">by=</span><span class="st">"Subj"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(age),<span class="fu">median</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), age),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">Gender =</span> <span class="fu">as_factor</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(Gender), <span class="st">"female"</span>, Gender)))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#stview(dfSummary(sinfo), method="render")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="item-data" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="item-data"><span class="header-section-number">5.3</span> Item data</h2>
<ul>
<li>Item categories:
<ul>
<li>Task (target concept vs.&nbsp;attribute)</li>
<li>Valence (positive vs.&nbsp;negative words, included as nested within levels of <code>Task</code></li>
</ul></li>
</ul>
<div class="cell" data-unit="cm">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.table</span>(<span class="st">"./data/IAT_item.dat"</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Task =</span> <span class="fu">as_factor</span>(<span class="fu">if_else</span>(Item <span class="sc">&lt;=</span><span class="dv">10</span>, <span class="st">"target"</span>, <span class="st">"attribute"</span>)),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Valence =</span> <span class="fu">as_factor</span>(<span class="fu">if_else</span>(Item <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">|</span> (Item <span class="sc">&gt;=</span><span class="dv">11</span> <span class="sc">&amp;</span> Item <span class="sc">&lt;=</span> <span class="dv">15</span>), <span class="st">"+"</span>, <span class="st">"-"</span>)),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Item =</span> <span class="fu">factor</span>(<span class="fu">paste0</span>(<span class="st">"I"</span>, <span class="fu">str_pad</span>(Item, <span class="at">width =</span> <span class="dv">2</span>, <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">pad =</span> <span class="st">"0"</span>)))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#stview(dfSummary(items), method="render")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combine-data" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="combine-data"><span class="header-section-number">5.4</span> Combine data</h2>
<p>The dataframe will be used in analyses with <code>MixedModels.jl</code> in Julia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  iat <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sinfo, <span class="at">by=</span><span class="fu">c</span>( <span class="st">"Group"</span>, <span class="st">"Subj"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(items, <span class="at">by=</span><span class="st">"Item"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Subj, Gender, age, Item, Word, Task, Valence, Group, Time, Block, Switch, rt)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write_feather</span>(dat, <span class="st">"./data/Cajar_IAT.arrow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Separate files for data, subject info, and item info are easier to maintain and are preferred for storage in a public repository. The information can be combined as needed. The redundant format of one integrated file chosen here is to facilitate transition to working with Julia <code>MixedModels.jl</code> at SMLP2022.</p>
</section>
<section id="check-distribution-of-rts" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="check-distribution-of-rts"><span class="header-section-number">5.5</span> Check distribution of rt’s</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>lambdaList <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">boxcox</span>(<span class="fu">lm</span>(rt <span class="sc">~</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch, <span class="at">data=</span>dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(lambda <span class="ot">&lt;-</span> lambdaList<span class="sc">$</span>x[<span class="fu">which.max</span>(lambdaList<span class="sc">$</span>y)]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9090909</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="dv">1000</span><span class="sc">/</span>dat<span class="sc">$</span>rt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>speed <span class="ot">&lt;-</span> <span class="dv">1000</span><span class="sc">/</span>dat<span class="sc">$</span>rt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The check suggests reciprocal transformation of <code>rt</code>, that is to use <code>speed</code>.</p>
</section>
</section>
<section id="plot-switch-costs" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Plot switch costs</h1>
<p>RK: Put <code>Time</code> on blocks of x-axis?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>switch_costs <span class="ot">&lt;-</span> dat<span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Time, Group, Block, Switch)<span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">M =</span> <span class="fu">mean</span>(rt), <span class="at">SD=</span><span class="fu">sd</span>(rt), <span class="at">N=</span><span class="fu">n</span>(), <span class="at">SE=</span>SD<span class="sc">/</span><span class="fu">sqrt</span>(N))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Time', 'Group', 'Block'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fig_rt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(switch_costs, <span class="fu">aes</span>(<span class="at">x=</span>Switch, <span class="at">y=</span>M, <span class="at">color=</span>Block)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.7</span>, <span class="fu">aes</span>(<span class="at">group=</span>Block)) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>M<span class="dv">-2</span><span class="sc">*</span>SE, <span class="at">ymax=</span>M<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>SE), <span class="at">width=</span>.<span class="dv">1</span>, <span class="at">size=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Group<span class="sc">~</span>Time) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Block"</span>, <span class="at">values=</span>cbPalette) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Task switch"</span>, <span class="at">y=</span><span class="st">"Response time [ms]"</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">13</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig_rt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="acs-model-selection-revised" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> AC’s model selection (revised)</h1>
<p>This section reproduces logic of the original model selection, but where necessary with corrected LMM syntax.</p>
<section id="define-contrasts" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="define-contrasts"><span class="header-section-number">7.1</span> Define contrasts</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ctable(dat$Group, dat$Time)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ctable(dat$Switch, dat$Block)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Group)  <span class="ot">&lt;-</span> <span class="fu">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Time)   <span class="ot">&lt;-</span> <span class="fu">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Block)  <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)<span class="sc">/-</span><span class="dv">2</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Switch) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)<span class="sc">/-</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>RK:</p>
<ul>
<li>If you mix treatment and sum contrasts in the context of multifactorial experiments you really need to know what the coefficients are estimating. They are not representing the usual ANOVA main effects and interactions.</li>
<li>The contrasts are not orthogonal. This means you are bound to lose statistical power, except for contrasts that map directly on your hypotheses.</li>
<li>For hypothesis-guided contrast specification (recommended!) it may be better to explicitly specify the model matrix, rather than relying on a mixture of canned contrasts.</li>
<li>In the revision I use sum contrasts. They are orthogonal when all factors of have two levels. A direct comparison of the revised selected LMM <code>model13</code> with the one based on treatment contrasts is provided in the Appendix.</li>
<li>Order of factor levels. The order of factor levels is relevant for figures and tables. I prefer time and difficulty shown in a left-to-right or top-to-bottom order. The order chosen here is in agreement with this preference:</li>
<li>Order of factor levels also determines the signs of effects estimated in LMMs – unless explicitly specified. In general, I prefer a specification that yields positive effects, but order by time and difficulty may generate a conflict in this respect.</li>
<li>For sum contrasts division by (-2) yields estimates of the difference between levels (instead of differences from Grand Mean) and the sign of the effects is reversed (i.e., Switch: yes - no; Block: incompatible - compaible). The division by 2 is strongly discouraged by Douglas Bates because indicators for higher order interaction terms become very small. Since we analyze response speed these effects are expected to be negative. Therefore, for my own model selection (see below), I will <strong>not</strong> divide by 2 and I will <strong>not</strong> reverse the direction of effects for sum contrasts.</li>
</ul>
</section>
<section id="models-that-do-not-or-did-not-converge" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="models-that-do-not-or-did-not-converge"><span class="header-section-number">7.2</span> Models that do not (or did not) converge</h2>
<ul>
<li>AC: I tried model selection by starting with the maximal model and working my way down to the minimal model.</li>
<li>RK. Some convergence issues were due to false positives. Double-bar syntax does not work with factors; you need to convert to indicator variables – see next chunk.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mm <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch, <span class="at">data=</span>dat)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> mm[,<span class="dv">2</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>tm <span class="ot">&lt;-</span> mm[,<span class="dv">3</span>]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>bl <span class="ot">&lt;-</span> mm[,<span class="dv">4</span>]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>sw <span class="ot">&lt;-</span> mm[,<span class="dv">5</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>RK: Always use <code>control=lmerControl(calc.derivs=FALSE)</code>. Most convergence warnings are false positives.</li>
<li>RK: <code>Group</code> is a within-item factor; added as item-related VC.</li>
<li>RK: Save objects that take a long time to fit to be available for quick load later.</li>
<li>RK: Add LRTs for model comparisons (i.e., <code>anova()</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="st">"./fits/model1.rda"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(f1)){</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  model1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">+</span>       Time<span class="sc">*</span>Block<span class="sc">*</span>Switch<span class="sc">|</span>Subj) <span class="sc">+</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch<span class="sc">|</span>Item), </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save</span>(model1, <span class="at">file=</span>f1)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="fu">load</span>(f1)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model1))  <span class="co"># definitely overparameterized in Item, probably also in Subj</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]   [,3]    [,4]    [,5]    [,6]    [,7]
Standard deviation     0.7890 0.5034 0.4059 0.19518 0.17993 0.10328 0.06773
Proportion of Variance 0.5527 0.2250 0.1462 0.03382 0.02874 0.00947 0.00407
Cumulative Proportion  0.5527 0.7777 0.9239 0.95772 0.98646 0.99593 1.00000
                            [,8]
Standard deviation     7.902e-05
Proportion of Variance 0.000e+00
Cumulative Proportion  1.000e+00

$Item
Importance of components:
                         [,1]   [,2]    [,3]    [,4]    [,5]    [,6]     [,7]
Standard deviation     0.7788 0.3155 0.21114 0.15068 0.13482 0.05255 0.002507
Proportion of Variance 0.7636 0.1253 0.05613 0.02858 0.02288 0.00348 0.000010
Cumulative Proportion  0.7636 0.8889 0.94505 0.97363 0.99651 0.99999 0.999990
                          [,8]     [,9]     [,10]     [,11]     [,12]     [,13]
Standard deviation     0.00149 0.001134 0.0006525 0.0004157 0.0001883 8.655e-05
Proportion of Variance 0.00000 0.000000 0.0000000 0.0000000 0.0000000 0.000e+00
Cumulative Proportion  1.00000 1.000000 1.0000000 1.0000000 1.0000000 1.000e+00
                           [,14]     [,15] [,16]
Standard deviation     6.228e-05 8.605e-06     0
Proportion of Variance 0.000e+00 0.000e+00     0
Cumulative Proportion  1.000e+00 1.000e+00     1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name                        Std.Dev. Corr                       
 Subj     (Intercept)                 0.176132                            
          Time2                       0.137084 -0.376                     
          Block1                      0.081552 -0.249  0.078              
          Switch1                     0.067353 -0.120  0.345 -0.260       
          Time2:Block1                0.251775  0.282 -0.814 -0.337  0.060
          Time2:Switch1               0.030423  0.311 -0.768 -0.175 -0.146
          Block1:Switch1              0.106526 -0.247  0.015  0.621 -0.219
          Time2:Block1:Switch1        0.140614  0.125  0.614 -0.244  0.450
 Item     (Intercept)                 0.033383                            
          Group2                      0.013518 -0.842                     
          Time2                       0.022327 -0.782  0.710              
          Block1                      0.052107  0.193  0.028 -0.047       
          Switch1                     0.029923 -0.101  0.554  0.263 -0.110
          Group2:Time2                0.018714  0.370 -0.312 -0.727  0.412
          Group2:Block1               0.056356 -0.595  0.553  0.693 -0.180
          Time2:Block1                0.083064 -0.546  0.187  0.360 -0.814
          Group2:Switch1              0.054139  0.010 -0.314 -0.200  0.268
          Time2:Switch1               0.021431  0.706 -0.847 -0.648  0.089
          Block1:Switch1              0.115563 -0.139  0.398  0.021 -0.524
          Group2:Time2:Block1         0.089753  0.859 -0.718 -0.651  0.328
          Group2:Time2:Switch1        0.059344  0.102  0.155 -0.034 -0.502
          Group2:Block1:Switch1       0.136108 -0.023 -0.256 -0.159  0.318
          Time2:Block1:Switch1        0.141394 -0.100 -0.105 -0.031  0.576
          Group2:Time2:Block1:Switch1 0.166251 -0.112  0.250  0.091 -0.432
 Residual                             0.372661                            
                                                                             
                                                                             
                                                                             
                                                                             
                                                                             
                                                                             
  0.596                                                                      
 -0.277  0.082                                                               
 -0.351 -0.685 -0.659                                                        
                                                                             
                                                                             
                                                                             
                                                                             
                                                                             
 -0.367                                                                      
  0.274 -0.480                                                               
 -0.121 -0.368  0.562                                                        
 -0.776  0.413 -0.618 -0.175                                                 
 -0.554  0.235 -0.375 -0.238  0.187                                          
  0.760 -0.210  0.423  0.343 -0.850 -0.329                                   
 -0.151  0.358 -0.856 -0.703  0.367  0.491 -0.423                            
  0.721 -0.311  0.426  0.277 -0.936 -0.096  0.935 -0.265                     
 -0.740  0.375 -0.616 -0.230  0.993  0.172 -0.857  0.355 -0.950              
 -0.683  0.362 -0.453 -0.376  0.903  0.153 -0.885  0.251 -0.972  0.936       
  0.511 -0.260  0.692  0.443 -0.904 -0.064  0.862 -0.559  0.904 -0.919 -0.862
                                                                             </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace factor with indicator variables in RES</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="st">"./fits/model2.rda"</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(f2)){</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  model2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">+</span>    tm<span class="sc">*</span>bl<span class="sc">*</span>sw<span class="sc">||</span>Subj) <span class="sc">+</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">+</span> gr<span class="sc">*</span>tm<span class="sc">*</span>bl<span class="sc">*</span>sw<span class="sc">||</span>Item), </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save</span>(model2, <span class="at">file=</span>f2)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="fu">load</span>(f2)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model2))  <span class="co"># Still overparameterized for Subj and Item</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]   [,3]    [,4]    [,5]    [,6]   [,7]
Standard deviation     0.6438 0.4638 0.3583 0.22459 0.20771 0.20340 0.1789
Proportion of Variance 0.4481 0.2326 0.1388 0.05454 0.04665 0.04473 0.0346
Cumulative Proportion  0.4481 0.6807 0.8195 0.87401 0.92066 0.96540 1.0000
                            [,8]
Standard deviation     1.109e-05
Proportion of Variance 0.000e+00
Cumulative Proportion  1.000e+00

$Item
Importance of components:
                         [,1]   [,2]    [,3]    [,4]    [,5]    [,6]    [,7]
Standard deviation     0.1322 0.1245 0.08653 0.08049 0.05687 0.04670 0.04073
Proportion of Variance 0.3207 0.2846 0.13744 0.11893 0.05936 0.04004 0.03045
Cumulative Proportion  0.3207 0.6052 0.74269 0.86162 0.92098 0.96102 0.99147
                          [,8]     [,9]     [,10]     [,11] [,12] [,13] [,14]
Standard deviation     0.02133 0.003111 0.0001934 2.714e-05     0     0     0
Proportion of Variance 0.00835 0.000180 0.0000000 0.000e+00     0     0     0
Cumulative Proportion  0.99982 1.000000 1.0000000 1.000e+00     1     1     1
                       [,15] [,16]
Standard deviation         0     0
Proportion of Variance     0     0
Cumulative Proportion      1     1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev.  
 Subj     (Intercept) 1.7362e-01
 Subj.1   tm          1.3413e-01
 Subj.2   bl          7.7763e-02
 Subj.3   sw          6.6971e-02
 Subj.4   tm:bl       2.4101e-01
 Subj.5   tm:sw       4.1517e-06
 Subj.6   bl:sw       7.6147e-02
 Subj.7   tm:bl:sw    8.4081e-02
 Item     (Intercept) 2.1290e-02
 Item.1   gr          0.0000e+00
 Item.2   tm          0.0000e+00
 Item.3   bl          3.2394e-02
 Item.4   sw          7.9846e-03
 Item.5   gr:tm       0.0000e+00
 Item.6   gr:bl       1.7484e-02
 Item.7   tm:bl       3.0134e-02
 Item.8   gr:sw       0.0000e+00
 Item.9   tm:sw       0.0000e+00
 Item.10  bl:sw       4.9481e-02
 Item.11  gr:tm:bl    1.0159e-05
 Item.12  gr:tm:sw    1.5249e-02
 Item.13  gr:bl:sw    7.2407e-05
 Item.14  tm:bl:sw    4.6614e-02
 Item.15  gr:tm:bl:sw 1.1647e-03
 Residual             3.7438e-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model2, model1)   <span class="co"># nothing lost, but anova() is questionable for overparameterized models</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dat
Models:
model2: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj) + (0 + tm:bl | Subj) + (0 + tm:sw | Subj) + (0 + bl:sw | Subj) + (0 + tm:bl:sw | Subj)) + ((1 | Item) + (0 + gr | Item) + (0 + tm | Item) + (0 + bl | Item) + (0 + sw | Item) + (0 + gr:tm | Item) + (0 + gr:bl | Item) + (0 + tm:bl | Item) + (0 + gr:sw | Item) + (0 + tm:sw | Item) + (0 + bl:sw | Item) + (0 + gr:tm:bl | Item) + (0 + gr:tm:sw | Item) + (0 + gr:bl:sw | Item) + (0 + tm:bl:sw | Item) +      (0 + gr:tm:bl:sw | Item))
model1: speed ~ 1 + Group * Time * Block * Switch + (1 + Time * Block * Switch | Subj) + (1 + Group * Time * Block * Switch | Item)
       npar   AIC   BIC  logLik deviance  Chisq  Df Pr(&gt;Chisq)
model2   41 10893 11195 -5405.4    10811                      
model1  189 11061 12455 -5341.7    10683 127.56 148     0.8866</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RK: model3 is nested under model1, not model2</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="st">"./fits/model3.rda"</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(f3)){</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  model3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">+</span>       Time<span class="sc">+</span>Block<span class="sc">+</span>Switch<span class="sc">|</span>Subj) <span class="sc">+</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">+</span>Time<span class="sc">+</span>Block<span class="sc">+</span>Switch<span class="sc">|</span>Item), </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save</span>(model3, <span class="at">file=</span>f3)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="fu">load</span>(f3)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model3)) <span class="co"># Still overparameterized for Item</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]   [,3]    [,4]
Standard deviation     0.5202 0.3938 0.1868 0.13634
Proportion of Variance 0.5647 0.3237 0.0728 0.03879
Cumulative Proportion  0.5647 0.8884 0.9612 1.00000

$Item
Importance of components:
                         [,1]    [,2]      [,3]      [,4] [,5]
Standard deviation     0.1107 0.07231 9.347e-05 1.899e-05    0
Proportion of Variance 0.7009 0.29907 0.000e+00 0.000e+00    0
Cumulative Proportion  0.7009 1.00000 1.000e+00 1.000e+00    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev.  Corr                       
 Subj     (Intercept) 0.1760629                            
          Time2       0.1367871 -0.370                     
          Block1      0.1233587  0.119 -0.767              
          Switch1     0.0670116 -0.050  0.157  0.023       
 Item     (Intercept) 0.0300280                            
          Group2      0.0060932 -1.000                     
          Time2       0.0140124 -0.886  0.886              
          Block1      0.0343352 -0.296  0.296  0.705       
          Switch1     0.0147804  0.504 -0.504 -0.847 -0.974
 Residual             0.3805931                            </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model3, model1)  <span class="co"># looks like we are losing information</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dat
Models:
model3: speed ~ 1 + Group * Time * Block * Switch + (1 + Time + Block + Switch | Subj) + (1 + Group + Time + Block + Switch | Item)
model1: speed ~ 1 + Group * Time * Block * Switch + (1 + Time * Block * Switch | Subj) + (1 + Group * Time * Block * Switch | Item)
       npar   AIC   BIC  logLik deviance Chisq  Df Pr(&gt;Chisq)    
model3   42 11130 11440 -5523.3    11046                         
model1  189 11061 12455 -5341.7    10683 363.2 147  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RK: model4 is nested under model1 and model2. Need indicator variables!</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">+</span>    tm<span class="sc">+</span>bl<span class="sc">+</span>sw<span class="sc">||</span>Subj) <span class="sc">+</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">+</span> gr<span class="sc">+</span>tm<span class="sc">+</span>bl<span class="sc">+</span>sw<span class="sc">||</span>Item), </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model4)) <span class="co"># Still overparameterized for Item</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]   [,3]    [,4]
Standard deviation     0.4560 0.3540 0.3242 0.17603
Proportion of Variance 0.4431 0.2669 0.2239 0.06602
Cumulative Proportion  0.4431 0.7100 0.9340 1.00000

$Item
Importance of components:
                          [,1]    [,2]    [,3]     [,4] [,5]
Standard deviation     0.08934 0.05516 0.02785 1.94e-05    0
Proportion of Variance 0.67642 0.25783 0.06576 0.00e+00    0
Cumulative Proportion  0.67642 0.93424 1.00000 1.00e+00    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev.  
 Subj     (Intercept) 1.7364e-01
 Subj.1   tm          1.3477e-01
 Subj.2   bl          1.2344e-01
 Subj.3   sw          6.7024e-02
 Item     (Intercept) 2.1001e-02
 Item.1   gr          7.3869e-06
 Item.2   tm          0.0000e+00
 Item.3   bl          3.4015e-02
 Item.4   sw          1.0606e-02
 Residual             3.8075e-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model4, model1)  <span class="co"># loss of information</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dat
Models:
model4: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj)) + ((1 | Item) + (0 + gr | Item) + (0 + tm | Item) + (0 + bl | Item) + (0 + sw | Item))
model1: speed ~ 1 + Group * Time * Block * Switch + (1 + Time * Block * Switch | Subj) + (1 + Group * Time * Block * Switch | Item)
       npar   AIC   BIC  logLik deviance  Chisq  Df Pr(&gt;Chisq)    
model4   26 11138 11330 -5543.2    11086                          
model1  189 11061 12455 -5341.7    10683 403.09 163  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model4, model2)  <span class="co"># loss of information</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dat
Models:
model4: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj)) + ((1 | Item) + (0 + gr | Item) + (0 + tm | Item) + (0 + bl | Item) + (0 + sw | Item))
model2: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj) + (0 + tm:bl | Subj) + (0 + tm:sw | Subj) + (0 + bl:sw | Subj) + (0 + tm:bl:sw | Subj)) + ((1 | Item) + (0 + gr | Item) + (0 + tm | Item) + (0 + bl | Item) + (0 + sw | Item) + (0 + gr:tm | Item) + (0 + gr:bl | Item) + (0 + tm:bl | Item) + (0 + gr:sw | Item) + (0 + tm:sw | Item) + (0 + bl:sw | Item) + (0 + gr:tm:bl | Item) + (0 + gr:tm:sw | Item) + (0 + gr:bl:sw | Item) + (0 + tm:bl:sw | Item) +      (0 + gr:tm:bl:sw | Item))
       npar   AIC   BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
model4   26 11138 11330 -5543.2    11086                         
model2   41 10893 11195 -5405.4    10811 275.53 15  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RK: model5 is nested under model1</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>model5 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span>       Time<span class="sc">*</span>Block<span class="sc">*</span>Switch<span class="sc">|</span>Subj) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Item), </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model5)) <span class="co"># Still overparameterized for Subj</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]   [,3]    [,4]   [,5]    [,6]    [,7]
Standard deviation     0.7823 0.4970 0.4001 0.19581 0.1729 0.10144 0.07501
Proportion of Variance 0.5547 0.2240 0.1451 0.03475 0.0271 0.00933 0.00510
Cumulative Proportion  0.5547 0.7786 0.9237 0.95847 0.9856 0.99490 1.00000
                            [,8]
Standard deviation     8.059e-06
Proportion of Variance 0.000e+00
Cumulative Proportion  1.000e+00

$Item
Importance of components:
                          [,1]
Standard deviation     0.05655
Proportion of Variance 1.00000
Cumulative Proportion  1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name                 Std.Dev. Corr                              
 Subj     (Intercept)          0.176308                                   
          Time2                0.136569 -0.372                            
          Block1               0.080339 -0.254  0.083                     
          Switch1              0.067402 -0.127  0.330 -0.255              
          Time2:Block1         0.251496  0.280 -0.815 -0.335  0.078       
          Time2:Switch1        0.029706  0.320 -0.723 -0.189 -0.136  0.550
          Block1:Switch1       0.103763 -0.256  0.029  0.646 -0.203 -0.288
          Time2:Block1:Switch1 0.139262  0.133  0.612 -0.258  0.438 -0.348
 Item     (Intercept)          0.021201                                   
 Residual                      0.374870                                   
              
              
              
              
              
              
              
  0.027       
 -0.657 -0.634
              
              </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model5, model1)  <span class="co"># loss of information</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dat
Models:
model5: speed ~ 1 + Group * Time * Block * Switch + (1 + Time * Block * Switch | Subj) + (1 | Item)
model1: speed ~ 1 + Group * Time * Block * Switch + (1 + Time * Block * Switch | Subj) + (1 + Group * Time * Block * Switch | Item)
       npar   AIC   BIC  logLik deviance  Chisq  Df Pr(&gt;Chisq)
model5   54 10853 11251 -5372.4    10745                      
model1  189 11061 12455 -5341.7    10683 61.553 135          1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RK: model6 is nested under model2. Need indicator variables!</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>model6 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> tm<span class="sc">*</span>bl<span class="sc">*</span>sw<span class="sc">||</span>Subj) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Item), </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model6))  <span class="co"># Still overparameterized for Subj</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]   [,3]   [,4]    [,5]    [,6]    [,7]
Standard deviation     0.6411 0.4629 0.3572 0.2321 0.20620 0.19928 0.17866
Proportion of Variance 0.4463 0.2327 0.1386 0.0585 0.04617 0.04312 0.03466
Cumulative Proportion  0.4463 0.6790 0.8175 0.8761 0.92222 0.96534 1.00000
                            [,8]
Standard deviation     0.0003795
Proportion of Variance 0.0000000
Cumulative Proportion  1.0000000

$Item
Importance of components:
                          [,1]
Standard deviation     0.05681
Proportion of Variance 1.00000
Cumulative Proportion  1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev.  
 Subj     (Intercept) 0.17370466
 Subj.1   tm          0.13404300
 Subj.2   bl          0.07737078
 Subj.3   sw          0.06703647
 Subj.4   tm:bl       0.24055688
 Subj.5   tm:sw       0.00014238
 Subj.6   bl:sw       0.07477324
 Subj.7   tm:bl:sw    0.08709669
 Item     (Intercept) 0.02131672
 Residual             0.37521649</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model6, model2)   <span class="co"># No loss of information with removing item-related VCs (except for GM)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dat
Models:
model6: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj) + (0 + tm:bl | Subj) + (0 + tm:sw | Subj) + (0 + bl:sw | Subj) + (0 + tm:bl:sw | Subj)) + (1 | Item)
model2: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj) + (0 + tm:bl | Subj) + (0 + tm:sw | Subj) + (0 + bl:sw | Subj) + (0 + tm:bl:sw | Subj)) + ((1 | Item) + (0 + gr | Item) + (0 + tm | Item) + (0 + bl | Item) + (0 + sw | Item) + (0 + gr:tm | Item) + (0 + gr:bl | Item) + (0 + tm:bl | Item) + (0 + gr:sw | Item) + (0 + tm:sw | Item) + (0 + bl:sw | Item) + (0 + gr:tm:bl | Item) + (0 + gr:tm:sw | Item) + (0 + gr:bl:sw | Item) + (0 + tm:bl:sw | Item) +      (0 + gr:tm:bl:sw | Item))
       npar   AIC   BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
model6   26 10876 11068 -5412.2    10824                     
model2   41 10893 11195 -5405.4    10811 13.443 15     0.5681</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RK: model7 is nested under model5</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>model7 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                     (<span class="dv">1</span> <span class="sc">+</span> Time<span class="sc">+</span>Block<span class="sc">+</span>Switch<span class="sc">|</span>Subj) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Item), </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model7))  <span class="co"># looking good, but ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]    [,3]    [,4]
Standard deviation     0.5192 0.3930 0.18693 0.13491
Proportion of Variance 0.5649 0.3237 0.07323 0.03814
Cumulative Proportion  0.5649 0.8886 0.96186 1.00000

$Item
Importance of components:
                          [,1]
Standard deviation     0.05499
Proportion of Variance 1.00000
Cumulative Proportion  1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev. Corr                
 Subj     (Intercept) 0.175990                     
          Time2       0.136619 -0.370              
          Block1      0.123200  0.119 -0.768       
          Switch1     0.067065 -0.052  0.160  0.025
 Item     (Intercept) 0.020960                     
 Residual             0.381140                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model7, model5, model1)  <span class="co"># much loss of information</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dat
Models:
model7: speed ~ 1 + Group * Time * Block * Switch + (1 + Time + Block + Switch | Subj) + (1 | Item)
model5: speed ~ 1 + Group * Time * Block * Switch + (1 + Time * Block * Switch | Subj) + (1 | Item)
model1: speed ~ 1 + Group * Time * Block * Switch + (1 + Time * Block * Switch | Subj) + (1 + Group * Time * Block * Switch | Item)
       npar   AIC   BIC  logLik deviance   Chisq  Df Pr(&gt;Chisq)    
model7   28 11117 11323 -5530.5    11061                           
model5   54 10853 11251 -5372.4    10745 316.048  26     &lt;2e-16 ***
model1  189 11061 12455 -5341.7    10683  61.553 135          1    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RK: model8 is nested under model6. Need indicator variables!</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>model8 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> tm<span class="sc">+</span>bl<span class="sc">+</span>sw<span class="sc">||</span>Subj) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Item), </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model8))  <span class="co"># looking good, but ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]   [,3]    [,4]
Standard deviation     0.4554 0.3533 0.3236 0.17584
Proportion of Variance 0.4433 0.2668 0.2238 0.06608
Cumulative Proportion  0.4433 0.7101 0.9339 1.00000

$Item
Importance of components:
                          [,1]
Standard deviation     0.05499
Proportion of Variance 1.00000
Cumulative Proportion  1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev.
 Subj     (Intercept) 0.173582
 Subj.1   tm          0.134673
 Subj.2   bl          0.123354
 Subj.3   sw          0.067023
 Item     (Intercept) 0.020959
 Residual             0.381157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model8, model6, model2) <span class="co"># ... loss of information with removal of Subj-related interaction VCs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dat
Models:
model8: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj)) + (1 | Item)
model6: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj) + (0 + tm:bl | Subj) + (0 + tm:sw | Subj) + (0 + bl:sw | Subj) + (0 + tm:bl:sw | Subj)) + (1 | Item)
model2: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj) + (0 + tm:bl | Subj) + (0 + tm:sw | Subj) + (0 + bl:sw | Subj) + (0 + tm:bl:sw | Subj)) + ((1 | Item) + (0 + gr | Item) + (0 + tm | Item) + (0 + bl | Item) + (0 + sw | Item) + (0 + gr:tm | Item) + (0 + gr:bl | Item) + (0 + tm:bl | Item) + (0 + gr:sw | Item) + (0 + tm:sw | Item) + (0 + bl:sw | Item) + (0 + gr:tm:bl | Item) + (0 + gr:tm:sw | Item) + (0 + gr:bl:sw | Item) + (0 + tm:bl:sw | Item) +      (0 + gr:tm:bl:sw | Item))
       npar   AIC   BIC  logLik deviance   Chisq Df Pr(&gt;Chisq)    
model8   22 11138 11300 -5547.1    11094                          
model6   26 10876 11068 -5412.2    10824 269.891  4     &lt;2e-16 ***
model2   41 10893 11195 -5405.4    10811  13.443 15     0.5681    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RK: model 9 is nester under model8. Need indicator variables!</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>model9 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> tm<span class="sc">+</span>sw<span class="sc">||</span>Subj) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Item), </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model9))  <span class="co"># looking good, but ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]    [,3]
Standard deviation     0.4495 0.3491 0.17176
Proportion of Variance 0.5717 0.3448 0.08347
Cumulative Proportion  0.5717 0.9165 1.00000

$Item
Importance of components:
                          [,1]
Standard deviation     0.05358
Proportion of Variance 1.00000
Cumulative Proportion  1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev.
 Subj     (Intercept) 0.173581
 Subj.1   tm          0.134808
 Subj.2   sw          0.066325
 Item     (Intercept) 0.020690
 Residual             0.386154</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model9, model8, model6, model2) <span class="co"># ... there is reliable Subj-related VC for Block</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dat
Models:
model9: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + sw | Subj)) + (1 | Item)
model8: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj)) + (1 | Item)
model6: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj) + (0 + tm:bl | Subj) + (0 + tm:sw | Subj) + (0 + bl:sw | Subj) + (0 + tm:bl:sw | Subj)) + (1 | Item)
model2: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj) + (0 + tm:bl | Subj) + (0 + tm:sw | Subj) + (0 + bl:sw | Subj) + (0 + tm:bl:sw | Subj)) + ((1 | Item) + (0 + gr | Item) + (0 + tm | Item) + (0 + bl | Item) + (0 + sw | Item) + (0 + gr:tm | Item) + (0 + gr:bl | Item) + (0 + tm:bl | Item) + (0 + gr:sw | Item) + (0 + tm:sw | Item) + (0 + bl:sw | Item) + (0 + gr:tm:bl | Item) + (0 + gr:tm:sw | Item) + (0 + gr:bl:sw | Item) + (0 + tm:bl:sw | Item) +      (0 + gr:tm:bl:sw | Item))
       npar   AIC   BIC  logLik deviance   Chisq Df Pr(&gt;Chisq)    
model9   21 11355 11510 -5656.6    11313                          
model8   22 11138 11300 -5547.1    11094 219.027  1     &lt;2e-16 ***
model6   26 10876 11068 -5412.2    10824 269.891  4     &lt;2e-16 ***
model2   41 10893 11195 -5405.4    10811  13.443 15     0.5681    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RK: model10 is nested under model9. Need indicator variables!</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>model10 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                       (<span class="dv">1</span> <span class="sc">+</span> tm<span class="sc">||</span>Subj) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Item),</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>) )</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model10))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]
Standard deviation     0.4483 0.3478
Proportion of Variance 0.6242 0.3758
Cumulative Proportion  0.6242 1.0000

$Item
Importance of components:
                          [,1]
Standard deviation     0.05382
Proportion of Variance 1.00000
Cumulative Proportion  1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev.
 Subj     (Intercept) 0.173744
 Subj.1   tm          0.134813
 Item     (Intercept) 0.020858
 Residual             0.387566</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model10, model9, model8, model6, model2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dat
Models:
model10: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj)) + (1 | Item)
model9: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + sw | Subj)) + (1 | Item)
model8: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj)) + (1 | Item)
model6: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj) + (0 + tm:bl | Subj) + (0 + tm:sw | Subj) + (0 + bl:sw | Subj) + (0 + tm:bl:sw | Subj)) + (1 | Item)
model2: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj) + (0 + bl | Subj) + (0 + sw | Subj) + (0 + tm:bl | Subj) + (0 + tm:sw | Subj) + (0 + bl:sw | Subj) + (0 + tm:bl:sw | Subj)) + ((1 | Item) + (0 + gr | Item) + (0 + tm | Item) + (0 + bl | Item) + (0 + sw | Item) + (0 + gr:tm | Item) + (0 + gr:bl | Item) + (0 + tm:bl | Item) + (0 + gr:sw | Item) + (0 + tm:sw | Item) + (0 + bl:sw | Item) + (0 + gr:tm:bl | Item) + (0 + gr:tm:sw | Item) + (0 + gr:bl:sw | Item) + (0 + tm:bl:sw | Item) +      (0 + gr:tm:bl:sw | Item))
        npar   AIC   BIC  logLik deviance   Chisq Df Pr(&gt;Chisq)    
model10   20 11394 11541 -5677.0    11354                          
model9    21 11355 11510 -5656.6    11313  40.672  1    1.8e-10 ***
model8    22 11138 11300 -5547.1    11094 219.027  1    &lt; 2e-16 ***
model6    26 10876 11068 -5412.2    10824 269.891  4    &lt; 2e-16 ***
model2    41 10893 11195 -5405.4    10811  13.443 15     0.5681    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ... there is reliable Subj-related VC for Switch</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># RK: model11 is above model10. Need indicator variables!</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>model11 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> tm<span class="sc">||</span>Subj) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> tm<span class="sc">||</span>Item),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model11)) <span class="co"># overparameterized</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]
Standard deviation     0.4483 0.3478
Proportion of Variance 0.6242 0.3758
Cumulative Proportion  0.6242 1.0000

$Item
Importance of components:
                          [,1] [,2]
Standard deviation     0.05382    0
Proportion of Variance 1.00000    0
Cumulative Proportion  1.00000    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model11)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev.
 Subj     (Intercept) 0.173748
 Subj.1   tm          0.134807
 Item     (Intercept) 0.020859
 Item.1   tm          0.000000
 Residual             0.387566</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model10, model11) <span class="co"># No evidence for Item-related VC for Time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dat
Models:
model10: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj)) + (1 | Item)
model11: speed ~ 1 + Group * Time * Block * Switch + ((1 | Subj) + (0 + tm | Subj)) + ((1 | Item) + (0 + tm | Item))
        npar   AIC   BIC logLik deviance Chisq Df Pr(&gt;Chisq)
model10   20 11394 11541  -5677    11354                    
model11   21 11396 11551  -5677    11354     0  1          1</code></pre>
</div>
</div>
</section>
<section id="minimal-model-works" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="minimal-model-works"><span class="header-section-number">7.3</span> Minimal model works</h2>
<p>RK: As shown above, many other models also converge! Some of them were discarded due to false positive convergence errors with default setting of <code>control=lmerControl(calc.derivs=TRUE)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>model12 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subj) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Item), </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model12))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]
Standard deviation     0.4157
Proportion of Variance 1.0000
Cumulative Proportion  1.0000

$Item
Importance of components:
                          [,1]
Standard deviation     0.05205
Proportion of Variance 1.00000
Cumulative Proportion  1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev.
 Subj     (Intercept) 0.163644
 Item     (Intercept) 0.020488
 Residual             0.393624</code></pre>
</div>
</div>
<p>AC: Surprisingly, this one also works (same as <code>model7</code>, but with different order of factors):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>model13 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Switch<span class="sc">*</span>Block <span class="sc">+</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                       (<span class="dv">1</span> <span class="sc">+</span> Time<span class="sc">+</span>Switch<span class="sc">+</span>Block<span class="sc">|</span>Subj) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Item), </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(model13))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]    [,3]    [,4]
Standard deviation     0.5191 0.3930 0.18688 0.13493
Proportion of Variance 0.5649 0.3238 0.07321 0.03816
Cumulative Proportion  0.5649 0.8886 0.96184 1.00000

$Item
Importance of components:
                          [,1]
Standard deviation     0.05497
Proportion of Variance 1.00000
Cumulative Proportion  1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev. Corr                
 Subj     (Intercept) 0.175975                     
          Time2       0.136613 -0.370              
          Switch1     0.067048 -0.052  0.161       
          Block1      0.123195  0.119 -0.768  0.025
 Item     (Intercept) 0.020951                     
 Residual             0.381140                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model13))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood  ['lmerMod']
Formula: speed ~ 1 + Group * Time * Switch * Block + (1 + Time + Switch +  
    Block | Subj) + (1 | Item)
   Data: dat
Control: lmerControl(calc.derivs = FALSE)

     AIC      BIC   logLik deviance df.resid 
 11116.9  11323.4  -5530.5  11060.9    11741 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.9956 -0.6391  0.0143  0.6817  3.7502 

Random effects:
 Groups   Name        Variance  Std.Dev. Corr             
 Subj     (Intercept) 0.0309672 0.17598                   
          Time2       0.0186630 0.13661  -0.37            
          Switch1     0.0044955 0.06705  -0.05  0.16      
          Block1      0.0151770 0.12319   0.12 -0.77  0.02
 Item     (Intercept) 0.0004389 0.02095                   
 Residual             0.1452677 0.38114                   
Number of obs: 11769, groups:  Subj, 38; Item, 20

Fixed effects:
                             Estimate Std. Error t value
(Intercept)                  1.421067   0.041252  34.448
Group2                       0.058149   0.057958   1.003
Time2                        0.043927   0.032899   1.335
Switch1                     -0.398428   0.020889 -19.073
Block1                      -0.279961   0.031592  -8.862
Group2:Time2                -0.189745   0.046517  -4.079
Group2:Switch1               0.021271   0.029511   0.721
Time2:Switch1               -0.004223   0.020011  -0.211
Group2:Block1               -0.003972   0.044660  -0.089
Time2:Block1                 0.022783   0.019986   1.140
Switch1:Block1              -0.260199   0.028239  -9.214
Group2:Time2:Switch1         0.059655   0.028242   2.112
Group2:Time2:Block1          0.500590   0.028214  17.743
Group2:Switch1:Block1        0.046294   0.039867   1.161
Time2:Switch1:Block1         0.039553   0.039989   0.989
Group2:Time2:Switch1:Block1 -0.122949   0.056450  -2.178</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 16 &gt; 12.
Use print(summary(model13), correlation=TRUE)  or
    vcov(summary(model13))        if you need it</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model7, model13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dat
Models:
model7: speed ~ 1 + Group * Time * Block * Switch + (1 + Time + Block + Switch | Subj) + (1 | Item)
model13: speed ~ 1 + Group * Time * Switch * Block + (1 + Time + Switch + Block | Subj) + (1 | Item)
        npar   AIC   BIC  logLik deviance Chisq Df Pr(&gt;Chisq)
model7    28 11117 11323 -5530.5    11061                    
model13   28 11117 11323 -5530.5    11061     0  0           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(model7, model13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter                         |                   model7 |                  model13
---------------------------------------------------------------------------------------
(Intercept)                       |      1.42 ( 1.34,  1.50) |      1.42 ( 1.34,  1.50)
Group2                            |      0.06 (-0.06,  0.17) |      0.06 (-0.06,  0.17)
Time2                             |      0.04 (-0.02,  0.11) |      0.04 (-0.02,  0.11)
Block1                            |     -0.28 (-0.34, -0.22) |     -0.28 (-0.34, -0.22)
Switch1                           |     -0.40 (-0.44, -0.36) |     -0.40 (-0.44, -0.36)
Group2 * Time2                    |     -0.19 (-0.28, -0.10) |     -0.19 (-0.28, -0.10)
Group2 * Block1                   | -3.97e-03 (-0.09,  0.08) | -3.97e-03 (-0.09,  0.08)
Time2 * Block1                    |      0.02 (-0.02,  0.06) |      0.02 (-0.02,  0.06)
Group2 * Switch1                  |      0.02 (-0.04,  0.08) |      0.02 (-0.04,  0.08)
Time2 * Switch1                   | -4.22e-03 (-0.04,  0.04) | -4.22e-03 (-0.04,  0.04)
Group2 * Time2 * Block1           |      0.50 ( 0.45,  0.56) |      0.50 ( 0.45,  0.56)
Group2 * Time2 * Switch1          |      0.06 ( 0.00,  0.12) |      0.06 ( 0.00,  0.12)
Group2 * Block1 * Switch1         |      0.05 (-0.03,  0.12) |                         
Block1 * Switch1                  |     -0.26 (-0.32, -0.20) |                         
Group2 * Time2 * Block1 * Switch1 |     -0.12 (-0.23, -0.01) |                         
Time2 * Block1 * Switch1          |      0.04 (-0.04,  0.12) |                         
Group2 * Switch1 * Block1         |                          |      0.05 (-0.03,  0.12)
Switch1 * Block1                  |                          |     -0.26 (-0.32, -0.20)
Group2 * Time2 * Switch1 * Block1 |                          |     -0.12 (-0.23, -0.01)
Time2 * Switch1 * Block1          |                          |      0.04 (-0.04,  0.12)
---------------------------------------------------------------------------------------
Observations                      |                    11769 |                    11769</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev. Corr                
 Subj     (Intercept) 0.175990                     
          Time2       0.136619 -0.370              
          Block1      0.123200  0.119 -0.768       
          Switch1     0.067065 -0.052  0.160  0.025
 Item     (Intercept) 0.020960                     
 Residual             0.381140                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev. Corr                
 Subj     (Intercept) 0.175975                     
          Time2       0.136613 -0.370              
          Switch1     0.067048 -0.052  0.161       
          Block1      0.123195  0.119 -0.768  0.025
 Item     (Intercept) 0.020951                     
 Residual             0.381140                     </code></pre>
</div>
</div>
<p>RK: There is no difference due to different order of factors here. The problem in original code was perhaps the false-positive convergence error that is no longer present in <code>model7</code> with <code>control=lmerControl(calc.derivs=FALSE)</code>.</p>
</section>
<section id="regression-diagnostics-for-model13" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="regression-diagnostics-for-model13"><span class="header-section-number">7.4</span> Regression diagnostics for model13</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">resid</span>(model13))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(<span class="fu">resid</span>(model13))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="768"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10623  8968</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x=</span><span class="fu">fitted</span>(model13), <span class="at">y=</span><span class="fu">resid</span>(model13), <span class="at">geom=</span><span class="st">"point"</span>,  <span class="at">shape=</span><span class="fu">I</span>(<span class="st">"."</span>), </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab=</span><span class="st">"Fitted values"</span>, <span class="at">ylab=</span><span class="st">"Standardized residuals"</span>) <span class="sc">+</span> </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_hex</span>() <span class="sc">+</span> <span class="fu">geom_density2d</span>(<span class="at">size=</span><span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Computation failed in `stat_binhex()`:</code></pre>
</div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
</section>
<section id="rks-proposal" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> RK’s proposal</h1>
<section id="contrasts-and-indicator-variables" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="contrasts-and-indicator-variables"><span class="header-section-number">8.1</span> Contrasts and indicator variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Group)   <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Time)    <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Block)   <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Switch)  <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Task)    <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Valence) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>mm <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> Task<span class="sc">*</span>Valence, <span class="at">data=</span>dat)</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> mm[,<span class="dv">2</span>]</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>tm <span class="ot">&lt;-</span> mm[,<span class="dv">3</span>]</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>bl <span class="ot">&lt;-</span> mm[,<span class="dv">4</span>]</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>sw <span class="ot">&lt;-</span> mm[,<span class="dv">5</span>] </span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>tk <span class="ot">&lt;-</span> mm[,<span class="dv">6</span>]</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> mm[,<span class="dv">7</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-selection" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="model-selection"><span class="header-section-number">8.2</span> Model selection</h2>
<section id="maximal-lmm-m_max" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="maximal-lmm-m_max"><span class="header-section-number">8.2.1</span> Maximal LMM <code>m_max</code></h3>
<p>I use <code>MixedModels.jl</code> in script <code>Cajar_IAT_Julia.qmd</code> to demonstrate model selection starting with a maximal LMM (relative to the experimental design, that is without inclusion of covariates such as trial number, subject age, or items’ frequency), but including also the two item factors <code>Task</code> and <code>Valence</code>.</p>
<pre><code>m_max &lt;- lmer(speed ~  1 + Group*Time*Block*Switch*Task*Valence +
                     (1 +       Time*Block*Switch*Task*Valence | Subj) +  
                     (1 + Group*Time*Block*Switch              | Item),
             data=dat, REML=FALSE, control=lmerControl(calc.derivs=FALSE))</code></pre>
<p>With this model we estimate the maximal number of fixed effects (2^6 = 64 terms) and their corresponding VCs and CPs for <code>Subj</code> and for <code>Item</code> grouping variables, that is we estimate variance components (VCs) and correlation parameters (CPs) for within-subject factors for <code>Subj</code> (i.e., 2^5 = 32 VCs and 32 x 31 /2 = 496 CPs) and for within-item factors for <code>Item</code> (i.e., 2^4 = 16 VCs and 16 x 15 /2 = 120 CPs), plus the observation-level residual variance. Thus, 64+(32+496)+(16+120)+1=729 model parameters are estimated from 11679 observations. Given 38 subjects and 20 items, there are also 38 subject x 32 parameters + 20 items x 16 parameters = 1536 conditional means of the random effects for the two random factors.</p>
<p>I was not able to fit this LMM with <code>lme4::lmer()</code>.</p>
</section>
<section id="selected-lmm-m1" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="selected-lmm-m1"><span class="header-section-number">8.2.2</span> Selected LMM <code>m1</code></h3>
<p>Model selection led to the model refit here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>f_m1 <span class="ot">&lt;-</span> <span class="st">"./fits/m1.rda"</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(f_m1)){</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> gr<span class="sc">*</span>tm<span class="sc">*</span>bl<span class="sc">*</span>sw <span class="sc">+</span> tk<span class="sc">*</span>vc <span class="sc">+</span> </span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>                    (<span class="dv">1</span> <span class="sc">+</span>    tm<span class="sc">+</span>bl<span class="sc">+</span>tm<span class="sc">:</span>bl <span class="sc">|</span>Subj) <span class="sc">+</span> </span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>                    (<span class="dv">0</span><span class="sc">+</span>sw<span class="sc">+</span>tk<span class="sc">+</span>vc <span class="sc">+</span> tm<span class="sc">:</span>vc <span class="sc">+</span> bl<span class="sc">:</span>sw <span class="sc">+</span> bl<span class="sc">:</span>vc  <span class="sc">||</span> Subj) <span class="sc">+</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>                    (<span class="dv">1</span> <span class="sc">+</span> bl <span class="sc">||</span> Item), </span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save</span>(m1, <span class="at">file=</span>f_m1)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">load</span>(f_m1)</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(m1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]    [,3]    [,4]    [,5]    [,6]    [,7]
Standard deviation     0.4445 0.2771 0.10119 0.08645 0.08299 0.08198 0.07486
Proportion of Variance 0.6106 0.2372 0.03164 0.02309 0.02128 0.02076 0.01731
Cumulative Proportion  0.6106 0.8477 0.87938 0.90247 0.92375 0.94451 0.96183
                          [,8]    [,9]   [,10]
Standard deviation     0.07157 0.06322 0.05689
Proportion of Variance 0.01583 0.01235 0.01000
Cumulative Proportion  0.97765 0.99000 1.00000

$Item
Importance of components:
                          [,1]    [,2]
Standard deviation     0.05471 0.04378
Proportion of Variance 0.60971 0.39029
Cumulative Proportion  0.60971 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(m1), <span class="at">cor=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood  ['lmerMod']
Formula: speed ~ 1 + gr * tm * bl * sw + tk * vc + (1 + tm + bl + tm:bl |  
    Subj) + ((0 + sw | Subj) + (0 + tk | Subj) + (0 + vc | Subj) +  
    (0 + vc:tm | Subj) + (0 + sw:bl | Subj) + (0 + vc:bl | Subj)) +  
    ((1 | Item) + (0 + bl | Item))
   Data: dat
Control: lmerControl(calc.derivs = FALSE)

     AIC      BIC   logLik deviance df.resid 
 10711.0  10991.2  -5317.5  10635.0    11731 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.1861 -0.6266  0.0077  0.6757  3.8008 

Random effects:
 Groups   Name        Variance  Std.Dev. Corr             
 Subj     (Intercept) 0.0268745 0.16393                   
          tm          0.0046554 0.06823  -0.02            
          bl          0.0038563 0.06210   0.20 -0.77      
          tm:bl       0.0039016 0.06246  -0.03  0.81 -0.78
 Subj.1   sw          0.0010242 0.03200                   
 Subj.2   tk          0.0014032 0.03746                   
 Subj.3   vc          0.0009437 0.03072                   
 Subj.4   vc:tm       0.0005476 0.02340                   
 Subj.5   sw:bl       0.0004435 0.02106                   
 Subj.6   vc:bl       0.0007020 0.02649                   
 Item     (Intercept) 0.0004102 0.02025                   
 Item.1   bl          0.0002626 0.01620                   
 Residual             0.1370301 0.37018                   
Number of obs: 11769, groups:  Subj, 38; Item, 20

Fixed effects:
             Estimate Std. Error t value
(Intercept)  1.424988   0.027194  52.401
gr           0.018136   0.026814   0.676
tm           0.025280   0.011587   2.182
bl           0.073027   0.011242   6.496
sw           0.188681   0.006232  30.276
tk          -0.007346   0.008313  -0.884
vc           0.004547   0.007554   0.602
gr:tm       -0.047037   0.011587  -4.059
gr:bl        0.061570   0.010642   5.786
tm:bl        0.068324   0.010697   6.387
gr:sw        0.012588   0.006232   2.020
tm:sw        0.006262   0.003441   1.820
bl:sw       -0.062314   0.004852 -12.844
tk:vc        0.003153   0.005676   0.556
gr:tm:bl    -0.062460   0.010697  -5.839
gr:tm:sw    -0.006617   0.003441  -1.923
gr:bl:sw     0.001557   0.004852   0.321
tm:bl:sw     0.002808   0.003442   0.816
gr:tm:bl:sw -0.007893   0.003442  -2.293</code></pre>
</div>
</div>
<p>There is no evidence for fixed efffects of word characteristics on response speed, but there are reliable individual differences associated with them.</p>
</section>
</section>
<section id="diagnostics-for-model-m1" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="diagnostics-for-model-m1"><span class="header-section-number">8.3</span> Diagnostics for model <code>m1</code></h2>
<p>Using an easystats function from the {performance} package.</p>
<div class="cell" data-units="cm">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Could not compute standard errors from random effects for diagnostic
  plot.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>The diagnostics look fine.</p>
</section>
<section id="plot-of-switch-costs-for-speed-scores" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="plot-of-switch-costs-for-speed-scores"><span class="header-section-number">8.4</span> Plot of switch costs for speed scores</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>switch_costs <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Time, Group, Block, Switch)<span class="sc">|&gt;</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">M =</span> <span class="fu">mean</span>(speed), <span class="at">SD=</span><span class="fu">sd</span>(speed), <span class="at">N=</span><span class="fu">n</span>(), <span class="at">SE=</span>SD<span class="sc">/</span><span class="fu">sqrt</span>(N))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Time', 'Group', 'Block'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>fig_speed <span class="ot">&lt;-</span> </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  switch_costs <span class="sc">|&gt;</span> </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Switch, <span class="at">y=</span>M, <span class="at">color=</span>Block)) <span class="sc">+</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.7</span>, <span class="fu">aes</span>(<span class="at">group=</span>Block)) <span class="sc">+</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>M<span class="dv">-2</span><span class="sc">*</span>SE, <span class="at">ymax=</span>M<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>SE), <span class="at">width=</span>.<span class="dv">1</span>, <span class="at">size=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">"Block"</span>, <span class="at">values=</span>cbPalette) <span class="sc">+</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Group<span class="sc">~</span>Time) <span class="sc">+</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Task switch"</span>, <span class="at">y=</span><span class="st">"Response speed [1/s]"</span>) <span class="sc">+</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">13</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="partial-effect-plot" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="partial-effect-plot"><span class="header-section-number">8.5</span> Partial effect plot</h2>
<p>For this you need the {remef} package: https://github.com/hohenstein/remef</p>
<pre><code># install.packages("devtools")
devtools::install_github("hohenstein/remef")</code></pre>
<p>A more recent alternative with more options appears to be the {modelbased} package to compute marginal means. However, I have not worked with the package myself. So I stick with our own package for now.</p>
<div class="cell" data-units="cm">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(remef)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'remef'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:insight':

    has_intercept</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    partial</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>pe_ia <span class="ot">&lt;-</span> <span class="fu">remef</span>(m1, <span class="at">ran=</span><span class="st">"all"</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot partial-effect switch costs </span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>pe_switch_costs <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Time, Group, Block, Switch)<span class="sc">|&gt;</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">M =</span> <span class="fu">mean</span>(pe_ia), <span class="at">SD=</span><span class="fu">sd</span>(pe_ia), <span class="at">N=</span><span class="fu">n</span>(), <span class="at">SE=</span>SD<span class="sc">/</span><span class="fu">sqrt</span>(N))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Time', 'Group', 'Block'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>pe_fig_speed <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pe_switch_costs, <span class="fu">aes</span>(<span class="at">x=</span>Switch, <span class="at">y=</span>M, <span class="at">color=</span>Block)) <span class="sc">+</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.7</span>, <span class="fu">aes</span>(<span class="at">group=</span>Block)) <span class="sc">+</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>M<span class="dv">-2</span><span class="sc">*</span>SE, <span class="at">ymax=</span>M<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>SE), <span class="at">width=</span>.<span class="dv">1</span>, <span class="at">size=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">"Block"</span>, <span class="at">values=</span>cbPalette) <span class="sc">+</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Group<span class="sc">~</span>Time) <span class="sc">+</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Task switch"</span>, <span class="at">y=</span><span class="st">"Partial effects on response speed [1/s]"</span>) <span class="sc">+</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">13</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plots</span>(fig_speed, pe_fig_speed, <span class="at">n_columns=</span><span class="dv">1</span>, <span class="at">tags=</span><span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), </span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">title=</span><span class="st">"Comparison of zero-order (A) and partial effects (B) in response speed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>For typical balanced experimental designs zero-order and partial-effect plots will not differ much. This is much more relevant when correlated covariates and associated interactions are part of the model.</p>
</section>
</section>
<section id="conditional-means-of-random-effects" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Conditional means of random effects</h1>
<p>In this section we examine <em>much under-appreciated</em> information estimated in LMMs, that is predictions based on model parameters for subjects and items (i.e., for units of grouping variables/levels of random factors).</p>
<section id="subject-related-conditional-means-of-random-experimental-effects" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="subject-related-conditional-means-of-random-experimental-effects"><span class="header-section-number">9.1</span> Subject-related conditional means of random experimental effects</h2>
<p>The CP’s suggest that individual differences in <code>Time</code> and <code>Block</code> effects are highly negatively correlated and individual differences in the <code>Time x Block</code> interaction also correlate very highly with individual differences in <code>Time</code> (positive) and <code>Block</code> (negative). Such large correlations of effects are often due to some type of artefact. They are not necessarily a “problem”, but they should be “understood” and therefore be examined in some detail. We can visualize these CPs with caterpillar plots of subjects’ conditional means of random experimental effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>cm_m1 <span class="ot">&lt;-</span> <span class="fu">ranef</span>(m1, <span class="at">drop=</span><span class="cn">TRUE</span>, <span class="at">condVar=</span><span class="cn">TRUE</span>, <span class="at">whichel=</span><span class="st">"Subj"</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>cm_m1 <span class="ot">&lt;-</span> </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(cm_m1) <span class="sc">|&gt;</span> </span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Term=</span>term, <span class="at">Subj=</span>grp) <span class="sc">|&gt;</span> </span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Term =</span> <span class="fu">fct_recode</span>(Term, <span class="at">GM =</span> <span class="st">"(Intercept)"</span>, <span class="at">Time=</span><span class="st">"tm"</span>, <span class="at">Block=</span><span class="st">"bl"</span>,</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Switch=</span><span class="st">"sw"</span>, <span class="at">TxB =</span> <span class="st">"tm:bl"</span>, <span class="at">Task=</span><span class="st">"tk"</span>, <span class="at">Valence=</span><span class="st">"vc"</span>),</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Term =</span> <span class="fu">fct_relevel</span>(Term, <span class="st">"Switch"</span>, <span class="at">after=</span><span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Term <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GM"</span>, <span class="st">"Switch"</span>, <span class="st">"Time"</span>, <span class="st">"Block"</span>, <span class="st">"TxB"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="co"># add subject info</span></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>cm_m1 <span class="ot">&lt;-</span> </span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>  cm_m1 <span class="sc">|&gt;</span> </span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sinfo, <span class="at">by=</span><span class="st">"Subj"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Group, Subj, age, Gender, Term, condval, condsd)</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Default: Subj ordered by GM ...</span></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>cm_m1 <span class="sc">|&gt;</span> </span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>Subj, <span class="at">x=</span>condval, <span class="at">group=</span>Group, <span class="at">color=</span>Group)) <span class="sc">+</span></span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> Term, <span class="at">scales=</span><span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>condval <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>condsd,</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmax=</span>condval <span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>condsd), <span class="at">height=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="st">"Group"</span>, <span class="at">values=</span>cbPalette) <span class="sc">+</span></span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Conditional mean"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Subject"</span>) <span class="sc">+</span></span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Not that much clustering by group is visible in the default ordering by GM. How about when we order by the effect of <code>Time</code>? We also ignore effects associated with <code>Task</code> and <code>Valence</code> for now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subj ordered by ...</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>ord_subj <span class="ot">&lt;-</span> cm_m1 <span class="sc">|&gt;</span> <span class="fu">filter</span>(Term<span class="sc">==</span><span class="st">"Time"</span>) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(condval) <span class="sc">|&gt;</span> <span class="fu">pull</span>(Subj)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check clustering by Group</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>cm_m1 <span class="sc">|&gt;</span> </span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Term <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GM"</span>, <span class="st">"Switch"</span>, <span class="st">"Time"</span>, <span class="st">"Block"</span>, <span class="st">"TxB"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">factor</span>(Subj, <span class="at">levels=</span>ord_subj), <span class="at">x=</span>condval, <span class="at">group=</span>Group, <span class="at">color=</span>Group)) <span class="sc">+</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> Term, <span class="at">scales=</span><span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>condval <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>condsd,</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmax=</span>condval <span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>condsd), <span class="at">height=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="st">"Group"</span>, <span class="at">values=</span>cbPalette) <span class="sc">+</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Conditional mean"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Subject"</span>) <span class="sc">+</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>First, now we can see the correlation parameters in the alignments of orientations of <code>Time</code>, <code>Block</code>, and <code>TxB</code>.</p>
<p>Second, there are clear clustering effects of instruction. The instruction to fake in the retest slowed down a cluster of six subjects <em>beyond</em> the <code>Time</code> main effect. There are also six subjects who were not slowed down as much as expected from the main effect of <code>Time</code>. In other words, the instruction generated much between-subject variance in the faking group.</p>
<p>The same relatively slow subjects show the reverse effect also for the main effect of <code>Block</code>, that is for them the speed difference between incompatible and compatible blocks was especially large or small, respectively. The reverse effect also holds for four of the six relatively fast subjects.</p>
<p>Finally, for the same subsets of clusters of subjects, <code>TxB</code> interaction effect was especially small and large, respectively. The interaction translates into a congruency effect of <code>Block</code> and <code>Switch</code>, that is into the difference between mean of compatible/no-switch and incompatible/switch and mean of compatible/switch and incompatible no switch conditions.</p>
<p>We can also order subject-related <code>Switch</code> costs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subj ordered by ...</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>ord_subj <span class="ot">&lt;-</span> cm_m1 <span class="sc">|&gt;</span> <span class="fu">filter</span>(Term<span class="sc">==</span><span class="st">"Switch"</span>) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(condval) <span class="sc">|&gt;</span> <span class="fu">pull</span>(Subj)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check clustering by Group</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>cm_m1 <span class="sc">|&gt;</span> </span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Term <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GM"</span>, <span class="st">"Switch"</span>, <span class="st">"Time"</span>, <span class="st">"Block"</span>, <span class="st">"TxB"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">factor</span>(Subj, <span class="at">levels=</span>ord_subj), <span class="at">x=</span>condval, <span class="at">group=</span>Group, <span class="at">color=</span>Group)) <span class="sc">+</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> Term, <span class="at">scales=</span><span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>condval <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>condsd,</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmax=</span>condval <span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>condsd), <span class="at">height=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="st">"Group"</span>, <span class="at">values=</span>cbPalette) <span class="sc">+</span></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Conditional mean"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Subject"</span>) <span class="sc">+</span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>In general, the instruction to fake does not reveal a distinct clustering of switch costs by instruction for between-subject differences. One exception might be subject S053 who showed the smallest difference in response speed between switch and no-switch trials relative to the main effect of <code>Switch</code>. This could have resulted from deliberate slowing of no-switch trials.</p>
</section>
<section id="subject-related-conditional-means-of-random-quasi-experimental-effects" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="subject-related-conditional-means-of-random-quasi-experimental-effects"><span class="header-section-number">9.2</span> Subject-related conditional means of random quasi-experimental effects</h2>
<p>Plots of conditional means can also be used to check for potential confounding of clustering related to <code>Gender</code> and <code>age</code>, that is of covariates not included in the LMM.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check clustering by Gender</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>cm_m1 <span class="sc">|&gt;</span> </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Term <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GM"</span>, <span class="st">"Switch"</span>, <span class="st">"Time"</span>, <span class="st">"Block"</span>, <span class="st">"TxB"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">factor</span>(Subj, <span class="at">levels=</span>ord_subj), <span class="at">x=</span>condval, <span class="at">group=</span>Gender, <span class="at">color=</span>Gender)) <span class="sc">+</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> Term, <span class="at">scales=</span><span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>condval <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>condsd,</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmax=</span>condval <span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>condsd), <span class="at">height=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="st">"Gender"</span>, <span class="at">values=</span>cbPalette)<span class="sc">+</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Conditional mean"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Subject"</span>) <span class="sc">+</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check clustering by Age</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>cm_m1 <span class="sc">|&gt;</span> </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Term <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GM"</span>, <span class="st">"Switch"</span>, <span class="st">"Time"</span>, <span class="st">"Block"</span>, <span class="st">"TxB"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age =</span> <span class="fu">fct_rev</span>(<span class="fu">ifelse</span>(age <span class="sc">&gt;</span> <span class="fu">median</span>(age), <span class="st">"old"</span>, <span class="st">"young"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">factor</span>(Subj, <span class="at">levels=</span>ord_subj), <span class="at">x=</span>condval, <span class="at">group=</span>Age, <span class="at">color=</span>Age)) <span class="sc">+</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> Term, <span class="at">scales=</span><span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>condval <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>condsd,</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmax=</span>condval <span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>condsd), <span class="at">height=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="st">"Age group"</span>, <span class="at">values=</span>cbPalette) <span class="sc">+</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Conditional mean"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Subject"</span>) <span class="sc">+</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subj ordered by ...</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>ord_subj <span class="ot">&lt;-</span> cm_m1 <span class="sc">|&gt;</span> <span class="fu">filter</span>(Term<span class="sc">==</span><span class="st">"GM"</span>) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(condval) <span class="sc">|&gt;</span> <span class="fu">pull</span>(Subj) </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>cm_m1 <span class="sc">|&gt;</span> </span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age =</span> <span class="fu">fct_rev</span>(<span class="fu">ifelse</span>(age <span class="sc">&gt;</span> <span class="fu">median</span>(age), <span class="st">"old"</span>, <span class="st">"young"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">factor</span>(Subj, <span class="at">levels=</span>ord_subj), <span class="at">x=</span>condval, <span class="at">group=</span>Age, <span class="at">color=</span>Age)) <span class="sc">+</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> Term, <span class="at">scales=</span><span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>condval <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>condsd,</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmax=</span>condval <span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>condsd), <span class="at">height=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="st">"Age group (median)"</span>, <span class="at">values=</span>cbPalette) <span class="sc">+</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Conditional mean"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Subject"</span>) <span class="sc">+</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Older subjects are slower overall and show a smaller change from baseline to retest (see <code>GM</code> and <code>Time</code>). For other effects, their credibility intervals mostly cross the zero line.</p>
</section>
<section id="add-age-as-covariate-to-model-m1" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="add-age-as-covariate-to-model-m1"><span class="header-section-number">9.3</span> Add <code>age</code> as covariate to model <code>m1</code></h2>
<p>We refit the model including <code>age</code> (centered) as an additional covariate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>age_c <span class="ot">&lt;-</span> dat<span class="sc">$</span>age <span class="sc">-</span> <span class="fu">median</span>(dat<span class="sc">$</span>age)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>( <span class="st">"./fits/m1_age.rda"</span>)){</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  m1_age <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> gr<span class="sc">*</span>tm<span class="sc">*</span>bl<span class="sc">*</span>sw <span class="sc">+</span> tk<span class="sc">*</span>vc <span class="sc">+</span> age_c <span class="sc">+</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>                    (<span class="dv">1</span> <span class="sc">+</span>    tm<span class="sc">+</span>bl<span class="sc">+</span>tm<span class="sc">:</span>bl <span class="sc">|</span>Subj) <span class="sc">+</span> </span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>                    (<span class="dv">0</span><span class="sc">+</span>sw<span class="sc">+</span>tk<span class="sc">+</span>vc <span class="sc">+</span> tm<span class="sc">:</span>vc <span class="sc">+</span> bl<span class="sc">:</span>sw <span class="sc">+</span> bl<span class="sc">:</span>vc  <span class="sc">||</span> Subj) <span class="sc">+</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>                    (<span class="dv">1</span> <span class="sc">+</span> bl <span class="sc">||</span> Item), </span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save</span>(m1_age, <span class="at">file=</span><span class="st">"./fits/m1_age.rda"</span>)</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">load</span>(<span class="st">"./fits/m1_age.rda"</span>)</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(m1_age))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Subj
Importance of components:
                         [,1]   [,2]    [,3]    [,4]    [,5]    [,6]    [,7]
Standard deviation     0.3515 0.2400 0.10118 0.08664 0.08420 0.08297 0.07190
Proportion of Variance 0.5363 0.2500 0.04444 0.03259 0.03078 0.02989 0.02244
Cumulative Proportion  0.5363 0.7863 0.83073 0.86331 0.89409 0.92398 0.94642
                          [,8]    [,9]   [,10]
Standard deviation     0.07152 0.06319 0.05686
Proportion of Variance 0.02221 0.01733 0.01403
Cumulative Proportion  0.96863 0.98597 1.00000

$Item
Importance of components:
                         [,1]    [,2]
Standard deviation     0.0546 0.04378
Proportion of Variance 0.6086 0.39137
Cumulative Proportion  0.6086 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_parameters</span>(<span class="fu">list</span>(<span class="st">"Selected LMM m1"</span><span class="ot">=</span>m1, <span class="st">"LMM m1 + age"</span> <span class="ot">=</span> m1_age), </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">effects=</span><span class="st">"fixed"</span>, <span class="at">style=</span><span class="st">"se_p"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter           |       Selected LMM m1 |            LMM m1 + age
---------------------------------------------------------------------
(Intercept)         |        1.42*** (0.03) |          1.47*** (0.02)
gr                  |           0.02 (0.03) |             0.03 (0.02)
tm                  |          0.03* (0.01) |            0.03* (0.01)
bl                  |        0.07*** (0.01) |          0.07*** (0.01)
sw                  |    0.19*** (6.23e-03) |      0.19*** (6.24e-03)
tk                  |  -7.35e-03 (8.31e-03) |    -7.36e-03 (8.31e-03)
vc                  |   4.55e-03 (7.55e-03) |     4.55e-03 (7.55e-03)
gr * tm             |       -0.05*** (0.01) |         -0.05*** (0.01)
gr * bl             |        0.06*** (0.01) |          0.06*** (0.01)
tm * bl             |        0.07*** (0.01) |          0.07*** (0.01)
gr * sw             |      0.01* (6.23e-03) |        0.01* (6.24e-03)
tm * sw             |   6.26e-03 (3.44e-03) |     6.22e-03 (3.44e-03)
bl * sw             |   -0.06*** (4.85e-03) |     -0.06*** (4.85e-03)
tk * vc             |   3.15e-03 (5.68e-03) |     3.16e-03 (5.67e-03)
(gr * tm) * bl      |       -0.06*** (0.01) |         -0.06*** (0.01)
(gr * tm) * sw      |  -6.62e-03 (3.44e-03) |    -6.64e-03 (3.44e-03)
(gr * bl) * sw      |   1.56e-03 (4.85e-03) |     1.58e-03 (4.85e-03)
(tm * bl) * sw      |   2.81e-03 (3.44e-03) |     2.80e-03 (3.44e-03)
(gr * tm * bl) * sw | -7.89e-03* (3.44e-03) |   -7.89e-03* (3.44e-03)
age c               |                       | -8.52e-03*** (1.25e-03)
---------------------------------------------------------------------
Observations        |                 11769 |                   11769</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>param_m1_age <span class="ot">&lt;-</span> </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(m1_age, <span class="at">effects=</span><span class="st">"random"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Coefficient)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(m1, <span class="at">effects=</span><span class="st">"random"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Coeff_m1=</span>Coefficient) <span class="sc">|&gt;</span> </span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Coeff_m1_age=</span>param_m1_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Random Effects: Subj

Parameter             | Coeff_m1 | Coeff_m1_age
-----------------------------------------------
SD (Intercept)        |     0.16 |         0.12
SD (tm)               |     0.07 |         0.07
SD (bl)               |     0.06 |         0.06
SD (tm:bl)            |     0.06 |         0.06
SD (sw)               |     0.03 |         0.03
SD (tk)               |     0.04 |         0.04
SD (vc)               |     0.03 |         0.03
SD (vc:tm)            |     0.02 |         0.02
SD (sw:bl)            |     0.02 |         0.02
SD (vc:bl)            |     0.03 |         0.03
Cor (Intercept~tm)    |    -0.02 |        -0.33
Cor (Intercept~bl)    |     0.20 |         0.41
Cor (Intercept~tm:bl) |    -0.03 |        -0.21
Cor (tm~bl)           |    -0.77 |        -0.77
Cor (tm~tm:bl)        |     0.81 |         0.81
Cor (bl~tm:bl)        |    -0.78 |        -0.78

# Random Effects: Item

Parameter      | Coeff_m1 | Coeff_m1_age
----------------------------------------
SD (Intercept) |     0.02 |         0.02
SD (bl)        |     0.02 |         0.02

# Random Effects: Residual

Parameter         | Coeff_m1 | Coeff_m1_age
-------------------------------------------
SD (Observations) |     0.37 |         0.37</code></pre>
</div>
</div>
<ul>
<li>The linear trend of <code>age</code> is significant; other fixed effects stay significant.</li>
<li>Its inclusion reduces the subject-related VC for <code>GM</code> and increases the magnitude of associated CPs.</li>
<li>The quadratic trend of age was not significant (not shown).</li>
<li>Other VCs and CPs do not change.</li>
</ul>
<p>We check the conditional means of random effects again using functions from <code>easystats</code> package <a href="https://easystats.github.io/see/articles/modelbased.html">{modelbased}</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>cm_m1_age <span class="ot">&lt;-</span> <span class="fu">ranef</span>(m1_age, <span class="at">drop=</span><span class="cn">TRUE</span>, <span class="at">condVar=</span><span class="cn">TRUE</span>, <span class="at">whichel=</span><span class="st">"Subj"</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>cm_m1_age <span class="ot">&lt;-</span> </span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(cm_m1_age) <span class="sc">|&gt;</span> </span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Term=</span>term, <span class="at">Subj=</span>grp) <span class="sc">|&gt;</span> </span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Term =</span> <span class="fu">fct_recode</span>(Term, <span class="at">GM =</span> <span class="st">"(Intercept)"</span>, <span class="at">Time=</span><span class="st">"tm"</span>, <span class="at">Block=</span><span class="st">"bl"</span>,</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Switch=</span><span class="st">"sw"</span>, <span class="at">TxB =</span> <span class="st">"tm:bl"</span>),</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Term =</span> <span class="fu">fct_relevel</span>(Term, <span class="st">"Switch"</span>, <span class="at">after=</span><span class="dv">1</span>))</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add subject info</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>cm_m1_age <span class="ot">&lt;-</span> </span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>  cm_m1_age <span class="sc">|&gt;</span> </span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sinfo, <span class="at">by=</span><span class="st">"Subj"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Group, Subj, age, Gender, Term, condval, condsd)</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Subj ordered by ...</span></span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>ord_subj <span class="ot">&lt;-</span> cm_m1_age <span class="sc">|&gt;</span> <span class="fu">filter</span>(Term<span class="sc">==</span><span class="st">"GM"</span>) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(condval) <span class="sc">|&gt;</span> <span class="fu">pull</span>(Subj) </span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>cm_m1_age <span class="sc">|&gt;</span> </span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Term <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GM"</span>, <span class="st">"Switch"</span>, <span class="st">"Time"</span>, <span class="st">"Block"</span>, <span class="st">"TxB"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age =</span> <span class="fu">fct_rev</span>(<span class="fu">ifelse</span>(age <span class="sc">&gt;</span> <span class="dv">45</span>, <span class="st">"old"</span>, <span class="st">"young"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">factor</span>(Subj, <span class="at">levels=</span>ord_subj), <span class="at">x=</span>condval, <span class="at">group=</span>Age, <span class="at">color=</span>Age)) <span class="sc">+</span></span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> Term, <span class="at">scales=</span><span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>condval <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>condsd,</span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmax=</span>condval <span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>condsd), <span class="at">height=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="st">"Age group"</span>, <span class="at">values=</span>cbPalette) <span class="sc">+</span></span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Conditional mean"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Subject"</span>) <span class="sc">+</span></span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>As expected, older subjects’ conditional means for <code>GM</code> “moved” into the sample distribution when age is included as a covariate.</p>
</section>
<section id="item-related-conditional-means-of-random-effects" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="item-related-conditional-means-of-random-effects"><span class="header-section-number">9.4</span> Item-related conditional means of random effects</h2>
<ul>
<li>There is only one VC for Grand Mean of speed of response by Item.</li>
<li>Replace item number with actual word.</li>
<li>Check for outliers.</li>
</ul>
<p>Using <a href="https://easystats.github.io/modelbased/articles/estimate_grouplevel.html">{modelbased}</a> with functions:</p>
<ul>
<li><code>estimate_grouplevel(model, deviation=FALSE)</code> # Group-specific effects</li>
<li><code>estimate_grouplevel(model, type="total")</code> # BLUPs: fe + cm</li>
<li><code>reshape_grouplevel()</code>; # CMs to wide data; then <code>cbind()</code> with original dataframe.</li>
<li><code>summary()</code> for objects of <code>reshaped_group_level()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>cm_m1_item  <span class="ot">&lt;-</span> </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">estimate_grouplevel</span>(m1) <span class="sc">|&gt;</span> </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Group<span class="sc">==</span><span class="st">"Item"</span>)<span class="sc">|&gt;</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(items, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"Level"</span><span class="ot">=</span><span class="st">"Item"</span>)) </span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>cm_m1_item <span class="sc">|&gt;</span> </span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">out =</span> <span class="fu">if_else</span>(Word <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Liebe"</span>, <span class="st">"HORNISSE"</span>), <span class="st">"red"</span>, <span class="st">"black"</span>),</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Parameter =</span> <span class="fu">fct_recode</span>(Parameter, <span class="st">"GM"</span> <span class="ot">=</span> <span class="st">"(Intercept)"</span>, <span class="st">"Block"</span> <span class="ot">=</span> <span class="st">"bl"</span>),</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Word =</span> <span class="fu">fct_reorder</span>(Word, Coefficient)) <span class="sc">|&gt;</span> </span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>Word, <span class="at">x=</span>Coefficient, <span class="at">group=</span>out, <span class="at">color=</span>out)) <span class="sc">+</span> </span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Parameter, <span class="at">scales=</span><span class="st">"free_x"</span>, ) <span class="sc">+</span></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>Coefficient<span class="dv">-2</span><span class="sc">*</span>SE, <span class="at">xmax=</span>Coefficient<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>SE), <span class="at">height=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">""</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Conditional mean"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2_Cajar_IAT_R_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>The sources of the two significant <code>Item</code>-related VCs of <code>GM</code> and <code>Block</code> are two items. <strong>HORNISSE</strong> (hornet) is the only item with a significantly smaller than average <code>Block</code> effect (see right facet; i.e., no overlap of credibility interval with zero line). Note that <em>hornet</em> was also the item with the numerically slowest respond speed overall (see <code>GM</code>, left facet). There was also one item/word that was responded to significantly faster (i.e., no overlap of credibility interval with <code>GM</code>) than <strong>Liebe</strong> (lover) than the Grand Mean. Makes sense.</p>
</section>
</section>
<section id="appendix" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Appendix</h1>
<section id="refit-model13-with-sum-contrasts" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="refit-model13-with-sum-contrasts"><span class="header-section-number">10.1</span> Refit <code>model13</code> with sum contrasts</h2>
<p>In the original analysis, treatment contrasts were chosen for <code>Group</code> and <code>Time</code> because they provides a direct test of the critical cell against the average of the other three (which may be assumed to be equivalent because they do not involve fake behavior). There are four critical terms with this specification:</p>
<ol type="1">
<li>Interaction of <code>Group x Time</code> tests the critical “fake” cell against the mean of other cells.<br>
</li>
<li>Interaction of <code>Group x Time x Block</code> tests whether 1. is moderated by <code>Block</code></li>
<li>Interaction of <code>Group x Time x Switch</code> tests whether 1. is moderated by <code>Switch</code></li>
<li>Interaction of <code>Group x Time x Block x Switch</code> tests whether 2. and 3. are additive.</li>
</ol>
<p>Theoretically critical interactions are: 2, 3, and 4. Interestingly, these interactions should yield the same test statistics if all four factors are specified with sum contrasts. In this respect, sum contrasts are ok.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Group) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Time)  <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Block) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)<span class="sc">/-</span><span class="dv">2</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dat<span class="sc">$</span>Switch) <span class="ot">&lt;-</span><span class="fu">contr.sum</span>(<span class="dv">2</span>)<span class="sc">/-</span><span class="dv">2</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>model12_sum <span class="ot">&lt;-</span> <span class="fu">lmer</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group<span class="sc">*</span>Time<span class="sc">*</span>Block<span class="sc">*</span>Switch <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subj) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Item), </span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>dat, <span class="at">REML=</span><span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">calc.derivs=</span><span class="cn">FALSE</span>))</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>fe_ord <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">15</span>)</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">Parameter=</span><span class="fu">names</span>(<span class="fu">fixef</span>(model12)), </span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>       <span class="st">"t w/ trt"</span><span class="ot">=</span><span class="fu">summary</span>(model12)<span class="sc">$</span>coefficients[,<span class="dv">3</span>], </span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>       <span class="st">"t w/ sum"</span><span class="ot">=</span><span class="fu">summary</span>(model12_sum)<span class="sc">$</span>coefficients[,<span class="dv">3</span>],</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>       <span class="st">"b w/ trt"</span><span class="ot">=</span><span class="fu">summary</span>(model12)<span class="sc">$</span>coefficients[,<span class="dv">1</span>], </span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>       <span class="st">"b w/ sum"</span><span class="ot">=</span><span class="fu">summary</span>(model12_sum)<span class="sc">$</span>coefficients[,<span class="dv">1</span>])[fe_ord,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 5
   Parameter                   `t w/ trt` `t w/ sum` `b w/ trt` `b w/ sum`
   &lt;chr&gt;                            &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Group2:Time2                   -13.2      -13.2     -0.192      -0.192 
 2 Group2:Time2:Block1             17.3       17.3      0.504       0.504 
 3 Group2:Time2:Switch1             2.17       2.17     0.0633      0.0633
 4 Group2:Time2:Block1:Switch1     -2.20      -2.20    -0.128      -0.128 
 5 (Intercept)                     36.9       52.4      1.42        1.42  
 6 Group2                           1.08       0.697    0.0585      0.0374
 7 Time2                            4.45       6.87     0.0459      0.0500
 8 Block1                         -19.2      -20.0     -0.280      -0.146 
 9 Switch1                        -27.2      -51.3     -0.396      -0.374 
10 Group2:Block1                   -0.269    -16.9     -0.00552    -0.246 
11 Time2:Block1                     1.07     -18.8      0.0221     -0.274 
12 Group2:Switch1                   0.990     -3.57     0.0204     -0.0520
13 Time2:Switch1                   -0.385     -1.63    -0.00794    -0.0237
14 Block1:Switch1                  -8.92     -17.0     -0.260      -0.248 
15 Group2:Block1:Switch1            1.18       0.540    0.0484      0.0157
16 Time2:Block1:Switch1             0.984      0.807    0.0406      0.0235</code></pre>
</div>
</div>
<p>Good. Expectations were met perfectly!</p>
<p>All other fixed-effect test statistics will depend on the chosen contrasts. In general, as sum contrasts are orthogonal, they should have better statistical power for the detection of significant main effects and other interactions than treatment contrasts. For example, the <code>Block x Switch</code> is of theoretical interest, too. For this interaction, with contr.sum, <em>t</em> = -17.0, with contr.treatment <em>t</em>=-8.9, despite averaging over <code>Group</code> and <code>Time</code> in this case in both models. Other fixed effects have a different meaning in the two analyses; they do not refer to the same effects! Therefore, test statistics are not comparable.</p>
</section>
<section id="session-info" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="session-info"><span class="header-section-number">10.2</span> Session info</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.1 (2022-06-23)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur ... 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] remef_1.0.7         ellipse_0.4.3       GGally_2.1.2       
 [4] car_3.1-0           carData_3.0-5       lme4_1.1-30        
 [7] Matrix_1.4-1        report_0.5.5.1      see_0.7.2.1        
[10] correlation_0.8.2.2 modelbased_0.8.5    effectsize_0.7.0.5 
[13] parameters_0.18.2   performance_0.9.2   bayestestR_0.12.1  
[16] datawizard_0.5.1    insight_0.18.2      easystats_0.5.1    
[19] forcats_0.5.1       stringr_1.4.0       dplyr_1.0.9        
[22] purrr_0.3.4         readr_2.1.2         tidyr_1.2.0        
[25] tibble_3.1.8        ggplot2_3.3.6       tidyverse_1.3.2    
[28] arrow_9.0.0        

loaded via a namespace (and not attached):
 [1] nlme_3.1-157        fs_1.5.2            lubridate_1.8.0    
 [4] bit64_4.0.5         RColorBrewer_1.1-3  httr_1.4.4         
 [7] tools_4.2.1         backports_1.4.1     utf8_1.2.2         
[10] R6_2.5.1            mgcv_1.8-40         DBI_1.1.3          
[13] colorspace_2.0-3    withr_2.5.0         tidyselect_1.1.2   
[16] emmeans_1.8.0       bit_4.0.4           compiler_4.2.1     
[19] cli_3.3.0           rvest_1.0.2         xml2_1.3.3         
[22] isoband_0.2.5       labeling_0.4.2      scales_1.2.0       
[25] mvtnorm_1.1-3       digest_0.6.29       minqa_1.2.4        
[28] rmarkdown_2.15      pkgconfig_2.0.3     htmltools_0.5.3    
[31] dbplyr_2.2.1        fastmap_1.1.0       htmlwidgets_1.5.4  
[34] rlang_1.0.5         readxl_1.4.1        rstudioapi_0.13    
[37] farver_2.1.1        generics_0.1.3      jsonlite_1.8.0     
[40] googlesheets4_1.0.1 magrittr_2.0.3      patchwork_1.1.2    
[43] Rcpp_1.0.9          munsell_0.5.0       fansi_1.0.3        
[46] abind_1.4-5         lifecycle_1.0.1     stringi_1.7.8      
[49] yaml_2.3.5          MASS_7.3-57         plyr_1.8.7         
[52] grid_4.2.1          ggrepel_0.9.1       crayon_1.5.1       
[55] lattice_0.20-45     haven_2.5.0         splines_4.2.1      
[58] hms_1.1.2           knitr_1.39          pillar_1.8.1       
[61] boot_1.3-28         estimability_1.4.1  reprex_2.0.2       
[64] glue_1.6.2          evaluate_0.16       modelr_0.1.8       
[67] vctrs_0.4.1         nloptr_2.0.3        tzdb_0.3.0         
[70] cellranger_1.1.0    gtable_0.3.0        reshape_0.8.9      
[73] assertthat_0.2.1    xfun_0.32           xtable_1.8-4       
[76] broom_1.0.0         coda_0.19-4         googledrive_2.0.0  
[79] gargle_1.2.0        ellipsis_0.3.2     </code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>