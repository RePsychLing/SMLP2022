<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Reinhold Kliegl">
<meta name="dcterms.date" content="2022-08-24">

<title>Antje Hofmann: Learning Syntactic Relations with the Mole Task</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Hofmann_Maulwurf_Julia_1_files/libs/clipboard/clipboard.min.js"></script>
<script src="Hofmann_Maulwurf_Julia_1_files/libs/quarto-html/quarto.js"></script>
<script src="Hofmann_Maulwurf_Julia_1_files/libs/quarto-html/popper.min.js"></script>
<script src="Hofmann_Maulwurf_Julia_1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Hofmann_Maulwurf_Julia_1_files/libs/quarto-html/anchor.min.js"></script>
<link href="Hofmann_Maulwurf_Julia_1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Hofmann_Maulwurf_Julia_1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Hofmann_Maulwurf_Julia_1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Hofmann_Maulwurf_Julia_1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Hofmann_Maulwurf_Julia_1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"> <span class="header-section-number">1</span> Background</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"> <span class="header-section-number">1.1</span> Overview</a></li>
  </ul></li>
  <li><a href="#readme" id="toc-readme" class="nav-link" data-scroll-target="#readme"> <span class="header-section-number">2</span> Readme</a>
  <ul class="collapse">
  <li><a href="#design" id="toc-design" class="nav-link" data-scroll-target="#design"> <span class="header-section-number">2.1</span> Design</a></li>
  <li><a href="#variables" id="toc-variables" class="nav-link" data-scroll-target="#variables"> <span class="header-section-number">2.2</span> Variables</a></li>
  </ul></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup"> <span class="header-section-number">3</span> Setup</a></li>
  <li><a href="#lmm-analysis" id="toc-lmm-analysis" class="nav-link" data-scroll-target="#lmm-analysis"> <span class="header-section-number">4</span> LMM analysis</a>
  <ul class="collapse">
  <li><a href="#contrasts" id="toc-contrasts" class="nav-link" data-scroll-target="#contrasts"> <span class="header-section-number">4.1</span> Contrasts</a></li>
  <li><a href="#varying-only-intercepts-lmm-m_voi" id="toc-varying-only-intercepts-lmm-m_voi" class="nav-link" data-scroll-target="#varying-only-intercepts-lmm-m_voi"> <span class="header-section-number">4.2</span> Varying only intercepts LMM <code>m_voi</code></a></li>
  <li><a href="#extract-indicator-variables" id="toc-extract-indicator-variables" class="nav-link" data-scroll-target="#extract-indicator-variables"> <span class="header-section-number">4.3</span> Extract indicator variables</a></li>
  <li><a href="#a-zero-correlation-parameter-lmm-m_zcp" id="toc-a-zero-correlation-parameter-lmm-m_zcp" class="nav-link" data-scroll-target="#a-zero-correlation-parameter-lmm-m_zcp"> <span class="header-section-number">4.4</span> A zero-correlation parameter LMM <code>m_zcp</code></a></li>
  <li><a href="#a-complex-parameter-lmm-m_cpx" id="toc-a-complex-parameter-lmm-m_cpx" class="nav-link" data-scroll-target="#a-complex-parameter-lmm-m_cpx"> <span class="header-section-number">4.5</span> A complex parameter LMM <code>m_cpx</code></a></li>
  <li><a href="#a-parsimonious-parameter-lmm-m_prm" id="toc-a-parsimonious-parameter-lmm-m_prm" class="nav-link" data-scroll-target="#a-parsimonious-parameter-lmm-m_prm"> <span class="header-section-number">4.6</span> A parsimonious parameter LMM <code>m_prm</code></a></li>
  <li><a href="#compare-models-with-goodness-of-fit-statistics." id="toc-compare-models-with-goodness-of-fit-statistics." class="nav-link" data-scroll-target="#compare-models-with-goodness-of-fit-statistics."> <span class="header-section-number">4.7</span> Compare models with goodness-of-fit statistics.</a></li>
  <li><a href="#pruning-fixed-effects" id="toc-pruning-fixed-effects" class="nav-link" data-scroll-target="#pruning-fixed-effects"> <span class="header-section-number">4.8</span> Pruning fixed-effects</a></li>
  <li><a href="#diagnostic-plots" id="toc-diagnostic-plots" class="nav-link" data-scroll-target="#diagnostic-plots"> <span class="header-section-number">4.9</span> Diagnostic plots</a></li>
  <li><a href="#conditional-means-of-random-effects" id="toc-conditional-means-of-random-effects" class="nav-link" data-scroll-target="#conditional-means-of-random-effects"> <span class="header-section-number">4.10</span> Conditional means of random effects</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Antje Hofmann: Learning Syntactic Relations with the Mole Task</h1>
<p class="subtitle lead">RePsychLing in SMLP2022</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Reinhold Kliegl </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 24, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="background" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Background</h1>
<p>Children’s (age: 4-8 years)reaction times in a task teaching them syntactic relations.</p>
<section id="overview" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1.1</span> Overview</h2>
<ul>
<li>Original analysis is by Antje Hofmann.</li>
<li>MixedModels.jl version</li>
<li>Addition of new chunks illustrate
<ul>
<li>selection of parsimonious LMM using random-effects PCA</li>
<li>plotting conditional means</li>
<li>illustration of borrowing strength</li>
</ul></li>
</ul>
</section>
</section>
<section id="readme" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Readme</h1>
<section id="design" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="design"><span class="header-section-number">2.1</span> Design</h2>
</section>
<section id="variables" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="variables"><span class="header-section-number">2.2</span> Variables</h2>
<ul>
<li><code>Subj</code>: Participant ID (renamed from <code>ID</code>; random factor)</li>
<li><code>Item</code>: Word ID (random factor)</li>
<li><code>age</code>: 4 - 8 years</li>
<li><code>Block</code> (within-Subj/within-Item):
<ul>
<li>1st Learning</li>
<li>2nd Learning</li>
<li>Disruption</li>
<li>Recovery</li>
</ul></li>
<li><code>Target</code>(renamend fom targetness)
<ul>
<li>non-syllable target</li>
<li>syllable target</li>
</ul></li>
<li><code>rt</code>: response time</li>
</ul>
</section>
</section>
<section id="setup" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Setup</h1>
<p>First attach the <em>MixedModels.jl</em> package and other packages for plotting. The <em>CairoMakie.jl</em> package allows the Makie graphics system <span class="citation" data-cites="Danisch2021">[@Danisch2021]</span> to generate high quality static images. Activate that package with the SVG (Scalable Vector Graphics) backend.</p>
<div id="packages" class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AlgebraOfGraphics</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Arrow</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CairoMakie       </span><span class="co"># graphics back-end</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CategoricalArrays</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Chain</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrameMacros  </span><span class="co"># simplified dplyr-like data wrangling </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">KernelDensity    </span><span class="co"># density estimation</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModels</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModelsMakie </span><span class="co"># diagnostic plots</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">contains</span>(<span class="fu">first</span>(<span class="bu">Sys</span>.<span class="fu">cpu_info</span>()).model, <span class="st">"Intel"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="im">using</span> <span class="bu">MKL             </span><span class="co"># faster LAPACK on Intel processors</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ProgressMeter</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random           </span><span class="co"># random number generators</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">RCall            </span><span class="co"># call R from Julia</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsModels</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AlgebraOfGraphics</span>: boxplot</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AlgebraOfGraphics</span>: density</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModelsMakie</span>: qqnorm</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModelsMakie</span>: ridgeplot</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModelsMakie</span>: scatter</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModelsMakie</span>: caterpillar</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>ProgressMeter.<span class="fu">ijulia_behavior</span>(<span class="op">:</span>clear);</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>CairoMakie.<span class="fu">activate!</span>(; <span class="kw">type</span><span class="op">=</span><span class="st">"svg"</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>The data are available as an arrow file.</li>
<li>Most of preprocessing was done with R in RStudio (see Hofmann_Maulwurf.Rmd).</li>
<li>Order of factor levels should be checked.</li>
</ul>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dat <span class="op">=</span> <span class="fu">DataFrame</span>(Arrow.<span class="fu">Table</span>(<span class="st">"./data/Hofmann_Maulwurf_rt.arrow"</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">transform!</span>(dat, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>Target <span class="op">=&gt;</span> categorical <span class="op">=&gt;</span> <span class="op">:</span>Target,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>Block  <span class="op">=&gt;</span> categorical <span class="op">=&gt;</span> <span class="op">:</span>Block,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>age <span class="op">=&gt;</span> (x <span class="op">-&gt;</span> x <span class="op">.-</span> <span class="fl">6</span>) <span class="op">=&gt;</span> <span class="op">:</span>a1, <span class="co"># center age (linear) at 6 years</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>rt <span class="op">=&gt;</span> (x <span class="op">-&gt;</span> <span class="fu">log</span>.(x)) <span class="op">=&gt;</span> <span class="op">:</span>lrt)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">

<div class="data-frame"><p>8 rows × 7 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>variable</th><th>mean</th><th>min</th><th>median</th><th>max</th><th>nmissing</th><th>eltype</th></tr><tr><th></th><th title="Symbol">Symbol</th><th title="Union{Nothing, Float64}">Union…</th><th title="Any">Any</th><th title="Union{Nothing, Float64}">Union…</th><th title="Any">Any</th><th title="Int64">Int64</th><th title="Type">Type</th></tr></thead><tbody><tr><th>1</th><td>Subj</td><td></td><td>p01</td><td></td><td>p85</td><td>0</td><td>Union{Missing, String}</td></tr><tr><th>2</th><td>Item</td><td></td><td>01PA.ogg</td><td></td><td>32SG.ogg</td><td>0</td><td>Union{Missing, String}</td></tr><tr><th>3</th><td>age</td><td>6.21081</td><td>3.7</td><td>6.31</td><td>8.04</td><td>0</td><td>Union{Missing, Float64}</td></tr><tr><th>4</th><td>Block</td><td></td><td>1st Learning</td><td></td><td>Recovery</td><td>0</td><td>Union{Missing, CategoricalValue{String, UInt32}}</td></tr><tr><th>5</th><td>Target</td><td></td><td>Non-target syllable</td><td></td><td>Target syllable</td><td>0</td><td>Union{Missing, CategoricalValue{String, UInt32}}</td></tr><tr><th>6</th><td>rt</td><td>2335.39</td><td>228.0</td><td>2100.0</td><td>8389.0</td><td>0</td><td>Union{Missing, Float64}</td></tr><tr><th>7</th><td>a1</td><td>0.210813</td><td>-2.3</td><td>0.31</td><td>2.04</td><td>0</td><td>Float64</td></tr><tr><th>8</th><td>lrt</td><td>7.67367</td><td>5.42935</td><td>7.64969</td><td>9.03468</td><td>0</td><td>Float64</td></tr></tbody></table></div>
</div>
</div>
<ul>
<li>Centering age at six years yields an interpretable <code>GM</code><br>
</li>
<li>Factor levels can also be set when contrasts are defined (see below).</li>
<li>BoxCox check showed that reaction time <code>rt</code> [ms] should be transformed to <code>speed</code> [1/s] = [Hz]</li>
<li>Indicator variables for <code>Target</code> and <code>Block</code> generated in R.</li>
</ul>
</section>
<section id="lmm-analysis" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> LMM analysis</h1>
<section id="contrasts" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="contrasts"><span class="header-section-number">4.1</span> Contrasts</h2>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="contrasts"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="contrasts-1"><a href="#contrasts-1" aria-hidden="true" tabindex="-1"></a>contrasts <span class="op">=</span> <span class="fu">merge</span>(</span>
<span id="contrasts-2"><a href="#contrasts-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Dict</span>(<span class="op">:</span>Target <span class="op">=&gt;</span> <span class="fu">EffectsCoding</span>()),</span>
<span id="contrasts-3"><a href="#contrasts-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Dict</span>(<span class="op">:</span>Block <span class="op">=&gt;</span> <span class="fu">SeqDiffCoding</span>()),</span>
<span id="contrasts-4"><a href="#contrasts-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Dict</span>(nm <span class="op">=&gt;</span> <span class="fu">Grouping</span>() <span class="cf">for</span> nm <span class="kw">in</span> (<span class="op">:</span>Subj, <span class="op">:</span>Item))</span>
<span id="contrasts-5"><a href="#contrasts-5" aria-hidden="true" tabindex="-1"></a>   );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="varying-only-intercepts-lmm-m_voi" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="varying-only-intercepts-lmm-m_voi"><span class="header-section-number">4.2</span> Varying only intercepts LMM <code>m_voi</code></h2>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="m_voi1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="m_voi1-1"><a href="#m_voi1-1" aria-hidden="true" tabindex="-1"></a>f_voi1 <span class="op">=</span> <span class="pp">@formula</span>(lrt <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span> Block <span class="op">*</span> Target <span class="op">*</span> a1 <span class="op">+</span> (<span class="fl">1</span> <span class="op">|</span> Subj) <span class="op">+</span> (<span class="fl">1</span> <span class="op">|</span> Item));</span>
<span id="m_voi1-2"><a href="#m_voi1-2" aria-hidden="true" tabindex="-1"></a>m_voi1 <span class="op">=</span> <span class="fu">fit</span>(MixedModel, f_voi1, dat; contrasts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 50    Time: 0:00:00 ( 9.17 ms/it)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 54%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">σ_Item</th>
<th style="text-align: right;">σ_Subj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">7.6895</td>
<td style="text-align: right;">0.0371</td>
<td style="text-align: right;">207.05</td>
<td style="text-align: right;">&lt;1e-99</td>
<td style="text-align: right;">0.0239</td>
<td style="text-align: right;">0.2637</td>
</tr>
<tr class="even">
<td style="text-align: left;">Block: 2nd Learning</td>
<td style="text-align: right;">-0.0920</td>
<td style="text-align: right;">0.0104</td>
<td style="text-align: right;">-8.87</td>
<td style="text-align: right;">&lt;1e-18</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Block: Disruption</td>
<td style="text-align: right;">0.0516</td>
<td style="text-align: right;">0.0126</td>
<td style="text-align: right;">4.09</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Block: Recovery</td>
<td style="text-align: right;">-0.0477</td>
<td style="text-align: right;">0.0125</td>
<td style="text-align: right;">-3.81</td>
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Target: Target syllable</td>
<td style="text-align: right;">-0.0108</td>
<td style="text-align: right;">0.0040</td>
<td style="text-align: right;">-2.69</td>
<td style="text-align: right;">0.0072</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">-0.0896</td>
<td style="text-align: right;">0.0324</td>
<td style="text-align: right;">-2.77</td>
<td style="text-align: right;">0.0056</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Block: 2nd Learning &amp; Target: Target syllable</td>
<td style="text-align: right;">-0.0057</td>
<td style="text-align: right;">0.0104</td>
<td style="text-align: right;">-0.55</td>
<td style="text-align: right;">0.5854</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Block: Disruption &amp; Target: Target syllable</td>
<td style="text-align: right;">-0.0262</td>
<td style="text-align: right;">0.0124</td>
<td style="text-align: right;">-2.11</td>
<td style="text-align: right;">0.0347</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Block: Recovery &amp; Target: Target syllable</td>
<td style="text-align: right;">0.0020</td>
<td style="text-align: right;">0.0123</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.8741</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Block: 2nd Learning &amp; a1</td>
<td style="text-align: right;">0.0347</td>
<td style="text-align: right;">0.0091</td>
<td style="text-align: right;">3.83</td>
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Block: Disruption &amp; a1</td>
<td style="text-align: right;">0.0214</td>
<td style="text-align: right;">0.0108</td>
<td style="text-align: right;">1.97</td>
<td style="text-align: right;">0.0486</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Block: Recovery &amp; a1</td>
<td style="text-align: right;">-0.0159</td>
<td style="text-align: right;">0.0108</td>
<td style="text-align: right;">-1.47</td>
<td style="text-align: right;">0.1409</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Target: Target syllable &amp; a1</td>
<td style="text-align: right;">-0.0052</td>
<td style="text-align: right;">0.0035</td>
<td style="text-align: right;">-1.46</td>
<td style="text-align: right;">0.1430</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Block: 2nd Learning &amp; Target: Target syllable &amp; a1</td>
<td style="text-align: right;">-0.0113</td>
<td style="text-align: right;">0.0090</td>
<td style="text-align: right;">-1.25</td>
<td style="text-align: right;">0.2111</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Block: Disruption &amp; Target: Target syllable &amp; a1</td>
<td style="text-align: right;">0.0113</td>
<td style="text-align: right;">0.0108</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">0.2933</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Block: Recovery &amp; Target: Target syllable &amp; a1</td>
<td style="text-align: right;">0.0086</td>
<td style="text-align: right;">0.0107</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.4248</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.3004</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="extract-indicator-variables" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="extract-indicator-variables"><span class="header-section-number">4.3</span> Extract indicator variables</h2>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> <span class="fu">modelmatrix</span>(m_voi1)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dat.trng <span class="op">=</span> X[<span class="op">:</span>,<span class="fl">2</span>];</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>dat.drpt <span class="op">=</span> X[<span class="op">:</span>,<span class="fl">3</span>];</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>dat.rcvr <span class="op">=</span> X[<span class="op">:</span>,<span class="fl">4</span>];</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>dat.trgt <span class="op">=</span> X[<span class="op">:</span>,<span class="fl">5</span>];</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">

<div class="data-frame"><p>12 rows × 7 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>variable</th><th>mean</th><th>min</th><th>median</th><th>max</th><th>nmissing</th><th>eltype</th></tr><tr><th></th><th title="Symbol">Symbol</th><th title="Union{Nothing, Float64}">Union…</th><th title="Any">Any</th><th title="Union{Nothing, Float64}">Union…</th><th title="Any">Any</th><th title="Int64">Int64</th><th title="Type">Type</th></tr></thead><tbody><tr><th>1</th><td>Subj</td><td></td><td>p01</td><td></td><td>p85</td><td>0</td><td>Union{Missing, String}</td></tr><tr><th>2</th><td>Item</td><td></td><td>01PA.ogg</td><td></td><td>32SG.ogg</td><td>0</td><td>Union{Missing, String}</td></tr><tr><th>3</th><td>age</td><td>6.21081</td><td>3.7</td><td>6.31</td><td>8.04</td><td>0</td><td>Union{Missing, Float64}</td></tr><tr><th>4</th><td>Block</td><td></td><td>1st Learning</td><td></td><td>Recovery</td><td>0</td><td>Union{Missing, CategoricalValue{String, UInt32}}</td></tr><tr><th>5</th><td>Target</td><td></td><td>Non-target syllable</td><td></td><td>Target syllable</td><td>0</td><td>Union{Missing, CategoricalValue{String, UInt32}}</td></tr><tr><th>6</th><td>rt</td><td>2335.39</td><td>228.0</td><td>2100.0</td><td>8389.0</td><td>0</td><td>Union{Missing, Float64}</td></tr><tr><th>7</th><td>a1</td><td>0.210813</td><td>-2.3</td><td>0.31</td><td>2.04</td><td>0</td><td>Float64</td></tr><tr><th>8</th><td>lrt</td><td>7.67367</td><td>5.42935</td><td>7.64969</td><td>9.03468</td><td>0</td><td>Float64</td></tr><tr><th>9</th><td>trng</td><td>-0.014562</td><td>-0.75</td><td>0.25</td><td>0.25</td><td>0</td><td>Float64</td></tr><tr><th>10</th><td>drpt</td><td>-0.0528019</td><td>-0.5</td><td>-0.5</td><td>0.5</td><td>0</td><td>Float64</td></tr><tr><th>11</th><td>rcvr</td><td>0.0524467</td><td>-0.25</td><td>-0.25</td><td>0.75</td><td>0</td><td>Float64</td></tr><tr><th>12</th><td>trgt</td><td>0.00331492</td><td>-1.0</td><td>1.0</td><td>1.0</td><td>0</td><td>Float64</td></tr></tbody></table></div>
</div>
</div>
<p>Switch to indicator variables and refit the model.</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="m_voi2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="m_voi2-1"><a href="#m_voi2-1" aria-hidden="true" tabindex="-1"></a>f_voi2 <span class="op">=</span> <span class="pp">@formula</span>(lrt <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span> (trng<span class="op">+</span>drpt<span class="op">+</span>rcvr) <span class="op">*</span> trgt <span class="op">*</span> a1 <span class="op">+</span> (<span class="fl">1</span> <span class="op">|</span> Subj) <span class="op">+</span> (<span class="fl">1</span> <span class="op">|</span> Item));</span>
<span id="m_voi2-2"><a href="#m_voi2-2" aria-hidden="true" tabindex="-1"></a>m_voi2 <span class="op">=</span> <span class="fu">fit</span>(MixedModel, f_voi2, dat; contrasts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 28%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">σ_Item</th>
<th style="text-align: right;">σ_Subj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">7.6895</td>
<td style="text-align: right;">0.0371</td>
<td style="text-align: right;">207.05</td>
<td style="text-align: right;">&lt;1e-99</td>
<td style="text-align: right;">0.0239</td>
<td style="text-align: right;">0.2637</td>
</tr>
<tr class="even">
<td style="text-align: left;">trng</td>
<td style="text-align: right;">-0.0920</td>
<td style="text-align: right;">0.0104</td>
<td style="text-align: right;">-8.87</td>
<td style="text-align: right;">&lt;1e-18</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">drpt</td>
<td style="text-align: right;">0.0516</td>
<td style="text-align: right;">0.0126</td>
<td style="text-align: right;">4.09</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">rcvr</td>
<td style="text-align: right;">-0.0477</td>
<td style="text-align: right;">0.0125</td>
<td style="text-align: right;">-3.81</td>
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">trgt</td>
<td style="text-align: right;">-0.0108</td>
<td style="text-align: right;">0.0040</td>
<td style="text-align: right;">-2.69</td>
<td style="text-align: right;">0.0072</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">-0.0896</td>
<td style="text-align: right;">0.0324</td>
<td style="text-align: right;">-2.77</td>
<td style="text-align: right;">0.0056</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">trng &amp; trgt</td>
<td style="text-align: right;">-0.0057</td>
<td style="text-align: right;">0.0104</td>
<td style="text-align: right;">-0.55</td>
<td style="text-align: right;">0.5854</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">drpt &amp; trgt</td>
<td style="text-align: right;">-0.0262</td>
<td style="text-align: right;">0.0124</td>
<td style="text-align: right;">-2.11</td>
<td style="text-align: right;">0.0347</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">rcvr &amp; trgt</td>
<td style="text-align: right;">0.0020</td>
<td style="text-align: right;">0.0123</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.8741</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">trng &amp; a1</td>
<td style="text-align: right;">0.0347</td>
<td style="text-align: right;">0.0091</td>
<td style="text-align: right;">3.83</td>
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">drpt &amp; a1</td>
<td style="text-align: right;">0.0214</td>
<td style="text-align: right;">0.0108</td>
<td style="text-align: right;">1.97</td>
<td style="text-align: right;">0.0486</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">rcvr &amp; a1</td>
<td style="text-align: right;">-0.0159</td>
<td style="text-align: right;">0.0108</td>
<td style="text-align: right;">-1.47</td>
<td style="text-align: right;">0.1409</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">trgt &amp; a1</td>
<td style="text-align: right;">-0.0052</td>
<td style="text-align: right;">0.0035</td>
<td style="text-align: right;">-1.46</td>
<td style="text-align: right;">0.1430</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">trng &amp; trgt &amp; a1</td>
<td style="text-align: right;">-0.0113</td>
<td style="text-align: right;">0.0090</td>
<td style="text-align: right;">-1.25</td>
<td style="text-align: right;">0.2111</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">drpt &amp; trgt &amp; a1</td>
<td style="text-align: right;">0.0113</td>
<td style="text-align: right;">0.0108</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">0.2933</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">rcvr &amp; trgt &amp; a1</td>
<td style="text-align: right;">0.0086</td>
<td style="text-align: right;">0.0107</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.4248</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.3004</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>They are equivalent.</p>
</section>
<section id="a-zero-correlation-parameter-lmm-m_zcp" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="a-zero-correlation-parameter-lmm-m_zcp"><span class="header-section-number">4.4</span> A zero-correlation parameter LMM <code>m_zcp</code></h2>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="m_zcp1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="m_zcp1-1"><a href="#m_zcp1-1" aria-hidden="true" tabindex="-1"></a>f_zcp1 <span class="op">=</span> <span class="pp">@formula</span>(lrt <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span>  Block <span class="op">*</span> Target <span class="op">*</span> a1 <span class="op">+</span> <span class="fu">zerocorr</span>(<span class="fl">1</span> <span class="op">+</span> Block <span class="op">*</span> Target <span class="op">|</span> Subj) <span class="op">+</span> (<span class="fl">1</span> <span class="op">+</span> a1 <span class="op">|</span> Item));</span>
<span id="m_zcp1-2"><a href="#m_zcp1-2" aria-hidden="true" tabindex="-1"></a>m_zcp1 <span class="op">=</span> <span class="fu">fit</span>(MixedModel, f_zcp1, dat; contrasts);</span>
<span id="m_zcp1-3"><a href="#m_zcp1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="m_zcp1-4"><a href="#m_zcp1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(<span class="fu">issingular</span>(m_zcp1))</span>
<span id="m_zcp1-5"><a href="#m_zcp1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m_zcp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 423   Time: 0:00:00 ( 1.30 ms/it)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>false</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 8%">
<col style="width: 43%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Variance</th>
<th style="text-align: right;">Std.Dev</th>
<th style="text-align: right;">Corr.</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Subj</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0742213</td>
<td style="text-align: right;">0.2724359</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Block: 2nd Learning</td>
<td style="text-align: right;">0.0362340</td>
<td style="text-align: right;">0.1903522</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Block: Disruption</td>
<td style="text-align: right;">0.0156482</td>
<td style="text-align: right;">0.1250926</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Block: Recovery</td>
<td style="text-align: right;">0.0133091</td>
<td style="text-align: right;">0.1153651</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Target: Target syllable</td>
<td style="text-align: right;">0.0002450</td>
<td style="text-align: right;">0.0156512</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Block: 2nd Learning &amp; Target: Target syllable</td>
<td style="text-align: right;">0.0001920</td>
<td style="text-align: right;">0.0138565</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Block: Disruption &amp; Target: Target syllable</td>
<td style="text-align: right;">0.0032716</td>
<td style="text-align: right;">0.0571978</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Block: Recovery &amp; Target: Target syllable</td>
<td style="text-align: right;">0.0006676</td>
<td style="text-align: right;">0.0258384</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Item</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0009506</td>
<td style="text-align: right;">0.0308311</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.0006760</td>
<td style="text-align: right;">0.0259998</td>
<td style="text-align: right;">-0.83</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.0767203</td>
<td style="text-align: right;">0.2769844</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Again, check the equivalence.</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="m_zcp2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="m_zcp2-1"><a href="#m_zcp2-1" aria-hidden="true" tabindex="-1"></a>f_zcp2 <span class="op">=</span> <span class="pp">@formula</span>(lrt <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span> (trng<span class="op">+</span>drpt<span class="op">+</span>rcvr) <span class="op">*</span> trgt <span class="op">*</span> a1  <span class="op">+</span> </span>
<span id="m_zcp2-2"><a href="#m_zcp2-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">zerocorr</span>(<span class="fl">1</span> <span class="op">+</span> (trng<span class="op">+</span>drpt<span class="op">+</span>rcvr) <span class="op">*</span> trgt <span class="op">|</span> Subj) <span class="op">+</span> (<span class="fl">1</span> <span class="op">+</span> a1 <span class="op">|</span> Item));</span>
<span id="m_zcp2-3"><a href="#m_zcp2-3" aria-hidden="true" tabindex="-1"></a>m_zcp2 <span class="op">=</span> <span class="fu">fit</span>(MixedModel, f_zcp2, dat; contrasts);</span>
<span id="m_zcp2-4"><a href="#m_zcp2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="m_zcp2-5"><a href="#m_zcp2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(<span class="fu">issingular</span>(m_zcp2))</span>
<span id="m_zcp2-6"><a href="#m_zcp2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m_zcp2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 423   Time: 0:00:00 ( 0.84 ms/it)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>false</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="9">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Variance</th>
<th style="text-align: right;">Std.Dev</th>
<th style="text-align: right;">Corr.</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Subj</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0742213</td>
<td style="text-align: right;">0.2724359</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">trng</td>
<td style="text-align: right;">0.0362340</td>
<td style="text-align: right;">0.1903522</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">drpt</td>
<td style="text-align: right;">0.0156482</td>
<td style="text-align: right;">0.1250926</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">rcvr</td>
<td style="text-align: right;">0.0133091</td>
<td style="text-align: right;">0.1153651</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">trgt</td>
<td style="text-align: right;">0.0002450</td>
<td style="text-align: right;">0.0156512</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">trng &amp; trgt</td>
<td style="text-align: right;">0.0001920</td>
<td style="text-align: right;">0.0138565</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">drpt &amp; trgt</td>
<td style="text-align: right;">0.0032716</td>
<td style="text-align: right;">0.0571978</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">rcvr &amp; trgt</td>
<td style="text-align: right;">0.0006676</td>
<td style="text-align: right;">0.0258384</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Item</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0009506</td>
<td style="text-align: right;">0.0308311</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.0006760</td>
<td style="text-align: right;">0.0259998</td>
<td style="text-align: right;">-0.83</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.0767203</td>
<td style="text-align: right;">0.2769844</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="a-complex-parameter-lmm-m_cpx" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="a-complex-parameter-lmm-m_cpx"><span class="header-section-number">4.5</span> A complex parameter LMM <code>m_cpx</code></h2>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="m_cpx"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="m_cpx-1"><a href="#m_cpx-1" aria-hidden="true" tabindex="-1"></a>m_cpx <span class="op">=</span> <span class="kw">let</span></span>
<span id="m_cpx-2"><a href="#m_cpx-2" aria-hidden="true" tabindex="-1"></a>    form <span class="op">=</span> <span class="pp">@formula</span>(lrt <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span> trgt <span class="op">*</span> (trng<span class="op">+</span>drpt<span class="op">+</span>rcvr) <span class="op">*</span> a1  <span class="op">+</span> </span>
<span id="m_cpx-3"><a href="#m_cpx-3" aria-hidden="true" tabindex="-1"></a>                          (<span class="fl">1</span> <span class="op">+</span> trgt <span class="op">*</span> (trng<span class="op">+</span>drpt<span class="op">+</span>rcvr) <span class="op">|</span> Subj) <span class="op">+</span> (<span class="fl">1</span> <span class="op">+</span> a1 <span class="op">|</span> Item));</span>
<span id="m_cpx-4"><a href="#m_cpx-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(MixedModel, form, dat; contrasts);</span>
<span id="m_cpx-5"><a href="#m_cpx-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">end</span>;</span>
<span id="m_cpx-6"><a href="#m_cpx-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="m_cpx-7"><a href="#m_cpx-7" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(<span class="fu">issingular</span>(m_cpx))    <span class="co"># not ok</span></span>
<span id="m_cpx-8"><a href="#m_cpx-8" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(m_cpx.PCA[<span class="op">:</span>Subj])     <span class="co"># not ok</span></span>
<span id="m_cpx-9"><a href="#m_cpx-9" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(MixedModels.<span class="fu">likelihoodratiotest</span>(m_zcp2, m_cpx)) </span>
<span id="m_cpx-10"><a href="#m_cpx-10" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m_cpx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 1559      Time: 0:00:01 ( 0.97 ms/it)
  objective:  2353.248156967351</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>true</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Principal components based on correlation matrix</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)   1.0     .      .      .      .      .      .      .
 trgt         -1.0    1.0     .      .      .      .      .      .
 trng          0.35  -0.35   1.0     .      .      .      .      .
 drpt          0.06  -0.06   0.35   1.0     .      .      .      .
 rcvr         -0.42   0.42  -0.23  -0.48   1.0     .      .      .
 trgt &amp; trng   0.26  -0.26  -0.12   0.09  -0.16   1.0     .      .
 trgt &amp; drpt  -0.4    0.4   -0.07   0.14  -0.01  -0.76   1.0     .
 trgt &amp; rcvr   0.61  -0.61   0.16   0.04  -0.3    0.48  -0.85   1.0

Normalized cumulative variances:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.4411, 0.667, 0.8072, 0.9061, 0.9581, 1.0, 1.0, 1.0]

Component loadings
 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>               PC1    PC2    PC3    PC4    PC5    PC6    PC7    PC8
 (Intercept)  -0.46   0.14   0.36  -0.2   -0.28   0.12   0.05  -0.71
 trgt          0.46  -0.14  -0.36   0.2    0.28  -0.12  -0.05  -0.71
 trng         -0.19   0.43   0.17   0.76  -0.0   -0.4   -0.13   0.0
 drpt         -0.09   0.49  -0.59   0.15  -0.19   0.57   0.13  -0.0
 rcvr          0.26  -0.42   0.31   0.47  -0.39   0.51  -0.15   0.0
 trgt &amp; trng  -0.31  -0.36  -0.49  -0.01  -0.52  -0.34  -0.38   0.0
 trgt &amp; drpt   0.39   0.44   0.14  -0.29  -0.16   0.02  -0.72   0.0
 trgt &amp; rcvr  -0.46  -0.18  -0.04   0.08   0.6    0.33  -0.53   0.0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model Formulae
1: lrt ~ 1 + trng + drpt + rcvr + trgt + a1 + trng &amp; trgt + drpt &amp; trgt + rcvr &amp; trgt + trng &amp; a1 + drpt &amp; a1 + rcvr &amp; a1 + trgt &amp; a1 + trng &amp; trgt &amp; a1 + drpt &amp; trgt &amp; a1 + rcvr &amp; trgt &amp; a1 + MixedModels.ZeroCorr((1 + trng + drpt + rcvr + trgt + trng &amp; trgt + drpt &amp; trgt + rcvr &amp; trgt | Subj)) + (1 + a1 | Item)
2: lrt ~ 1 + trgt + trng + drpt + rcvr + a1 + trgt &amp; trng + trgt &amp; drpt + trgt &amp; rcvr + trgt &amp; a1 + trng &amp; a1 + drpt &amp; a1 + rcvr &amp; a1 + trgt &amp; trng &amp; a1 + trgt &amp; drpt &amp; a1 + trgt &amp; rcvr &amp; a1 + (1 + trgt + trng + drpt + rcvr + trgt &amp; trng + trgt &amp; drpt + trgt &amp; rcvr | Subj) + (1 + a1 | Item)
──────────────────────────────────────────────────
     model-dof  -2 logLik       χ²  χ²-dof  P(&gt;χ²)
──────────────────────────────────────────────────
[1]         28  2393.5710                         
[2]         56  2353.2482  40.3229      28  0.0619
──────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Variance</th>
<th style="text-align: right;">Std.Dev</th>
<th style="text-align: right;">Corr.</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Subj</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0758163</td>
<td style="text-align: right;">0.2753475</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">trgt</td>
<td style="text-align: right;">0.0001016</td>
<td style="text-align: right;">0.0100812</td>
<td style="text-align: right;">-1.00</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">trng</td>
<td style="text-align: right;">0.0335022</td>
<td style="text-align: right;">0.1830361</td>
<td style="text-align: right;">+0.35</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">drpt</td>
<td style="text-align: right;">0.0198161</td>
<td style="text-align: right;">0.1407696</td>
<td style="text-align: right;">+0.06</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">+0.35</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">rcvr</td>
<td style="text-align: right;">0.0191694</td>
<td style="text-align: right;">0.1384538</td>
<td style="text-align: right;">-0.42</td>
<td style="text-align: right;">+0.42</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">-0.48</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">trgt &amp; trng</td>
<td style="text-align: right;">0.0020619</td>
<td style="text-align: right;">0.0454081</td>
<td style="text-align: right;">+0.26</td>
<td style="text-align: right;">-0.26</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">+0.09</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">trgt &amp; drpt</td>
<td style="text-align: right;">0.0145505</td>
<td style="text-align: right;">0.1206256</td>
<td style="text-align: right;">-0.40</td>
<td style="text-align: right;">+0.40</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">+0.14</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.76</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">trgt &amp; rcvr</td>
<td style="text-align: right;">0.0085489</td>
<td style="text-align: right;">0.0924602</td>
<td style="text-align: right;">+0.61</td>
<td style="text-align: right;">-0.61</td>
<td style="text-align: right;">+0.16</td>
<td style="text-align: right;">+0.04</td>
<td style="text-align: right;">-0.30</td>
<td style="text-align: right;">+0.48</td>
<td style="text-align: right;">-0.85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Item</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.0004752</td>
<td style="text-align: right;">0.0217987</td>
<td style="text-align: right;">+NaN</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.0768485</td>
<td style="text-align: right;">0.2772155</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The deviance improves, but we end up with an overparameterized LMM. Remove the two small VCs of the three <code>Block</code> x <code>Target</code> interactions (i.e., the third contrast of the <code>Block</code> factor).</p>
</section>
<section id="a-parsimonious-parameter-lmm-m_prm" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="a-parsimonious-parameter-lmm-m_prm"><span class="header-section-number">4.6</span> A parsimonious parameter LMM <code>m_prm</code></h2>
<p>We remove one of the VC for <code>trgt</code> * <code>trng</code> contrast interaction, that is one of the three interaction terms.</p>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="m_prm1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="m_prm1-1"><a href="#m_prm1-1" aria-hidden="true" tabindex="-1"></a>m_prm1 <span class="op">=</span> <span class="kw">let</span></span>
<span id="m_prm1-2"><a href="#m_prm1-2" aria-hidden="true" tabindex="-1"></a>    form <span class="op">=</span> <span class="pp">@formula</span>(lrt <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span> trgt <span class="op">*</span> (trng<span class="op">+</span>drpt<span class="op">+</span>rcvr) <span class="op">*</span> a1  <span class="op">+</span> </span>
<span id="m_prm1-3"><a href="#m_prm1-3" aria-hidden="true" tabindex="-1"></a>                          (<span class="fl">1</span> <span class="op">+</span> trgt <span class="fu">*</span>(drpt <span class="op">+</span> rcvr) <span class="op">+</span> trng  <span class="op">|</span> Subj) <span class="op">+</span> </span>
<span id="m_prm1-4"><a href="#m_prm1-4" aria-hidden="true" tabindex="-1"></a>                          (<span class="fl">1</span> <span class="op">+</span> a1 <span class="op">|</span> Item));</span>
<span id="m_prm1-5"><a href="#m_prm1-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(MixedModel, form, dat; contrasts);</span>
<span id="m_prm1-6"><a href="#m_prm1-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">end</span>;</span>
<span id="m_prm1-7"><a href="#m_prm1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="m_prm1-8"><a href="#m_prm1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(<span class="fu">issingular</span>(m_prm1))  <span class="co"># not ok</span></span>
<span id="m_prm1-9"><a href="#m_prm1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(m_prm1.PCA[<span class="op">:</span>Subj])   <span class="co"># not ok</span></span>
<span id="m_prm1-10"><a href="#m_prm1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(MixedModels.<span class="fu">likelihoodratiotest</span>(m_zcp2, m_prm1, m_cpx)) </span>
<span id="m_prm1-11"><a href="#m_prm1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m_prm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 1317      Time: 0:00:01 ( 1.16 ms/it)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>true
Principal components based on correlation matrix
 (Intercept)   1.0     .      .      .      .      .      .
 trgt         -0.58   1.0     .      .      .      .      .
 drpt          0.04  -0.23   1.0     .      .      .      .
 rcvr         -0.41   0.21  -0.47   1.0     .      .      .
 trgt &amp; drpt  -0.42   0.3    0.21  -0.06   1.0     .      .
 trgt &amp; rcvr   0.65  -0.22   0.03  -0.29  -0.87   1.0     .
 trng          0.33  -0.32   0.32  -0.21  -0.12   0.22   1.0

Normalized cumulative variances:
[0.4076, 0.6504, 0.7761, 0.8828, 0.9633, 1.0, 1.0]

Component loadings
                PC1    PC2    PC3    PC4    PC5    PC6    PC7
 (Intercept)  -0.5    0.02  -0.05  -0.36  -0.37  -0.62  -0.3
 trgt          0.38   0.14   0.56   0.49  -0.35  -0.3   -0.26
 drpt         -0.14  -0.61   0.15   0.25   0.61  -0.36  -0.14
 rcvr          0.29   0.44  -0.56   0.23   0.27  -0.52   0.1
 trgt &amp; drpt   0.4   -0.49  -0.05  -0.23  -0.33  -0.3    0.59
 trgt &amp; rcvr  -0.49   0.29   0.35   0.24   0.07  -0.13   0.68
 trng         -0.3   -0.29  -0.47   0.64  -0.42   0.15   0.0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model Formulae
1: lrt ~ 1 + trng + drpt + rcvr + trgt + a1 + trng &amp; trgt + drpt &amp; trgt + rcvr &amp; trgt + trng &amp; a1 + drpt &amp; a1 + rcvr &amp; a1 + trgt &amp; a1 + trng &amp; trgt &amp; a1 + drpt &amp; trgt &amp; a1 + rcvr &amp; trgt &amp; a1 + MixedModels.ZeroCorr((1 + trng + drpt + rcvr + trgt + trng &amp; trgt + drpt &amp; trgt + rcvr &amp; trgt | Subj)) + (1 + a1 | Item)
2: lrt ~ 1 + trgt + trng + drpt + rcvr + a1 + trgt &amp; trng + trgt &amp; drpt + trgt &amp; rcvr + trgt &amp; a1 + trng &amp; a1 + drpt &amp; a1 + rcvr &amp; a1 + trgt &amp; trng &amp; a1 + trgt &amp; drpt &amp; a1 + trgt &amp; rcvr &amp; a1 + (1 + trgt + drpt + rcvr + trgt &amp; drpt + trgt &amp; rcvr + trng | Subj) + (1 + a1 | Item)
3: lrt ~ 1 + trgt + trng + drpt + rcvr + a1 + trgt &amp; trng + trgt &amp; drpt + trgt &amp; rcvr + trgt &amp; a1 + trng &amp; a1 + drpt &amp; a1 + rcvr &amp; a1 + trgt &amp; trng &amp; a1 + trgt &amp; drpt &amp; a1 + trgt &amp; rcvr &amp; a1 + (1 + trgt + trng + drpt + rcvr + trgt &amp; trng + trgt &amp; drpt + trgt &amp; rcvr | Subj) + (1 + a1 | Item)
───────────────────────────────────────────────────
     model-dof  -2 logLik        χ²  χ²-dof  P(&gt;χ²)
───────────────────────────────────────────────────
[1]         28  2393.5710                          
[2]         48  2334.2053   59.3657      20  &lt;1e-05
[3]         56  2353.2482  -19.0428       8     NaN
───────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="11">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Variance</th>
<th style="text-align: right;">Std.Dev</th>
<th style="text-align: right;">Corr.</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Subj</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0759736</td>
<td style="text-align: right;">0.2756332</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">trgt</td>
<td style="text-align: right;">0.0003130</td>
<td style="text-align: right;">0.0176916</td>
<td style="text-align: right;">-0.58</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">drpt</td>
<td style="text-align: right;">0.0194336</td>
<td style="text-align: right;">0.1394044</td>
<td style="text-align: right;">+0.04</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">rcvr</td>
<td style="text-align: right;">0.0188222</td>
<td style="text-align: right;">0.1371939</td>
<td style="text-align: right;">-0.41</td>
<td style="text-align: right;">+0.21</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">trgt &amp; drpt</td>
<td style="text-align: right;">0.0109847</td>
<td style="text-align: right;">0.1048077</td>
<td style="text-align: right;">-0.42</td>
<td style="text-align: right;">+0.30</td>
<td style="text-align: right;">+0.21</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">trgt &amp; rcvr</td>
<td style="text-align: right;">0.0075839</td>
<td style="text-align: right;">0.0870855</td>
<td style="text-align: right;">+0.65</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">+0.03</td>
<td style="text-align: right;">-0.29</td>
<td style="text-align: right;">-0.87</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">trng</td>
<td style="text-align: right;">0.0354710</td>
<td style="text-align: right;">0.1883373</td>
<td style="text-align: right;">+0.33</td>
<td style="text-align: right;">-0.32</td>
<td style="text-align: right;">+0.32</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">+0.22</td>
</tr>
<tr class="even">
<td style="text-align: left;">Item</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0008077</td>
<td style="text-align: right;">0.0284200</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.0006179</td>
<td style="text-align: right;">0.0248567</td>
<td style="text-align: right;">-0.94</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.0761745</td>
<td style="text-align: right;">0.2759973</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We don’t lose goodness of fit, but are still overparameterized. We remove CPs for <code>Target</code>.</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="m_prm2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="m_prm2-1"><a href="#m_prm2-1" aria-hidden="true" tabindex="-1"></a>m_prm2 <span class="op">=</span> <span class="kw">let</span></span>
<span id="m_prm2-2"><a href="#m_prm2-2" aria-hidden="true" tabindex="-1"></a>    form <span class="op">=</span> <span class="pp">@formula</span>(lrt <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span> trgt <span class="op">*</span> (trng<span class="op">+</span>drpt<span class="op">+</span>rcvr) <span class="op">*</span> a1  <span class="op">+</span> </span>
<span id="m_prm2-3"><a href="#m_prm2-3" aria-hidden="true" tabindex="-1"></a>                          (<span class="fl">1</span> <span class="op">+</span> drpt <span class="op">+</span> rcvr <span class="op">+</span> trng <span class="op">+</span> drpt<span class="op">&amp;</span>trgt <span class="op">+</span> rcvr<span class="op">&amp;</span>trgt  <span class="op">|</span> Subj) <span class="op">+</span> </span>
<span id="m_prm2-4"><a href="#m_prm2-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">zerocorr</span>(<span class="fl">0</span> <span class="op">+</span> trgt  <span class="op">|</span> Subj) <span class="op">+</span></span>
<span id="m_prm2-5"><a href="#m_prm2-5" aria-hidden="true" tabindex="-1"></a>                          (<span class="fl">1</span> <span class="op">+</span> a1 <span class="op">|</span> Item));</span>
<span id="m_prm2-6"><a href="#m_prm2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(MixedModel, form, dat; contrasts);</span>
<span id="m_prm2-7"><a href="#m_prm2-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">end</span>;</span>
<span id="m_prm2-8"><a href="#m_prm2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="m_prm2-9"><a href="#m_prm2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(<span class="fu">issingular</span>(m_prm2))  <span class="co">#  ok</span></span>
<span id="m_prm2-10"><a href="#m_prm2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(m_prm2.PCA[<span class="op">:</span>Subj])   <span class="co">#  ok</span></span>
<span id="m_prm2-11"><a href="#m_prm2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(MixedModels.<span class="fu">likelihoodratiotest</span>(m_zcp2, m_prm2,  m_cpx)) </span>
<span id="m_prm2-12"><a href="#m_prm2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m_prm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 1024      Time: 0:00:00 ( 0.90 ms/it)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>false
Principal components based on correlation matrix
 (Intercept)   1.0     .      .      .      .      .     .
 drpt          0.04   1.0     .      .      .      .     .
 rcvr         -0.41  -0.47   1.0     .      .      .     .
 trng          0.33   0.34  -0.22   1.0     .      .     .
 drpt &amp; trgt  -0.36   0.26  -0.1   -0.07   1.0     .     .
 rcvr &amp; trgt   0.59  -0.01  -0.27   0.12  -0.87   1.0    .
 trgt          0.0    0.0    0.0    0.0    0.0    0.0   1.0

Normalized cumulative variances:
[0.3441, 0.5973, 0.7402, 0.8568, 0.9478, 0.9939, 1.0]

Component loadings
                PC1    PC2   PC3    PC4    PC5    PC6    PC7
 (Intercept)  -0.52   0.07  0.0   -0.04   0.61  -0.58   0.15
 drpt         -0.09   0.61  0.0   -0.05  -0.62  -0.47   0.11
 rcvr          0.3   -0.49  0.0    0.52  -0.16  -0.58  -0.17
 trng         -0.26   0.36  0.0    0.83   0.09   0.3   -0.08
 drpt &amp; trgt   0.47   0.44  0.0   -0.1    0.37  -0.14  -0.65
 rcvr &amp; trgt  -0.59  -0.21  0.0   -0.14  -0.27   0.03  -0.72
 trgt          0.0    0.0   1.0    0.0    0.0    0.0    0.0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model Formulae
1: lrt ~ 1 + trng + drpt + rcvr + trgt + a1 + trng &amp; trgt + drpt &amp; trgt + rcvr &amp; trgt + trng &amp; a1 + drpt &amp; a1 + rcvr &amp; a1 + trgt &amp; a1 + trng &amp; trgt &amp; a1 + drpt &amp; trgt &amp; a1 + rcvr &amp; trgt &amp; a1 + MixedModels.ZeroCorr((1 + trng + drpt + rcvr + trgt + trng &amp; trgt + drpt &amp; trgt + rcvr &amp; trgt | Subj)) + (1 + a1 | Item)
2: lrt ~ 1 + trgt + trng + drpt + rcvr + a1 + trgt &amp; trng + trgt &amp; drpt + trgt &amp; rcvr + trgt &amp; a1 + trng &amp; a1 + drpt &amp; a1 + rcvr &amp; a1 + trgt &amp; trng &amp; a1 + trgt &amp; drpt &amp; a1 + trgt &amp; rcvr &amp; a1 + (1 + drpt + rcvr + trng + drpt &amp; trgt + rcvr &amp; trgt | Subj) + MixedModels.ZeroCorr((0 + trgt | Subj)) + (1 + a1 | Item)
3: lrt ~ 1 + trgt + trng + drpt + rcvr + a1 + trgt &amp; trng + trgt &amp; drpt + trgt &amp; rcvr + trgt &amp; a1 + trng &amp; a1 + drpt &amp; a1 + rcvr &amp; a1 + trgt &amp; trng &amp; a1 + trgt &amp; drpt &amp; a1 + trgt &amp; rcvr &amp; a1 + (1 + trgt + trng + drpt + rcvr + trgt &amp; trng + trgt &amp; drpt + trgt &amp; rcvr | Subj) + (1 + a1 | Item)
───────────────────────────────────────────────────
     model-dof  -2 logLik        χ²  χ²-dof  P(&gt;χ²)
───────────────────────────────────────────────────
[1]         28  2393.5710                          
[2]         42  2341.3448   52.2262      14  &lt;1e-05
[3]         56  2353.2482  -11.9033      14     NaN
───────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="12">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Variance</th>
<th style="text-align: right;">Std.Dev</th>
<th style="text-align: right;">Corr.</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Subj</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0758184</td>
<td style="text-align: right;">0.2753514</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">drpt</td>
<td style="text-align: right;">0.0193610</td>
<td style="text-align: right;">0.1391437</td>
<td style="text-align: right;">+0.04</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">rcvr</td>
<td style="text-align: right;">0.0188449</td>
<td style="text-align: right;">0.1372766</td>
<td style="text-align: right;">-0.41</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">trng</td>
<td style="text-align: right;">0.0351224</td>
<td style="text-align: right;">0.1874096</td>
<td style="text-align: right;">+0.33</td>
<td style="text-align: right;">+0.34</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">drpt &amp; trgt</td>
<td style="text-align: right;">0.0099373</td>
<td style="text-align: right;">0.0996859</td>
<td style="text-align: right;">-0.36</td>
<td style="text-align: right;">+0.26</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">rcvr &amp; trgt</td>
<td style="text-align: right;">0.0066343</td>
<td style="text-align: right;">0.0814510</td>
<td style="text-align: right;">+0.59</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">+0.12</td>
<td style="text-align: right;">-0.87</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">trgt</td>
<td style="text-align: right;">0.0002653</td>
<td style="text-align: right;">0.0162888</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Item</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0008257</td>
<td style="text-align: right;">0.0287358</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.0006739</td>
<td style="text-align: right;">0.0259592</td>
<td style="text-align: right;">-0.93</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.0762064</td>
<td style="text-align: right;">0.2760551</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Check the <code>Item</code>-related CP. It is very large, might be spurious.</p>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="m_prm3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="m_prm3-1"><a href="#m_prm3-1" aria-hidden="true" tabindex="-1"></a>m_prm3 <span class="op">=</span> <span class="kw">let</span></span>
<span id="m_prm3-2"><a href="#m_prm3-2" aria-hidden="true" tabindex="-1"></a>    form <span class="op">=</span> <span class="pp">@formula</span>(lrt <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span> trgt <span class="op">*</span> (trng<span class="op">+</span>drpt<span class="op">+</span>rcvr) <span class="op">*</span> a1  <span class="op">+</span> </span>
<span id="m_prm3-3"><a href="#m_prm3-3" aria-hidden="true" tabindex="-1"></a>                          (<span class="fl">1</span> <span class="op">+</span> drpt <span class="op">+</span> rcvr <span class="op">+</span> trng <span class="op">+</span> drpt<span class="op">&amp;</span>trgt <span class="op">+</span> rcvr<span class="op">&amp;</span>trgt  <span class="op">|</span> Subj) <span class="op">+</span> </span>
<span id="m_prm3-4"><a href="#m_prm3-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">zerocorr</span>(<span class="fl">0</span> <span class="op">+</span> trgt  <span class="op">|</span> Subj) <span class="op">+</span></span>
<span id="m_prm3-5"><a href="#m_prm3-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">zerocorr</span>(<span class="fl">1</span> <span class="op">+</span> a1 <span class="op">|</span> Item));</span>
<span id="m_prm3-6"><a href="#m_prm3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(MixedModel, form, dat; contrasts);</span>
<span id="m_prm3-7"><a href="#m_prm3-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">end</span>;</span>
<span id="m_prm3-8"><a href="#m_prm3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="m_prm3-9"><a href="#m_prm3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(<span class="fu">issingular</span>(m_prm3))  <span class="co"># ok</span></span>
<span id="m_prm3-10"><a href="#m_prm3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(m_prm3.PCA[<span class="op">:</span>Subj])   <span class="co"># ok</span></span>
<span id="m_prm3-11"><a href="#m_prm3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(MixedModels.<span class="fu">likelihoodratiotest</span>(m_zcp2, m_prm3, m_prm2, m_cpx)) </span>
<span id="m_prm3-12"><a href="#m_prm3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m_prm3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Minimizing 1150      Time: 0:00:01 ( 0.91 ms/it)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>false
Principal components based on correlation matrix
 (Intercept)   1.0     .      .      .      .      .     .
 drpt          0.04   1.0     .      .      .      .     .
 rcvr         -0.41  -0.47   1.0     .      .      .     .
 trng          0.33   0.34  -0.21   1.0     .      .     .
 drpt &amp; trgt  -0.37   0.25  -0.08  -0.07   1.0     .     .
 rcvr &amp; trgt   0.61   0.04  -0.31   0.13  -0.86   1.0    .
 trgt          0.0    0.0    0.0    0.0    0.0    0.0   1.0

Normalized cumulative variances:
[0.35, 0.598, 0.7409, 0.8585, 0.9488, 0.9943, 1.0]

Component loadings
                PC1    PC2   PC3    PC4    PC5    PC6    PC7
 (Intercept)  -0.52   0.03  0.0   -0.01   0.61  -0.57   0.16
 drpt         -0.12   0.62  0.0   -0.06  -0.61  -0.47   0.12
 rcvr          0.33  -0.47  0.0    0.52  -0.19  -0.58  -0.18
 trng         -0.27   0.35  0.0    0.83   0.08   0.31  -0.08
 drpt &amp; trgt   0.45   0.47  0.0   -0.1    0.38  -0.15  -0.63
 rcvr &amp; trgt  -0.58  -0.22  0.0   -0.15  -0.26   0.03  -0.72
 trgt          0.0    0.0   1.0    0.0    0.0    0.0    0.0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model Formulae
1: lrt ~ 1 + trng + drpt + rcvr + trgt + a1 + trng &amp; trgt + drpt &amp; trgt + rcvr &amp; trgt + trng &amp; a1 + drpt &amp; a1 + rcvr &amp; a1 + trgt &amp; a1 + trng &amp; trgt &amp; a1 + drpt &amp; trgt &amp; a1 + rcvr &amp; trgt &amp; a1 + MixedModels.ZeroCorr((1 + trng + drpt + rcvr + trgt + trng &amp; trgt + drpt &amp; trgt + rcvr &amp; trgt | Subj)) + (1 + a1 | Item)
2: lrt ~ 1 + trgt + trng + drpt + rcvr + a1 + trgt &amp; trng + trgt &amp; drpt + trgt &amp; rcvr + trgt &amp; a1 + trng &amp; a1 + drpt &amp; a1 + rcvr &amp; a1 + trgt &amp; trng &amp; a1 + trgt &amp; drpt &amp; a1 + trgt &amp; rcvr &amp; a1 + (1 + drpt + rcvr + trng + drpt &amp; trgt + rcvr &amp; trgt | Subj) + MixedModels.ZeroCorr((0 + trgt | Subj)) + MixedModels.ZeroCorr((1 + a1 | Item))
3: lrt ~ 1 + trgt + trng + drpt + rcvr + a1 + trgt &amp; trng + trgt &amp; drpt + trgt &amp; rcvr + trgt &amp; a1 + trng &amp; a1 + drpt &amp; a1 + rcvr &amp; a1 + trgt &amp; trng &amp; a1 + trgt &amp; drpt &amp; a1 + trgt &amp; rcvr &amp; a1 + (1 + drpt + rcvr + trng + drpt &amp; trgt + rcvr &amp; trgt | Subj) + MixedModels.ZeroCorr((0 + trgt | Subj)) + (1 + a1 | Item)
4: lrt ~ 1 + trgt + trng + drpt + rcvr + a1 + trgt &amp; trng + trgt &amp; drpt + trgt &amp; rcvr + trgt &amp; a1 + trng &amp; a1 + drpt &amp; a1 + rcvr &amp; a1 + trgt &amp; trng &amp; a1 + trgt &amp; drpt &amp; a1 + trgt &amp; rcvr &amp; a1 + (1 + trgt + trng + drpt + rcvr + trgt &amp; trng + trgt &amp; drpt + trgt &amp; rcvr | Subj) + (1 + a1 | Item)
───────────────────────────────────────────────────
     model-dof  -2 logLik        χ²  χ²-dof  P(&gt;χ²)
───────────────────────────────────────────────────
[1]         28  2393.5710                          
[2]         41  2356.2006   37.3704      13  0.0004
[3]         42  2341.3448   14.8558       1  0.0001
[4]         56  2353.2482  -11.9033      14     NaN
───────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Variance</th>
<th style="text-align: right;">Std.Dev</th>
<th style="text-align: right;">Corr.</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Subj</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0760885</td>
<td style="text-align: right;">0.2758414</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">drpt</td>
<td style="text-align: right;">0.0193888</td>
<td style="text-align: right;">0.1392438</td>
<td style="text-align: right;">+0.04</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">rcvr</td>
<td style="text-align: right;">0.0189470</td>
<td style="text-align: right;">0.1376481</td>
<td style="text-align: right;">-0.41</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">trng</td>
<td style="text-align: right;">0.0351032</td>
<td style="text-align: right;">0.1873585</td>
<td style="text-align: right;">+0.33</td>
<td style="text-align: right;">+0.34</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">drpt &amp; trgt</td>
<td style="text-align: right;">0.0091686</td>
<td style="text-align: right;">0.0957527</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">+0.25</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">rcvr &amp; trgt</td>
<td style="text-align: right;">0.0059764</td>
<td style="text-align: right;">0.0773072</td>
<td style="text-align: right;">+0.61</td>
<td style="text-align: right;">+0.04</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">+0.13</td>
<td style="text-align: right;">-0.86</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">trgt</td>
<td style="text-align: right;">0.0002813</td>
<td style="text-align: right;">0.0167717</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Item</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0006680</td>
<td style="text-align: right;">0.0258467</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.0005356</td>
<td style="text-align: right;">0.0231426</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.0763227</td>
<td style="text-align: right;">0.2762656</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Perhaps not. We stay with LMM <code>m_prm2</code></p>
</section>
<section id="compare-models-with-goodness-of-fit-statistics." class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="compare-models-with-goodness-of-fit-statistics."><span class="header-section-number">4.7</span> Compare models with goodness-of-fit statistics.</h2>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> mods <span class="op">=</span> [m_zcp2, m_prm2, m_prm1, m_cpx];</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">DataFrame</span>(;</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span>[<span class="op">:</span>m_zcp2, <span class="op">:</span>m_prm2, <span class="op">:</span>m_prm1, <span class="op">:</span>m_cpx],</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    pars<span class="op">=</span><span class="fu">dof</span>.(mods),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    geomdof<span class="op">=</span><span class="fu">round</span>.(<span class="dt">Int</span>, (sum <span class="op">∘</span> leverage).(mods)),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    AIC<span class="op">=</span><span class="fu">round</span>.(<span class="dt">Int</span>, <span class="fu">aic</span>.(mods)),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    AICc<span class="op">=</span><span class="fu">round</span>.(<span class="dt">Int</span>, <span class="fu">aicc</span>.(mods)),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    BIC<span class="op">=</span><span class="fu">round</span>.(<span class="dt">Int</span>, <span class="fu">bic</span>.(mods)),</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">

<div class="data-frame"><p>4 rows × 6 columns</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>model</th><th>pars</th><th>geomdof</th><th>AIC</th><th>AICc</th><th>BIC</th></tr><tr><th></th><th title="Symbol">Symbol</th><th title="Int64">Int64</th><th title="Int64">Int64</th><th title="Int64">Int64</th><th title="Int64">Int64</th><th title="Int64">Int64</th></tr></thead><tbody><tr><th>1</th><td>m_zcp2</td><td>28</td><td>292</td><td>2450</td><td>2450</td><td>2639</td></tr><tr><th>2</th><td>m_prm2</td><td>42</td><td>287</td><td>2425</td><td>2426</td><td>2709</td></tr><tr><th>3</th><td>m_prm1</td><td>48</td><td>282</td><td>2430</td><td>2431</td><td>2754</td></tr><tr><th>4</th><td>m_cpx</td><td>56</td><td>259</td><td>2465</td><td>2466</td><td>2843</td></tr></tbody></table></div>
</div>
</div>
<p>LMM <code>m_prm2</code> is a defensible solution according to <span class="math inline">\(\Delta\)</span> AIC, <span class="math inline">\(\Delta\)</span> BIC suggests we should not bother with CPs.</p>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftable</span>(m_prm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">z</th>
<th style="text-align: left;">Pr(&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">7.68255</td>
<td style="text-align: right;">0.0387612</td>
<td style="text-align: right;">198.20</td>
<td style="text-align: left;">&lt;1e-99</td>
</tr>
<tr class="even">
<td style="text-align: left;">trgt</td>
<td style="text-align: right;">-0.00948231</td>
<td style="text-align: right;">0.00442251</td>
<td style="text-align: right;">-2.14</td>
<td style="text-align: left;">0.0320</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trng</td>
<td style="text-align: right;">-0.0841453</td>
<td style="text-align: right;">0.027927</td>
<td style="text-align: right;">-3.01</td>
<td style="text-align: left;">0.0026</td>
</tr>
<tr class="even">
<td style="text-align: left;">drpt</td>
<td style="text-align: right;">0.042882</td>
<td style="text-align: right;">0.0228889</td>
<td style="text-align: right;">1.87</td>
<td style="text-align: left;">0.0610</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rcvr</td>
<td style="text-align: right;">-0.0370301</td>
<td style="text-align: right;">0.0226357</td>
<td style="text-align: right;">-1.64</td>
<td style="text-align: left;">0.1019</td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">-0.0922378</td>
<td style="text-align: right;">0.0338572</td>
<td style="text-align: right;">-2.72</td>
<td style="text-align: left;">0.0064</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trgt &amp; trng</td>
<td style="text-align: right;">-0.00176218</td>
<td style="text-align: right;">0.00963316</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: left;">0.8549</td>
</tr>
<tr class="even">
<td style="text-align: left;">trgt &amp; drpt</td>
<td style="text-align: right;">-0.0199304</td>
<td style="text-align: right;">0.0181574</td>
<td style="text-align: right;">-1.10</td>
<td style="text-align: left;">0.2724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trgt &amp; rcvr</td>
<td style="text-align: right;">-0.00411495</td>
<td style="text-align: right;">0.0162153</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: left;">0.7997</td>
</tr>
<tr class="even">
<td style="text-align: left;">trgt &amp; a1</td>
<td style="text-align: right;">-0.00874275</td>
<td style="text-align: right;">0.00388989</td>
<td style="text-align: right;">-2.25</td>
<td style="text-align: left;">0.0246</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trng &amp; a1</td>
<td style="text-align: right;">0.041405</td>
<td style="text-align: right;">0.0244048</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: left;">0.0898</td>
</tr>
<tr class="even">
<td style="text-align: left;">drpt &amp; a1</td>
<td style="text-align: right;">0.0287418</td>
<td style="text-align: right;">0.0198971</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: left;">0.1486</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rcvr &amp; a1</td>
<td style="text-align: right;">-0.0208158</td>
<td style="text-align: right;">0.0197051</td>
<td style="text-align: right;">-1.06</td>
<td style="text-align: left;">0.2908</td>
</tr>
<tr class="even">
<td style="text-align: left;">trgt &amp; trng &amp; a1</td>
<td style="text-align: right;">-0.00234866</td>
<td style="text-align: right;">0.00840934</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: left;">0.7800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trgt &amp; drpt &amp; a1</td>
<td style="text-align: right;">0.0171544</td>
<td style="text-align: right;">0.0158654</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: left;">0.2796</td>
</tr>
<tr class="even">
<td style="text-align: left;">trgt &amp; rcvr &amp; a1</td>
<td style="text-align: right;">0.00435316</td>
<td style="text-align: right;">0.0141863</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: left;">0.7590</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="pruning-fixed-effects" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="pruning-fixed-effects"><span class="header-section-number">4.8</span> Pruning fixed-effects</h2>
<p>There is an option of pruning some higher-order interactions.</p>
</section>
<section id="diagnostic-plots" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="diagnostic-plots"><span class="header-section-number">4.9</span> Diagnostic plots</h2>
<p>Various visualizations are used to check whether or not data are <em>defensibly</em> modeled with an LMM. They may lead to removal of outliers, transformations of the dependent variable, and deliver valuable heuristic information to be followed up with exploratory post-hoc analyses or ideally replication of new insights gained this way. In practice, it appears that only severe violations will stop people from reporting a model.</p>
<section id="residuals-over-fitted" class="level3" data-number="4.9.1">
<h3 data-number="4.9.1" class="anchored" data-anchor-id="residuals-over-fitted"><span class="header-section-number">4.9.1</span> Residuals over fitted</h3>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(<span class="fu">fitted</span>(m_prm2), <span class="fu">residuals</span>(m_prm2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<p><img src="Hofmann_Maulwurf_Julia_1_files/figure-html/cell-16-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>Looks like we missed some fast response times.</p>
</section>
<section id="q-q-plot" class="level3" data-number="4.9.2">
<h3 data-number="4.9.2" class="anchored" data-anchor-id="q-q-plot"><span class="header-section-number">4.9.2</span> Q-Q plot</h3>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(m_prm2; qqline<span class="op">=:</span>none)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">
<p><img src="Hofmann_Maulwurf_Julia_1_files/figure-html/cell-17-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>Hm?</p>
</section>
<section id="residual-distributions-observed-vs.-theoretical" class="level3" data-number="4.9.3">
<h3 data-number="4.9.3" class="anchored" data-anchor-id="residual-distributions-observed-vs.-theoretical"><span class="header-section-number">4.9.3</span> Residual distributions: observed vs.&nbsp;theoretical</h3>
<p>Curves for residulas based on observed and theoretical values should correspond.</p>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  n <span class="op">=</span> <span class="fu">nrow</span>(dat)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  dat_rz <span class="op">=</span> (;</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    value<span class="op">=</span><span class="fu">vcat</span>(<span class="fu">residuals</span>(m_prm2) <span class="op">./</span> <span class="fu">std</span>(<span class="fu">residuals</span>(m_prm2)), <span class="fu">randn</span>(n)),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    curve<span class="op">=</span><span class="fu">repeat</span>([<span class="st">"residual"</span>, <span class="st">"normal"</span>]; inner<span class="op">=</span>n),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw</span>(</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data</span>(dat_rz) <span class="op">*</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapping</span>(<span class="op">:</span>value; color<span class="op">=:</span>curve) <span class="op">*</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">density</span>(; bandwidth<span class="op">=</span><span class="fl">0.1</span>);</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="18">
<div id="fig-stdresidm1dens" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Hofmann_Maulwurf_Julia_1_files/figure-html/fig-stdresidm1dens-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure 1: Kernel density plot of the standardized residuals for model m1 versus a standard normal</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>They are a bit too narrow.</p>
</section>
</section>
<section id="conditional-means-of-random-effects" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="conditional-means-of-random-effects"><span class="header-section-number">4.10</span> Conditional means of random effects</h2>
<section id="subject-related-conditional-means-of-random-effects" class="level3" data-number="4.10.1">
<h3 data-number="4.10.1" class="anchored" data-anchor-id="subject-related-conditional-means-of-random-effects"><span class="header-section-number">4.10.1</span> Subject-related conditional means of random effects</h3>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>cm_Subj <span class="op">=</span> <span class="fu">first</span>(<span class="fu">ranefinfo</span>(m_prm2))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">caterpillar!</span>(<span class="fu">Figure</span>(; resolution<span class="op">=</span>(<span class="fl">800</span>, <span class="fl">1200</span>)), cm_Subj; orderby<span class="op">=</span><span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">
<div id="fig-m2caterpillar-subj" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Hofmann_Maulwurf_Julia_1_files/figure-html/fig-m2caterpillar-subj-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure 2: Prediction intervals on subject random effects for model m_prm2</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="borrowing-strength-plots" class="level3" data-number="4.10.2">
<h3 data-number="4.10.2" class="anchored" data-anchor-id="borrowing-strength-plots"><span class="header-section-number">4.10.2</span> Borrowing-strength plots</h3>
<p>Shrinkage refers to the adjustment of subject-level or item-level predictions by taking population estimates into account. The further a subject’s/item’s estimate is from the fixed effect or the more variable or less reliable the subject’s/item’s estimate, the more the prediction will be shrunk towards the population estimate. Alternative terms for shrinkage are “borrowing strength” (Tukey) and regularization. My favorite is actually Tukey’s because indeed we borrow strength from the population estimates to make predictions for individual subjects’ effects. The goal of this section to illustrate the results of borrowing strength.</p>
<p>Subject-related conditional means of random effects revealed information about individual differences beyond fixed effects. Would these results also be visible in <em>unconditional</em> means, that is when we compute GM and experimental effects <em>within</em> subjects (i.e., as fixed effects) without borrowing strength from the population estimates?</p>
<p>In the following plots, effect estimates based on alone on each subject’s data (i.e., no pooling of data, no borrowing of strength) are plotted in pink and the subjects’ conditional means shown in the caterpillar plots are plotted in blue. The arrows indicate how much a subject’s prediction is changed by borrowing strength from knowledge of the population estimates.</p>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shrinkageplot!</span>(<span class="fu">Figure</span>(; resolution<span class="op">=</span>(<span class="fl">1000</span>, <span class="fl">1200</span>)), m_prm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<div id="fig-shrinkage" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Hofmann_Maulwurf_Julia_1_files/figure-html/fig-shrinkage-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure 3: Shrinkage plots of the subject random effects in model m_prm2</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>There is an outlier subject</p>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> <span class="fu">raneftables</span>(m_prm2);   </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">DataFrame</span>(cm.Subj), [<span class="st">"(Intercept)"</span>, <span class="op">:</span>trng, <span class="st">"drpt &amp; trgt"</span>])</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">DataFrame</span>(cm.Subj), <span class="op">:</span>trng)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">

<div class="data-frame"><p>52 rows × 8 columns (omitted printing of 1 columns)</p><table class="data-frame table table-sm table-striped"><thead><tr><th></th><th>Subj</th><th>(Intercept)</th><th>drpt</th><th>rcvr</th><th>trng</th><th>drpt &amp; trgt</th><th>rcvr &amp; trgt</th></tr><tr><th></th><th title="String">String</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>p10</td><td>-0.665205</td><td>-0.0800021</td><td>0.176745</td><td>-0.502914</td><td>0.325052</td><td>-0.281757</td></tr><tr><th>2</th><td>p14</td><td>-0.517112</td><td>0.14952</td><td>-0.104295</td><td>-0.380469</td><td>0.086542</td><td>-0.039673</td></tr><tr><th>3</th><td>p76</td><td>0.0792821</td><td>-0.100545</td><td>0.104827</td><td>-0.309579</td><td>-0.0285149</td><td>0.0205477</td></tr><tr><th>4</th><td>p02</td><td>-0.62199</td><td>-0.196976</td><td>0.260471</td><td>-0.251645</td><td>0.0704479</td><td>-0.126552</td></tr><tr><th>5</th><td>p36</td><td>0.421389</td><td>-0.0364937</td><td>0.0872609</td><td>-0.23188</td><td>-0.169039</td><td>0.145339</td></tr><tr><th>6</th><td>p39</td><td>0.291847</td><td>-0.130869</td><td>0.143613</td><td>-0.200886</td><td>-0.0192557</td><td>0.00246612</td></tr><tr><th>7</th><td>p74</td><td>-0.32949</td><td>-0.0607277</td><td>0.0913175</td><td>-0.179355</td><td>0.0671141</td><td>-0.0858553</td></tr><tr><th>8</th><td>p67</td><td>0.0383209</td><td>0.00117178</td><td>-0.0194511</td><td>-0.155026</td><td>0.0331259</td><td>-0.0117621</td></tr><tr><th>9</th><td>p06</td><td>-0.237699</td><td>0.1394</td><td>0.0262592</td><td>-0.117296</td><td>-0.0667849</td><td>0.0402211</td></tr><tr><th>10</th><td>p54</td><td>0.313194</td><td>-0.161994</td><td>0.0465869</td><td>-0.116641</td><td>-0.0367882</td><td>0.041186</td></tr><tr><th>11</th><td>p23</td><td>-0.0288483</td><td>-0.0710821</td><td>0.0526738</td><td>-0.103859</td><td>-0.126986</td><td>0.0803622</td></tr><tr><th>12</th><td>p42</td><td>-0.0973893</td><td>0.288236</td><td>-0.166533</td><td>-0.103742</td><td>0.121401</td><td>-0.0337996</td></tr><tr><th>13</th><td>p59</td><td>0.421664</td><td>0.0211079</td><td>-0.255656</td><td>-0.102922</td><td>-0.0123755</td><td>0.0650118</td></tr><tr><th>14</th><td>p45</td><td>-0.363685</td><td>-0.295748</td><td>0.169723</td><td>-0.0975862</td><td>0.0435332</td><td>-0.0933336</td></tr><tr><th>15</th><td>p30</td><td>-0.32996</td><td>-0.149975</td><td>-0.0897773</td><td>-0.087896</td><td>-0.0134227</td><td>-0.00936371</td></tr><tr><th>16</th><td>p83</td><td>-0.230433</td><td>-0.0531699</td><td>-0.160464</td><td>-0.070261</td><td>0.0131958</td><td>-0.00839001</td></tr><tr><th>17</th><td>p84</td><td>-0.389884</td><td>-0.202825</td><td>0.444843</td><td>-0.0491376</td><td>-0.199297</td><td>0.0205136</td></tr><tr><th>18</th><td>p72</td><td>0.176315</td><td>-0.0684724</td><td>-0.0523524</td><td>-0.0387584</td><td>-0.119482</td><td>0.118094</td></tr><tr><th>19</th><td>p12</td><td>-0.148146</td><td>-0.0448133</td><td>0.0522883</td><td>-0.028447</td><td>-0.0671528</td><td>0.0361246</td></tr><tr><th>20</th><td>p04</td><td>0.138248</td><td>-0.0448304</td><td>0.0391371</td><td>-0.0278238</td><td>-0.00323538</td><td>0.0044312</td></tr><tr><th>21</th><td>p77</td><td>0.134278</td><td>-0.0965386</td><td>0.0522906</td><td>-0.0217913</td><td>-0.0800927</td><td>0.0499895</td></tr><tr><th>22</th><td>p69</td><td>0.104377</td><td>-0.0392388</td><td>-0.0830196</td><td>-0.0144525</td><td>0.0226691</td><td>0.0351736</td></tr><tr><th>23</th><td>p79</td><td>-0.0769194</td><td>-0.0192925</td><td>0.0300998</td><td>-0.0144461</td><td>-0.0321611</td><td>0.0103673</td></tr><tr><th>24</th><td>p55</td><td>-0.198407</td><td>-0.0636468</td><td>-0.0785549</td><td>-0.00934979</td><td>-0.0624222</td><td>0.0240908</td></tr><tr><th>25</th><td>p27</td><td>0.0253226</td><td>-0.0034848</td><td>-0.00409008</td><td>-0.00613053</td><td>-0.0976388</td><td>0.0736412</td></tr><tr><th>26</th><td>p28</td><td>0.150438</td><td>-0.00602142</td><td>-0.151515</td><td>0.00703484</td><td>0.0682959</td><td>-0.0247766</td></tr><tr><th>27</th><td>p25</td><td>0.267624</td><td>0.137018</td><td>-0.0474274</td><td>0.0096972</td><td>-0.0356753</td><td>0.0451272</td></tr><tr><th>28</th><td>p64</td><td>0.268323</td><td>0.00228779</td><td>0.0339367</td><td>0.0132883</td><td>-0.0188271</td><td>0.0245843</td></tr><tr><th>29</th><td>p57</td><td>0.00282578</td><td>-0.0025558</td><td>-0.0153196</td><td>0.0156045</td><td>0.0551862</td><td>-0.0361</td></tr><tr><th>30</th><td>p53</td><td>-0.0783684</td><td>0.0257233</td><td>0.02035</td><td>0.0180281</td><td>0.0430808</td><td>-0.0320957</td></tr><tr><th>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr></tbody></table></div>
</div>
</div>
<p>It appears to be <code>Subj</code> “p10”.</p>
</section>
<section id="item-related-conditional-means-of-random-effects" class="level3" data-number="4.10.3">
<h3 data-number="4.10.3" class="anchored" data-anchor-id="item-related-conditional-means-of-random-effects"><span class="header-section-number">4.10.3</span> Item-related conditional means of random effects</h3>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>cm_Item <span class="op">=</span> <span class="fu">last</span>(<span class="fu">ranefinfo</span>(m_prm2))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">caterpillar!</span>(<span class="fu">Figure</span>(; resolution<span class="op">=</span>(<span class="fl">800</span>, <span class="fl">1200</span>)), cm_Item; orderby<span class="op">=</span><span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<div id="fig-2caterpillar-item" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Hofmann_Maulwurf_Julia_1_files/figure-html/fig-2caterpillar-item-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure 4: Prediction intervals on item random effects for model m_prm2</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">versioninfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Julia Version 1.8.0
Commit 5544a0fab76 (2022-08-17 13:38 UTC)
Platform Info:
  OS: macOS (arm64-apple-darwin21.3.0)
  CPU: 10 × Apple M1 Max
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-13.0.1 (ORCJIT, apple-m1)
  Threads: 1 on 8 virtual cores</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>